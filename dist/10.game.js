(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{100:function(e,t,r){"use strict";r.d(t,"a",function(){return E});var i=r(1),n=r(2),o=r(36),s=r(9),a=r(0),u=r(3),l=r(8),c=r(17),h=r(76),f=r(90),p=r(40),d=r(6),_=r(4),g=r(26),m=r(20),T=(r(327),r(328),function(e){function t(){var t=e.call(this)||this;return t.DIFFUSE=!1,t.DIFFUSEDIRECTUV=0,t.GAMMADIFFUSE=!1,t.DIFFUSEHASALPHA=!1,t.OPACITYFRESNEL=!1,t.REFLECTIONBLUR=!1,t.REFLECTIONFRESNEL=!1,t.REFLECTIONFALLOFF=!1,t.TEXTURELODSUPPORT=!1,t.PREMULTIPLYALPHA=!1,t.USERGBCOLOR=!1,t.USEHIGHLIGHTANDSHADOWCOLORS=!1,t.NOISE=!1,t.REFLECTIONBGR=!1,t.IMAGEPROCESSING=!1,t.VIGNETTE=!1,t.VIGNETTEBLENDMODEMULTIPLY=!1,t.VIGNETTEBLENDMODEOPAQUE=!1,t.TONEMAPPING=!1,t.TONEMAPPING_ACES=!1,t.CONTRAST=!1,t.COLORCURVES=!1,t.COLORGRADING=!1,t.COLORGRADING3D=!1,t.SAMPLER3DGREENDEPTH=!1,t.SAMPLER3DBGRMAP=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.EXPOSURE=!1,t.REFLECTION=!1,t.REFLECTIONMAP_3D=!1,t.REFLECTIONMAP_SPHERICAL=!1,t.REFLECTIONMAP_PLANAR=!1,t.REFLECTIONMAP_CUBIC=!1,t.REFLECTIONMAP_PROJECTION=!1,t.REFLECTIONMAP_SKYBOX=!1,t.REFLECTIONMAP_SKYBOX_TRANSFORMED=!1,t.REFLECTIONMAP_EXPLICIT=!1,t.REFLECTIONMAP_EQUIRECTANGULAR=!1,t.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,t.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,t.INVERTCUBICMAP=!1,t.REFLECTIONMAP_OPPOSITEZ=!1,t.LODINREFLECTIONALPHA=!1,t.GAMMAREFLECTION=!1,t.RGBDREFLECTION=!1,t.EQUIRECTANGULAR_RELFECTION_FOV=!1,t.MAINUV1=!1,t.MAINUV2=!1,t.UV1=!1,t.UV2=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.POINTSIZE=!1,t.FOG=!1,t.NORMAL=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.INSTANCES=!1,t.SHADOWFLOAT=!1,t.rebuild(),t}return i.d(t,e),t}(h.a)),E=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i.primaryColor=a.Color3.White(),i._primaryColorShadowLevel=0,i._primaryColorHighlightLevel=0,i.reflectionTexture=null,i.reflectionBlur=0,i.diffuseTexture=null,i._shadowLights=null,i.shadowLights=null,i.shadowLevel=0,i.sceneCenter=a.Vector3.Zero(),i.opacityFresnel=!0,i.reflectionFresnel=!1,i.reflectionFalloffDistance=0,i.reflectionAmount=1,i.reflectionReflectance0=.05,i.reflectionReflectance90=.5,i.useRGBColor=!0,i.enableNoise=!1,i._fovMultiplier=1,i.useEquirectangularFOV=!1,i._maxSimultaneousLights=4,i.maxSimultaneousLights=4,i._imageProcessingObserver=null,i.switchToBGR=!1,i._renderTargets=new o.a(16),i._reflectionControls=a.Vector4.Zero(),i._white=a.Color3.White(),i._primaryShadowColor=a.Color3.Black(),i._primaryHighlightColor=a.Color3.Black(),i._attachImageProcessingConfiguration(null),i.getRenderTargetTextures=function(){return i._renderTargets.reset(),i._diffuseTexture&&i._diffuseTexture.isRenderTarget&&i._renderTargets.push(i._diffuseTexture),i._reflectionTexture&&i._reflectionTexture.isRenderTarget&&i._renderTargets.push(i._reflectionTexture),i._renderTargets},i}return i.d(t,e),Object.defineProperty(t.prototype,"_perceptualColor",{get:function(){return this.__perceptualColor},set:function(e){this.__perceptualColor=e,this._computePrimaryColorFromPerceptualColor(),this._markAllSubMeshesAsLightsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"primaryColorShadowLevel",{get:function(){return this._primaryColorShadowLevel},set:function(e){this._primaryColorShadowLevel=e,this._computePrimaryColors(),this._markAllSubMeshesAsLightsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"primaryColorHighlightLevel",{get:function(){return this._primaryColorHighlightLevel},set:function(e){this._primaryColorHighlightLevel=e,this._computePrimaryColors(),this._markAllSubMeshesAsLightsDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reflectionStandardFresnelWeight",{set:function(e){var r=e;r<.5?(r*=2,this.reflectionReflectance0=t.StandardReflectance0*r,this.reflectionReflectance90=t.StandardReflectance90*r):(r=2*r-1,this.reflectionReflectance0=t.StandardReflectance0+(1-t.StandardReflectance0)*r,this.reflectionReflectance90=t.StandardReflectance90+(1-t.StandardReflectance90)*r)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fovMultiplier",{get:function(){return this._fovMultiplier},set:function(e){isNaN(e)&&(e=1),this._fovMultiplier=Math.max(0,Math.min(2,e))},enumerable:!0,configurable:!0}),t.prototype._attachImageProcessingConfiguration=function(e){var t=this;e!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),this._imageProcessingConfiguration=e||this.getScene().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add(function(){t._computePrimaryColorFromPerceptualColor(),t._markAllSubMeshesAsImageProcessingDirty()})))},Object.defineProperty(t.prototype,"imageProcessingConfiguration",{get:function(){return this._imageProcessingConfiguration},set:function(e){this._attachImageProcessingConfiguration(e),this._markAllSubMeshesAsTexturesDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraColorCurvesEnabled",{get:function(){return this.imageProcessingConfiguration.colorCurvesEnabled},set:function(e){this.imageProcessingConfiguration.colorCurvesEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraColorGradingEnabled",{get:function(){return this.imageProcessingConfiguration.colorGradingEnabled},set:function(e){this.imageProcessingConfiguration.colorGradingEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraToneMappingEnabled",{get:function(){return this._imageProcessingConfiguration.toneMappingEnabled},set:function(e){this._imageProcessingConfiguration.toneMappingEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraExposure",{get:function(){return this._imageProcessingConfiguration.exposure},set:function(e){this._imageProcessingConfiguration.exposure=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraContrast",{get:function(){return this._imageProcessingConfiguration.contrast},set:function(e){this._imageProcessingConfiguration.contrast=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraColorGradingTexture",{get:function(){return this._imageProcessingConfiguration.colorGradingTexture},set:function(e){this.imageProcessingConfiguration.colorGradingTexture=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraColorCurves",{get:function(){return this.imageProcessingConfiguration.colorCurves},set:function(e){this.imageProcessingConfiguration.colorCurves=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasRenderTargetTextures",{get:function(){return!(!this._diffuseTexture||!this._diffuseTexture.isRenderTarget)||!(!this._reflectionTexture||!this._reflectionTexture.isRenderTarget)},enumerable:!0,configurable:!0}),t.prototype.needAlphaTesting=function(){return!0},t.prototype.needAlphaBlending=function(){return this.alpha<0||null!=this._diffuseTexture&&this._diffuseTexture.hasAlpha},t.prototype.isReadyForSubMesh=function(e,t,r){var i=this;if(void 0===r&&(r=!1),t.effect&&this.isFrozen&&this._wasPreviouslyReady)return!0;t._materialDefines||(t._materialDefines=new T);var n=this.getScene(),o=t._materialDefines;if(!this.checkReadyOnEveryCall&&t.effect&&o._renderId===n.getRenderId())return!0;var a=n.getEngine();if(c.a.PrepareDefinesForLights(n,e,o,!1,this._maxSimultaneousLights),o._needNormals=!0,o._areTexturesDirty){if(o._needUVs=!1,n.texturesEnabled){if(n.getEngine().getCaps().textureLOD&&(o.TEXTURELODSUPPORT=!0),this._diffuseTexture&&m.a.DiffuseTextureEnabled){if(!this._diffuseTexture.isReadyOrNotBlocking())return!1;c.a.PrepareDefinesForMergedUV(this._diffuseTexture,o,"DIFFUSE"),o.DIFFUSEHASALPHA=this._diffuseTexture.hasAlpha,o.GAMMADIFFUSE=this._diffuseTexture.gammaSpace,o.OPACITYFRESNEL=this._opacityFresnel}else o.DIFFUSE=!1,o.DIFFUSEHASALPHA=!1,o.GAMMADIFFUSE=!1,o.OPACITYFRESNEL=!1;var h=this._reflectionTexture;if(h&&m.a.ReflectionTextureEnabled){if(!h.isReadyOrNotBlocking())return!1;switch(o.REFLECTION=!0,o.GAMMAREFLECTION=h.gammaSpace,o.RGBDREFLECTION=h.isRGBD,o.REFLECTIONBLUR=this._reflectionBlur>0,o.REFLECTIONMAP_OPPOSITEZ=this.getScene().useRightHandedSystem?!h.invertZ:h.invertZ,o.LODINREFLECTIONALPHA=h.lodLevelInAlpha,o.EQUIRECTANGULAR_RELFECTION_FOV=this.useEquirectangularFOV,o.REFLECTIONBGR=this.switchToBGR,h.coordinatesMode===d.a.INVCUBIC_MODE&&(o.INVERTCUBICMAP=!0),o.REFLECTIONMAP_3D=h.isCube,h.coordinatesMode){case d.a.EXPLICIT_MODE:o.REFLECTIONMAP_EXPLICIT=!0;break;case d.a.PLANAR_MODE:o.REFLECTIONMAP_PLANAR=!0;break;case d.a.PROJECTION_MODE:o.REFLECTIONMAP_PROJECTION=!0;break;case d.a.SKYBOX_MODE:o.REFLECTIONMAP_SKYBOX=!0,o.REFLECTIONMAP_SKYBOX_TRANSFORMED=!h.getReflectionTextureMatrix().isIdentity();break;case d.a.SPHERICAL_MODE:o.REFLECTIONMAP_SPHERICAL=!0;break;case d.a.EQUIRECTANGULAR_MODE:o.REFLECTIONMAP_EQUIRECTANGULAR=!0;break;case d.a.FIXED_EQUIRECTANGULAR_MODE:o.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!0;break;case d.a.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:o.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!0;break;case d.a.CUBIC_MODE:case d.a.INVCUBIC_MODE:default:o.REFLECTIONMAP_CUBIC=!0}this.reflectionFresnel?(o.REFLECTIONFRESNEL=!0,o.REFLECTIONFALLOFF=this.reflectionFalloffDistance>0,this._reflectionControls.x=this.reflectionAmount,this._reflectionControls.y=this.reflectionReflectance0,this._reflectionControls.z=this.reflectionReflectance90,this._reflectionControls.w=1/this.reflectionFalloffDistance):(o.REFLECTIONFRESNEL=!1,o.REFLECTIONFALLOFF=!1)}else o.REFLECTION=!1,o.REFLECTIONFRESNEL=!1,o.REFLECTIONFALLOFF=!1,o.REFLECTIONBLUR=!1,o.REFLECTIONMAP_3D=!1,o.REFLECTIONMAP_SPHERICAL=!1,o.REFLECTIONMAP_PLANAR=!1,o.REFLECTIONMAP_CUBIC=!1,o.REFLECTIONMAP_PROJECTION=!1,o.REFLECTIONMAP_SKYBOX=!1,o.REFLECTIONMAP_SKYBOX_TRANSFORMED=!1,o.REFLECTIONMAP_EXPLICIT=!1,o.REFLECTIONMAP_EQUIRECTANGULAR=!1,o.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,o.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,o.INVERTCUBICMAP=!1,o.REFLECTIONMAP_OPPOSITEZ=!1,o.LODINREFLECTIONALPHA=!1,o.GAMMAREFLECTION=!1,o.RGBDREFLECTION=!1}o.PREMULTIPLYALPHA=this.alphaMode===_.a.ALPHA_PREMULTIPLIED||this.alphaMode===_.a.ALPHA_PREMULTIPLIED_PORTERDUFF,o.USERGBCOLOR=this._useRGBColor,o.NOISE=this._enableNoise}if(o._areLightsDirty&&(o.USEHIGHLIGHTANDSHADOWCOLORS=!this._useRGBColor&&(0!==this._primaryColorShadowLevel||0!==this._primaryColorHighlightLevel)),o._areImageProcessingDirty&&this._imageProcessingConfiguration){if(!this._imageProcessingConfiguration.isReady())return!1;this._imageProcessingConfiguration.prepareDefines(o)}if(c.a.PrepareDefinesForMisc(e,n,!1,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e),o),c.a.PrepareDefinesForFrameBoundValues(n,a,o,r),c.a.PrepareDefinesForAttributes(e,o,!1,!0,!1)&&e&&(n.getEngine().getCaps().standardDerivatives||e.isVerticesDataPresent(u.b.NormalKind)||(e.createNormals(!0),s.a.Warn("BackgroundMaterial: Normals have been created for the mesh: "+e.name))),o.isDirty){o.markAsProcessed(),n.resetCachedMaterial();var f=new l.c;o.FOG&&f.addFallback(0,"FOG"),o.POINTSIZE&&f.addFallback(1,"POINTSIZE"),c.a.HandleFallbacksForShadows(o,f,this._maxSimultaneousLights),o.NUM_BONE_INFLUENCERS>0&&f.addCPUSkinningFallback(0,e);var g=[u.b.PositionKind];o.NORMAL&&g.push(u.b.NormalKind),o.UV1&&g.push(u.b.UVKind),o.UV2&&g.push(u.b.UV2Kind),c.a.PrepareAttributesForBones(g,e,o,f),c.a.PrepareAttributesForInstances(g,o);var E=["world","view","viewProjection","vEyePosition","vLightsType","vFogInfos","vFogColor","pointSize","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","mBones","vPrimaryColor","vPrimaryColorShadow","vReflectionInfos","reflectionMatrix","vReflectionMicrosurfaceInfos","fFovMultiplier","shadowLevel","alpha","vBackgroundCenter","vReflectionControl","vDiffuseInfos","diffuseMatrix"],b=["diffuseSampler","reflectionSampler","reflectionSamplerLow","reflectionSamplerHigh"],A=["Material","Scene"];p.a&&(p.a.PrepareUniforms(E,o),p.a.PrepareSamplers(b,o)),c.a.PrepareUniformsAndSamplersList({uniformsNames:E,uniformBuffersNames:A,samplers:b,defines:o,maxSimultaneousLights:this._maxSimultaneousLights});var v=o.toString();t.setEffect(n.getEngine().createEffect("background",{attributes:g,uniformsNames:E,uniformBuffersNames:A,samplers:b,defines:v,fallbacks:f,onCompiled:function(e){i.onCompiled&&i.onCompiled(e),i.bindSceneUniformBuffer(e,n.getSceneUniformBuffer())},onError:this.onError,indexParameters:{maxSimultaneousLights:this._maxSimultaneousLights}},a),o),this.buildUniformLayout()}return!(!t.effect||!t.effect.isReady())&&(o._renderId=n.getRenderId(),this._wasPreviouslyReady=!0,!0)},t.prototype._computePrimaryColorFromPerceptualColor=function(){this.__perceptualColor&&(this._primaryColor.copyFrom(this.__perceptualColor),this._primaryColor.toLinearSpaceToRef(this._primaryColor),this._imageProcessingConfiguration&&this._primaryColor.scaleToRef(1/this._imageProcessingConfiguration.exposure,this._primaryColor),this._computePrimaryColors())},t.prototype._computePrimaryColors=function(){0===this._primaryColorShadowLevel&&0===this._primaryColorHighlightLevel||(this._primaryColor.scaleToRef(this._primaryColorShadowLevel,this._primaryShadowColor),this._primaryColor.subtractToRef(this._primaryShadowColor,this._primaryShadowColor),this._white.subtractToRef(this._primaryColor,this._primaryHighlightColor),this._primaryHighlightColor.scaleToRef(this._primaryColorHighlightLevel,this._primaryHighlightColor),this._primaryColor.addToRef(this._primaryHighlightColor,this._primaryHighlightColor))},t.prototype.buildUniformLayout=function(){this._uniformBuffer.addUniform("vPrimaryColor",4),this._uniformBuffer.addUniform("vPrimaryColorShadow",4),this._uniformBuffer.addUniform("vDiffuseInfos",2),this._uniformBuffer.addUniform("vReflectionInfos",2),this._uniformBuffer.addUniform("diffuseMatrix",16),this._uniformBuffer.addUniform("reflectionMatrix",16),this._uniformBuffer.addUniform("vReflectionMicrosurfaceInfos",3),this._uniformBuffer.addUniform("fFovMultiplier",1),this._uniformBuffer.addUniform("pointSize",1),this._uniformBuffer.addUniform("shadowLevel",1),this._uniformBuffer.addUniform("alpha",1),this._uniformBuffer.addUniform("vBackgroundCenter",3),this._uniformBuffer.addUniform("vReflectionControl",4),this._uniformBuffer.create()},t.prototype.unbind=function(){this._diffuseTexture&&this._diffuseTexture.isRenderTarget&&this._uniformBuffer.setTexture("diffuseSampler",null),this._reflectionTexture&&this._reflectionTexture.isRenderTarget&&this._uniformBuffer.setTexture("reflectionSampler",null),e.prototype.unbind.call(this)},t.prototype.bindOnlyWorldMatrix=function(e){this._activeEffect.setMatrix("world",e)},t.prototype.bindForSubMesh=function(e,t,r){var i=this.getScene(),n=r._materialDefines;if(n){var o=r.effect;if(o){this._activeEffect=o,this.bindOnlyWorldMatrix(e),c.a.BindBonesParameters(t,this._activeEffect);var s=this._mustRebind(i,o,t.visibility);if(s){this._uniformBuffer.bindToEffect(o,"Material"),this.bindViewProjection(o);var a=this._reflectionTexture;this._uniformBuffer.useUbo&&this.isFrozen&&this._uniformBuffer.isSync||(i.texturesEnabled&&(this._diffuseTexture&&m.a.DiffuseTextureEnabled&&(this._uniformBuffer.updateFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),c.a.BindTextureMatrix(this._diffuseTexture,this._uniformBuffer,"diffuse")),a&&m.a.ReflectionTextureEnabled&&(this._uniformBuffer.updateMatrix("reflectionMatrix",a.getReflectionTextureMatrix()),this._uniformBuffer.updateFloat2("vReflectionInfos",a.level,this._reflectionBlur),this._uniformBuffer.updateFloat3("vReflectionMicrosurfaceInfos",a.getSize().width,a.lodGenerationScale,a.lodGenerationOffset))),this.shadowLevel>0&&this._uniformBuffer.updateFloat("shadowLevel",this.shadowLevel),this._uniformBuffer.updateFloat("alpha",this.alpha),this.pointsCloud&&this._uniformBuffer.updateFloat("pointSize",this.pointSize),n.USEHIGHLIGHTANDSHADOWCOLORS?(this._uniformBuffer.updateColor4("vPrimaryColor",this._primaryHighlightColor,1),this._uniformBuffer.updateColor4("vPrimaryColorShadow",this._primaryShadowColor,1)):this._uniformBuffer.updateColor4("vPrimaryColor",this._primaryColor,1)),this._uniformBuffer.updateFloat("fFovMultiplier",this._fovMultiplier),i.texturesEnabled&&(this._diffuseTexture&&m.a.DiffuseTextureEnabled&&this._uniformBuffer.setTexture("diffuseSampler",this._diffuseTexture),a&&m.a.ReflectionTextureEnabled&&(n.REFLECTIONBLUR&&n.TEXTURELODSUPPORT?this._uniformBuffer.setTexture("reflectionSampler",a):n.REFLECTIONBLUR?(this._uniformBuffer.setTexture("reflectionSampler",a._lodTextureMid||a),this._uniformBuffer.setTexture("reflectionSamplerLow",a._lodTextureLow||a),this._uniformBuffer.setTexture("reflectionSamplerHigh",a._lodTextureHigh||a)):this._uniformBuffer.setTexture("reflectionSampler",a),n.REFLECTIONFRESNEL&&(this._uniformBuffer.updateFloat3("vBackgroundCenter",this.sceneCenter.x,this.sceneCenter.y,this.sceneCenter.z),this._uniformBuffer.updateFloat4("vReflectionControl",this._reflectionControls.x,this._reflectionControls.y,this._reflectionControls.z,this._reflectionControls.w)))),c.a.BindClipPlane(this._activeEffect,i),c.a.BindEyePosition(o,i)}!s&&this.isFrozen||(i.lightsEnabled&&c.a.BindLights(i,t,this._activeEffect,n,this._maxSimultaneousLights,!1),this.bindView(o),c.a.BindFogParameters(i,t,this._activeEffect,!0),this._imageProcessingConfiguration&&this._imageProcessingConfiguration.bind(this._activeEffect)),this._uniformBuffer.update(),this._afterBind(t,this._activeEffect)}}},t.prototype.dispose=function(t,r){void 0===t&&(t=!1),void 0===r&&(r=!1),r&&(this.diffuseTexture&&this.diffuseTexture.dispose(),this.reflectionTexture&&this.reflectionTexture.dispose()),this._renderTargets.dispose(),this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),e.prototype.dispose.call(this,t)},t.prototype.clone=function(e){var r=this;return n.a.Clone(function(){return new t(e,r.getScene())},this)},t.prototype.serialize=function(){var e=n.a.Serialize(this);return e.customType="BABYLON.BackgroundMaterial",e},t.prototype.getClassName=function(){return"BackgroundMaterial"},t.Parse=function(e,r,i){return n.a.Parse(function(){return new t(e.name,r)},e,r,i)},t.StandardReflectance0=.05,t.StandardReflectance90=.5,i.c([Object(n.e)()],t.prototype,"_primaryColor",void 0),i.c([Object(n.b)("_markAllSubMeshesAsLightsDirty")],t.prototype,"primaryColor",void 0),i.c([Object(n.e)()],t.prototype,"__perceptualColor",void 0),i.c([Object(n.c)()],t.prototype,"_primaryColorShadowLevel",void 0),i.c([Object(n.c)()],t.prototype,"_primaryColorHighlightLevel",void 0),i.c([Object(n.b)("_markAllSubMeshesAsLightsDirty")],t.prototype,"primaryColorHighlightLevel",null),i.c([Object(n.l)()],t.prototype,"_reflectionTexture",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"reflectionTexture",void 0),i.c([Object(n.c)()],t.prototype,"_reflectionBlur",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"reflectionBlur",void 0),i.c([Object(n.l)()],t.prototype,"_diffuseTexture",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"diffuseTexture",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"shadowLights",void 0),i.c([Object(n.c)()],t.prototype,"_shadowLevel",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"shadowLevel",void 0),i.c([Object(n.n)()],t.prototype,"_sceneCenter",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"sceneCenter",void 0),i.c([Object(n.c)()],t.prototype,"_opacityFresnel",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"opacityFresnel",void 0),i.c([Object(n.c)()],t.prototype,"_reflectionFresnel",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"reflectionFresnel",void 0),i.c([Object(n.c)()],t.prototype,"_reflectionFalloffDistance",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"reflectionFalloffDistance",void 0),i.c([Object(n.c)()],t.prototype,"_reflectionAmount",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"reflectionAmount",void 0),i.c([Object(n.c)()],t.prototype,"_reflectionReflectance0",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"reflectionReflectance0",void 0),i.c([Object(n.c)()],t.prototype,"_reflectionReflectance90",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"reflectionReflectance90",void 0),i.c([Object(n.c)()],t.prototype,"_useRGBColor",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useRGBColor",void 0),i.c([Object(n.c)()],t.prototype,"_enableNoise",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"enableNoise",void 0),i.c([Object(n.c)()],t.prototype,"_maxSimultaneousLights",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"maxSimultaneousLights",void 0),i.c([Object(n.i)()],t.prototype,"_imageProcessingConfiguration",void 0),t}(f.a);g.a.RegisteredTypes["BABYLON.BackgroundMaterial"]=E},135:function(e,t,r){"use strict";r.d(t,"a",function(){return f});var i=r(1),n=r(0),o=r(11),s=r(58),a=r(6),u=r(4),l=r(197),c=r(98),h=r(26),f=function(e){function t(t,r,i,s,u,l,c,h,f){void 0===s&&(s=!1),void 0===u&&(u=!0),void 0===l&&(l=!1),void 0===c&&(c=!1),void 0===h&&(h=null),void 0===f&&(f=null);var p=e.call(this,r)||this;return p._generateHarmonics=!0,p._onLoad=null,p._onError=null,p.coordinatesMode=a.a.CUBIC_MODE,p._isBlocking=!0,p._rotationY=0,p.boundingBoxPosition=n.Vector3.Zero(),t?(p.name=t,p.url=t,p.hasAlpha=!1,p.isCube=!0,p._textureMatrix=n.Matrix.Identity(),p._onLoad=h,p._onError=f,p.gammaSpace=l,p._noMipmap=s,p._size=i,p._texture=p._getFromCache(t,p._noMipmap),p._texture||(r.useDelayedTextureLoading?p.delayLoadState=o.Engine.DELAYLOADSTATE_NOTLOADED:p.loadTexture()),p):p}return i.d(t,e),Object.defineProperty(t.prototype,"isBlocking",{get:function(){return this._isBlocking},set:function(e){this._isBlocking=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotationY",{get:function(){return this._rotationY},set:function(e){this._rotationY=e,this.setReflectionTextureMatrix(n.Matrix.RotationY(this._rotationY))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boundingBoxSize",{get:function(){return this._boundingBoxSize},set:function(e){if(!this._boundingBoxSize||!this._boundingBoxSize.equals(e)){this._boundingBoxSize=e;var t=this.getScene();t&&t.markAllMaterialsAsDirty(u.a.MATERIAL_TextureDirtyFlag)}},enumerable:!0,configurable:!0}),t.prototype.getClassName=function(){return"HDRCubeTexture"},t.prototype.loadTexture=function(){var e=this,r=this.getScene();r&&(this._texture=r.getEngine().createRawCubeTextureFromUrl(this.url,r,this._size,o.Engine.TEXTUREFORMAT_RGB,r.getEngine().getCaps().textureFloat?o.Engine.TEXTURETYPE_FLOAT:o.Engine.TEXTURETYPE_UNSIGNED_INT,this._noMipmap,function(r){e.lodGenerationOffset=0,e.lodGenerationScale=.8;var i=e.getScene();if(!i)return null;var o=l.a.GetCubeMapTextureData(r,e._size);if(e._generateHarmonics){var s=c.a.ConvertCubeMapToSphericalPolynomial(o);e.sphericalPolynomial=s}for(var a=[],u=null,h=0;h<6;h++){if(!i.getEngine().getCaps().textureFloat){var f=new ArrayBuffer(e._size*e._size*3);u=new Uint8Array(f)}var p=o[t._facesMapping[h]];if(e.gammaSpace||u)for(var d=0;d<e._size*e._size;d++)if(e.gammaSpace&&(p[3*d+0]=Math.pow(p[3*d+0],n.ToGammaSpace),p[3*d+1]=Math.pow(p[3*d+1],n.ToGammaSpace),p[3*d+2]=Math.pow(p[3*d+2],n.ToGammaSpace)),u){var _=Math.max(255*p[3*d+0],0),g=Math.max(255*p[3*d+1],0),m=Math.max(255*p[3*d+2],0),T=Math.max(Math.max(_,g),m);if(T>255){var E=255/T;_*=E,g*=E,m*=E}u[3*d+0]=_,u[3*d+1]=g,u[3*d+2]=m}u?a.push(u):a.push(p)}return a},null,this._onLoad,this._onError))},t.prototype.clone=function(){var e=this.getScene();if(!e)return this;var r=new t(this.url,e,this._size,this._noMipmap,this._generateHarmonics,this.gammaSpace);return r.level=this.level,r.wrapU=this.wrapU,r.wrapV=this.wrapV,r.coordinatesIndex=this.coordinatesIndex,r.coordinatesMode=this.coordinatesMode,r},t.prototype.delayLoad=function(){this.delayLoadState===o.Engine.DELAYLOADSTATE_NOTLOADED&&(this.delayLoadState=o.Engine.DELAYLOADSTATE_LOADED,this._texture=this._getFromCache(this.url,this._noMipmap),this._texture||this.loadTexture())},t.prototype.getReflectionTextureMatrix=function(){return this._textureMatrix},t.prototype.setReflectionTextureMatrix=function(e){var t=this;this._textureMatrix=e,e.updateFlag!==this._textureMatrix.updateFlag&&e.isIdentity()!==this._textureMatrix.isIdentity()&&this.getScene().markAllMaterialsAsDirty(u.a.MATERIAL_TextureDirtyFlag,function(e){return-1!==e.getActiveTextures().indexOf(t)})},t.Parse=function(e,r,i){var o=null;return e.name&&!e.isRenderTarget&&((o=new t(i+e.name,r,e.size,e.noMipmap,e.generateHarmonics,e.useInGammaSpace)).name=e.name,o.hasAlpha=e.hasAlpha,o.level=e.level,o.coordinatesMode=e.coordinatesMode,o.isBlocking=e.isBlocking),o&&(e.boundingBoxPosition&&(o.boundingBoxPosition=n.Vector3.FromArray(e.boundingBoxPosition)),e.boundingBoxSize&&(o.boundingBoxSize=n.Vector3.FromArray(e.boundingBoxSize)),e.rotationY&&(o.rotationY=e.rotationY)),o},t.prototype.serialize=function(){if(!this.name)return null;var e={};return e.name=this.name,e.hasAlpha=this.hasAlpha,e.isCube=!0,e.level=this.level,e.size=this._size,e.coordinatesMode=this.coordinatesMode,e.useInGammaSpace=this.gammaSpace,e.generateHarmonics=this._generateHarmonics,e.customType="BABYLON.HDRCubeTexture",e.noMipmap=this._noMipmap,e.isBlocking=this._isBlocking,e.rotationY=this._rotationY,e},t._facesMapping=["right","left","up","down","front","back"],t}(s.a);h.a.RegisteredTypes["BABYLON.HDRCubeTexture"]=f},137:function(e,t,r){"use strict";r.d(t,"a",function(){return s});var i=r(1),n=r(2),o=r(0),s=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i.maxSimultaneousLights=4,i.disableLighting=!1,i.invertNormalMapX=!1,i.invertNormalMapY=!1,i.emissiveColor=new o.Color3(0,0,0),i.occlusionStrength=1,i.useLightmapAsShadowmap=!1,i._useAlphaFromAlbedoTexture=!0,i._useAmbientInGrayScale=!0,i}return i.d(t,e),Object.defineProperty(t.prototype,"doubleSided",{get:function(){return this._twoSidedLighting},set:function(e){this._twoSidedLighting!==e&&(this._twoSidedLighting=e,this.backFaceCulling=!e,this._markAllSubMeshesAsTexturesDirty())},enumerable:!0,configurable:!0}),t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this.environmentTexture&&t.push(this.environmentTexture),this.normalTexture&&t.push(this.normalTexture),this.emissiveTexture&&t.push(this.emissiveTexture),this.occlusionTexture&&t.push(this.occlusionTexture),this.lightmapTexture&&t.push(this.lightmapTexture),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||this.lightmapTexture===t},t.prototype.getClassName=function(){return"PBRBaseSimpleMaterial"},i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsLightsDirty")],t.prototype,"maxSimultaneousLights",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsLightsDirty")],t.prototype,"disableLighting",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty","_reflectionTexture")],t.prototype,"environmentTexture",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"invertNormalMapX",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"invertNormalMapY",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty","_bumpTexture")],t.prototype,"normalTexture",void 0),i.c([Object(n.e)("emissive"),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"emissiveColor",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"emissiveTexture",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty","_ambientTextureStrength")],t.prototype,"occlusionStrength",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty","_ambientTexture")],t.prototype,"occlusionTexture",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty","_alphaCutOff")],t.prototype,"alphaCutOff",void 0),i.c([Object(n.c)()],t.prototype,"doubleSided",null),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty",null)],t.prototype,"lightmapTexture",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useLightmapAsShadowmap",void 0),t}(r(60).a)},139:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var i=function(){return function(){}}()},14:function(e,t,r){"use strict";r.d(t,"a",function(){return p});var i=r(1),n=r(2),o=r(5),s=r(7),a=r(0),u=r(21),l=r(56),c=r(99),h=r(4),f=r(9),p=function(){function e(t,r,i){this.metadata=null,this.reservedDataStore=null,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this._alpha=1,this._backFaceCulling=!0,this.doNotSerialize=!1,this._storeEffectOnSubMeshes=!1,this.onDisposeObservable=new s.c,this._alphaMode=h.a.ALPHA_COMBINE,this._needDepthPrePass=!1,this.disableDepthWrite=!1,this.forceDepthWrite=!1,this.separateCullingPass=!1,this._fogEnabled=!0,this.pointSize=1,this.zOffset=0,this._wasPreviouslyReady=!1,this._fillMode=e.TriangleFillMode,this._indexInSceneMaterialArray=-1,this.name=t,this.id=t||o.h.RandomId(),this._scene=r||u.a.LastCreatedScene,this.uniqueId=this._scene.getUniqueId(),this._scene.useRightHandedSystem?this.sideOrientation=e.ClockWiseSideOrientation:this.sideOrientation=e.CounterClockWiseSideOrientation,this._uniformBuffer=new c.a(this._scene.getEngine()),this._useUBO=this.getScene().getEngine().supportsUniformBuffers,i||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={})}return Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha!==t&&(this._alpha=t,this.markAsDirty(e.MiscDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backFaceCulling",{get:function(){return this._backFaceCulling},set:function(t){this._backFaceCulling!==t&&(this._backFaceCulling=t,this.markAsDirty(e.TextureDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasRenderTargetTextures",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onDispose",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onBindObservable",{get:function(){return this._onBindObservable||(this._onBindObservable=new s.c),this._onBindObservable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onBind",{set:function(e){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onUnBindObservable",{get:function(){return this._onUnBindObservable||(this._onUnBindObservable=new s.c),this._onUnBindObservable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alphaMode",{get:function(){return this._alphaMode},set:function(t){this._alphaMode!==t&&(this._alphaMode=t,this.markAsDirty(e.TextureDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"needDepthPrePass",{get:function(){return this._needDepthPrePass},set:function(e){this._needDepthPrePass!==e&&(this._needDepthPrePass=e,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fogEnabled",{get:function(){return this._fogEnabled},set:function(t){this._fogEnabled!==t&&(this._fogEnabled=t,this.markAsDirty(e.MiscDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wireframe",{get:function(){switch(this._fillMode){case e.WireFrameFillMode:case e.LineListDrawMode:case e.LineLoopDrawMode:case e.LineStripDrawMode:return!0}return this._scene.forceWireframe},set:function(t){this.fillMode=t?e.WireFrameFillMode:e.TriangleFillMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pointsCloud",{get:function(){switch(this._fillMode){case e.PointFillMode:case e.PointListDrawMode:return!0}return this._scene.forcePointsCloud},set:function(t){this.fillMode=t?e.PointFillMode:e.TriangleFillMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillMode",{get:function(){return this._fillMode},set:function(t){this._fillMode!==t&&(this._fillMode=t,this.markAsDirty(e.MiscDirtyFlag))},enumerable:!0,configurable:!0}),e.prototype.toString=function(e){return"Name: "+this.name},e.prototype.getClassName=function(){return"Material"},Object.defineProperty(e.prototype,"isFrozen",{get:function(){return this.checkReadyOnlyOnce},enumerable:!0,configurable:!0}),e.prototype.freeze=function(){this.checkReadyOnlyOnce=!0},e.prototype.unfreeze=function(){this.checkReadyOnlyOnce=!1},e.prototype.isReady=function(e,t){return!0},e.prototype.isReadyForSubMesh=function(e,t,r){return!1},e.prototype.getEffect=function(){return this._effect},e.prototype.getScene=function(){return this._scene},e.prototype.needAlphaBlending=function(){return this.alpha<1},e.prototype.needAlphaBlendingForMesh=function(e){return this.needAlphaBlending()||e.visibility<1||e.hasVertexAlpha},e.prototype.needAlphaTesting=function(){return!1},e.prototype.getAlphaTestTexture=function(){return null},e.prototype.markDirty=function(){this._wasPreviouslyReady=!1},e.prototype._preBind=function(t,r){void 0===r&&(r=null);var i=this._scene.getEngine(),n=(null==r?this.sideOrientation:r)===e.ClockWiseSideOrientation;return i.enableEffect(t||this._effect),i.setState(this.backFaceCulling,this.zOffset,!1,n),n},e.prototype.bind=function(e,t){},e.prototype.bindForSubMesh=function(e,t,r){},e.prototype.bindOnlyWorldMatrix=function(e){},e.prototype.bindSceneUniformBuffer=function(e,t){t.bindToEffect(e,"Scene")},e.prototype.bindView=function(e){this._useUBO?this.bindSceneUniformBuffer(e,this.getScene().getSceneUniformBuffer()):e.setMatrix("view",this.getScene().getViewMatrix())},e.prototype.bindViewProjection=function(e){this._useUBO?this.bindSceneUniformBuffer(e,this.getScene().getSceneUniformBuffer()):e.setMatrix("viewProjection",this.getScene().getTransformMatrix())},e.prototype._shouldTurnAlphaTestOn=function(e){return!this.needAlphaBlendingForMesh(e)&&this.needAlphaTesting()},e.prototype._afterBind=function(e){if(this._scene._cachedMaterial=this,this._scene._cachedVisibility=e?e.visibility:1,this._onBindObservable&&e&&this._onBindObservable.notifyObservers(e),this.disableDepthWrite){var t=this._scene.getEngine();this._cachedDepthWriteState=t.getDepthWrite(),t.setDepthWrite(!1)}},e.prototype.unbind=function(){(this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this),this.disableDepthWrite)&&this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState)},e.prototype.getActiveTextures=function(){return[]},e.prototype.hasTexture=function(e){return!1},e.prototype.clone=function(e){return null},e.prototype.getBindedMeshes=function(){var e=this;if(this.meshMap){var t=new Array;for(var r in this.meshMap){var i=this.meshMap[r];i&&t.push(i)}return t}return this._scene.meshes.filter(function(t){return t.material===e})},e.prototype.forceCompilation=function(e,t,r){var n=this,o=i.a({clipPlane:!1},r),s=new l.a,u=this.getScene(),c=function(){if(n._scene&&n._scene.getEngine()){s._materialDefines&&(s._materialDefines._renderId=-1);var r=u.clipPlane;o.clipPlane&&(u.clipPlane=new a.Plane(0,0,0,1)),n._storeEffectOnSubMeshes?n.isReadyForSubMesh(e,s)?t&&t(n):setTimeout(c,16):n.isReady()?t&&t(n):setTimeout(c,16),o.clipPlane&&(u.clipPlane=r)}};c()},e.prototype.forceCompilationAsync=function(e,t){var r=this;return new Promise(function(i){r.forceCompilation(e,function(){i()},t)})},e.prototype.markAsDirty=function(t){this.getScene().blockMaterialDirtyMechanism||(e._DirtyCallbackArray.length=0,t&e.TextureDirtyFlag&&e._DirtyCallbackArray.push(e._TextureDirtyCallBack),t&e.LightDirtyFlag&&e._DirtyCallbackArray.push(e._LightsDirtyCallBack),t&e.FresnelDirtyFlag&&e._DirtyCallbackArray.push(e._FresnelDirtyCallBack),t&e.AttributesDirtyFlag&&e._DirtyCallbackArray.push(e._AttributeDirtyCallBack),t&e.MiscDirtyFlag&&e._DirtyCallbackArray.push(e._MiscDirtyCallBack),e._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(e._RunDirtyCallBacks),this.getScene().resetCachedMaterial())},e.prototype._markAllSubMeshesAsDirty=function(e){if(!this.getScene().blockMaterialDirtyMechanism)for(var t=0,r=this.getScene().meshes;t<r.length;t++){var i=r[t];if(i.subMeshes)for(var n=0,o=i.subMeshes;n<o.length;n++){var s=o[n];s.getMaterial()===this&&(s._materialDefines&&e(s._materialDefines))}}},e.prototype._markAllSubMeshesAsImageProcessingDirty=function(){this._markAllSubMeshesAsDirty(e._ImageProcessingDirtyCallBack)},e.prototype._markAllSubMeshesAsTexturesDirty=function(){this._markAllSubMeshesAsDirty(e._TextureDirtyCallBack)},e.prototype._markAllSubMeshesAsFresnelDirty=function(){this._markAllSubMeshesAsDirty(e._FresnelDirtyCallBack)},e.prototype._markAllSubMeshesAsFresnelAndMiscDirty=function(){this._markAllSubMeshesAsDirty(e._FresnelAndMiscDirtyCallBack)},e.prototype._markAllSubMeshesAsLightsDirty=function(){this._markAllSubMeshesAsDirty(e._LightsDirtyCallBack)},e.prototype._markAllSubMeshesAsAttributesDirty=function(){this._markAllSubMeshesAsDirty(e._AttributeDirtyCallBack)},e.prototype._markAllSubMeshesAsMiscDirty=function(){this._markAllSubMeshesAsDirty(e._MiscDirtyCallBack)},e.prototype._markAllSubMeshesAsTexturesAndMiscDirty=function(){this._markAllSubMeshesAsDirty(e._TextureAndMiscDirtyCallBack)},e.prototype.dispose=function(e,t,r){var i=this.getScene();if(i.stopAnimation(this),i.freeProcessedMaterials(),i.removeMaterial(this),!0!==r)if(this.meshMap)for(var n in this.meshMap){(a=this.meshMap[n])&&(a.material=null,this.releaseVertexArrayObject(a,e))}else for(var o=0,s=i.meshes;o<s.length;o++){var a;(a=s[o]).material===this&&(a.material=null,this.releaseVertexArrayObject(a,e))}this._uniformBuffer.dispose(),e&&this._effect&&(this._storeEffectOnSubMeshes||i.getEngine()._releaseEffect(this._effect),this._effect=null),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this._onBindObservable&&this._onBindObservable.clear(),this._onUnBindObservable&&this._onUnBindObservable.clear()},e.prototype.releaseVertexArrayObject=function(e,t){if(e.geometry){var r=e.geometry,i=this.getScene();if(this._storeEffectOnSubMeshes)for(var n=0,o=e.subMeshes;n<o.length;n++){var s=o[n];r._releaseVertexArrayObject(s._materialEffect),t&&s._materialEffect&&i.getEngine()._releaseEffect(s._materialEffect)}else r._releaseVertexArrayObject(this._effect)}},e.prototype.serialize=function(){return n.a.Serialize(this)},e.Parse=function(e,t,r){if(e.customType){if("BABYLON.PBRMaterial"===e.customType&&e.overloadedAlbedo&&(e.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return void f.a.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library.")}else e.customType="BABYLON.StandardMaterial";return o.h.Instantiate(e.customType).Parse(e,t,r)},e.TriangleFillMode=h.a.MATERIAL_TriangleFillMode,e.WireFrameFillMode=h.a.MATERIAL_WireFrameFillMode,e.PointFillMode=h.a.MATERIAL_PointFillMode,e.PointListDrawMode=h.a.MATERIAL_PointListDrawMode,e.LineListDrawMode=h.a.MATERIAL_LineListDrawMode,e.LineLoopDrawMode=h.a.MATERIAL_LineLoopDrawMode,e.LineStripDrawMode=h.a.MATERIAL_LineStripDrawMode,e.TriangleStripDrawMode=h.a.MATERIAL_TriangleStripDrawMode,e.TriangleFanDrawMode=h.a.MATERIAL_TriangleFanDrawMode,e.ClockWiseSideOrientation=h.a.MATERIAL_ClockWiseSideOrientation,e.CounterClockWiseSideOrientation=h.a.MATERIAL_CounterClockWiseSideOrientation,e.TextureDirtyFlag=h.a.MATERIAL_TextureDirtyFlag,e.LightDirtyFlag=h.a.MATERIAL_LightDirtyFlag,e.FresnelDirtyFlag=h.a.MATERIAL_FresnelDirtyFlag,e.AttributesDirtyFlag=h.a.MATERIAL_AttributesDirtyFlag,e.MiscDirtyFlag=h.a.MATERIAL_MiscDirtyFlag,e.AllDirtyFlag=h.a.MATERIAL_AllDirtyFlag,e._ImageProcessingDirtyCallBack=function(e){return e.markAsImageProcessingDirty()},e._TextureDirtyCallBack=function(e){return e.markAsTexturesDirty()},e._FresnelDirtyCallBack=function(e){return e.markAsFresnelDirty()},e._MiscDirtyCallBack=function(e){return e.markAsMiscDirty()},e._LightsDirtyCallBack=function(e){return e.markAsLightDirty()},e._AttributeDirtyCallBack=function(e){return e.markAsAttributesDirty()},e._FresnelAndMiscDirtyCallBack=function(t){e._FresnelDirtyCallBack(t),e._MiscDirtyCallBack(t)},e._TextureAndMiscDirtyCallBack=function(t){e._TextureDirtyCallBack(t),e._MiscDirtyCallBack(t)},e._DirtyCallbackArray=[],e._RunDirtyCallBacks=function(t){for(var r=0,i=e._DirtyCallbackArray;r<i.length;r++){(0,i[r])(t)}},i.c([Object(n.c)()],e.prototype,"id",void 0),i.c([Object(n.c)()],e.prototype,"uniqueId",void 0),i.c([Object(n.c)()],e.prototype,"name",void 0),i.c([Object(n.c)()],e.prototype,"checkReadyOnEveryCall",void 0),i.c([Object(n.c)()],e.prototype,"checkReadyOnlyOnce",void 0),i.c([Object(n.c)()],e.prototype,"state",void 0),i.c([Object(n.c)("alpha")],e.prototype,"_alpha",void 0),i.c([Object(n.c)("backFaceCulling")],e.prototype,"_backFaceCulling",void 0),i.c([Object(n.c)()],e.prototype,"sideOrientation",void 0),i.c([Object(n.c)("alphaMode")],e.prototype,"_alphaMode",void 0),i.c([Object(n.c)()],e.prototype,"_needDepthPrePass",void 0),i.c([Object(n.c)()],e.prototype,"disableDepthWrite",void 0),i.c([Object(n.c)()],e.prototype,"forceDepthWrite",void 0),i.c([Object(n.c)()],e.prototype,"separateCullingPass",void 0),i.c([Object(n.c)("fogEnabled")],e.prototype,"_fogEnabled",void 0),i.c([Object(n.c)()],e.prototype,"pointSize",void 0),i.c([Object(n.c)()],e.prototype,"zOffset",void 0),i.c([Object(n.c)()],e.prototype,"wireframe",null),i.c([Object(n.c)()],e.prototype,"pointsCloud",null),i.c([Object(n.c)()],e.prototype,"fillMode",null),e}()},140:function(e,t,r){"use strict";r.d(t,"a",function(){return s});var i=r(1),n=r(2),o=r(0),s=function(){function e(){this._dirty=!0,this._tempColor=new o.Color4(0,0,0,0),this._globalCurve=new o.Color4(0,0,0,0),this._highlightsCurve=new o.Color4(0,0,0,0),this._midtonesCurve=new o.Color4(0,0,0,0),this._shadowsCurve=new o.Color4(0,0,0,0),this._positiveCurve=new o.Color4(0,0,0,0),this._negativeCurve=new o.Color4(0,0,0,0),this._globalHue=30,this._globalDensity=0,this._globalSaturation=0,this._globalExposure=0,this._highlightsHue=30,this._highlightsDensity=0,this._highlightsSaturation=0,this._highlightsExposure=0,this._midtonesHue=30,this._midtonesDensity=0,this._midtonesSaturation=0,this._midtonesExposure=0,this._shadowsHue=30,this._shadowsDensity=0,this._shadowsSaturation=0,this._shadowsExposure=0}return Object.defineProperty(e.prototype,"globalHue",{get:function(){return this._globalHue},set:function(e){this._globalHue=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalDensity",{get:function(){return this._globalDensity},set:function(e){this._globalDensity=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalSaturation",{get:function(){return this._globalSaturation},set:function(e){this._globalSaturation=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalExposure",{get:function(){return this._globalExposure},set:function(e){this._globalExposure=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightsHue",{get:function(){return this._highlightsHue},set:function(e){this._highlightsHue=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightsDensity",{get:function(){return this._highlightsDensity},set:function(e){this._highlightsDensity=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightsSaturation",{get:function(){return this._highlightsSaturation},set:function(e){this._highlightsSaturation=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightsExposure",{get:function(){return this._highlightsExposure},set:function(e){this._highlightsExposure=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"midtonesHue",{get:function(){return this._midtonesHue},set:function(e){this._midtonesHue=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"midtonesDensity",{get:function(){return this._midtonesDensity},set:function(e){this._midtonesDensity=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"midtonesSaturation",{get:function(){return this._midtonesSaturation},set:function(e){this._midtonesSaturation=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"midtonesExposure",{get:function(){return this._midtonesExposure},set:function(e){this._midtonesExposure=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowsHue",{get:function(){return this._shadowsHue},set:function(e){this._shadowsHue=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowsDensity",{get:function(){return this._shadowsDensity},set:function(e){this._shadowsDensity=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowsSaturation",{get:function(){return this._shadowsSaturation},set:function(e){this._shadowsSaturation=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowsExposure",{get:function(){return this._shadowsExposure},set:function(e){this._shadowsExposure=e,this._dirty=!0},enumerable:!0,configurable:!0}),e.prototype.getClassName=function(){return"ColorCurves"},e.Bind=function(e,t,r,i,n){void 0===r&&(r="vCameraColorCurvePositive"),void 0===i&&(i="vCameraColorCurveNeutral"),void 0===n&&(n="vCameraColorCurveNegative"),e._dirty&&(e._dirty=!1,e.getColorGradingDataToRef(e._globalHue,e._globalDensity,e._globalSaturation,e._globalExposure,e._globalCurve),e.getColorGradingDataToRef(e._highlightsHue,e._highlightsDensity,e._highlightsSaturation,e._highlightsExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._highlightsCurve),e.getColorGradingDataToRef(e._midtonesHue,e._midtonesDensity,e._midtonesSaturation,e._midtonesExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._midtonesCurve),e.getColorGradingDataToRef(e._shadowsHue,e._shadowsDensity,e._shadowsSaturation,e._shadowsExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._shadowsCurve),e._highlightsCurve.subtractToRef(e._midtonesCurve,e._positiveCurve),e._midtonesCurve.subtractToRef(e._shadowsCurve,e._negativeCurve)),t&&(t.setFloat4(r,e._positiveCurve.r,e._positiveCurve.g,e._positiveCurve.b,e._positiveCurve.a),t.setFloat4(i,e._midtonesCurve.r,e._midtonesCurve.g,e._midtonesCurve.b,e._midtonesCurve.a),t.setFloat4(n,e._negativeCurve.r,e._negativeCurve.g,e._negativeCurve.b,e._negativeCurve.a))},e.PrepareUniforms=function(e){e.push("vCameraColorCurveNeutral","vCameraColorCurvePositive","vCameraColorCurveNegative")},e.prototype.getColorGradingDataToRef=function(t,r,i,n,o){null!=t&&(t=e.clamp(t,0,360),r=e.clamp(r,-100,100),i=e.clamp(i,-100,100),n=e.clamp(n,-100,100),r=e.applyColorGradingSliderNonlinear(r),r*=.5,n=e.applyColorGradingSliderNonlinear(n),r<0&&(r*=-1,t=(t+180)%360),e.fromHSBToRef(t,r,50+.25*n,o),o.scaleToRef(2,o),o.a=1+.01*i)},e.applyColorGradingSliderNonlinear=function(e){e/=100;var t=Math.abs(e);return t=Math.pow(t,2),e<0&&(t*=-1),t*=100},e.fromHSBToRef=function(t,r,i,n){var o=e.clamp(t,0,360),s=e.clamp(r/100,0,1),a=e.clamp(i/100,0,1);if(0===s)n.r=a,n.g=a,n.b=a;else{o/=60;var u=Math.floor(o),l=o-u,c=a*(1-s),h=a*(1-s*l),f=a*(1-s*(1-l));switch(u){case 0:n.r=a,n.g=f,n.b=c;break;case 1:n.r=h,n.g=a,n.b=c;break;case 2:n.r=c,n.g=a,n.b=f;break;case 3:n.r=c,n.g=h,n.b=a;break;case 4:n.r=f,n.g=c,n.b=a;break;default:n.r=a,n.g=c,n.b=h}}n.a=1},e.clamp=function(e,t,r){return Math.min(Math.max(e,t),r)},e.prototype.clone=function(){return n.a.Clone(function(){return new e},this)},e.prototype.serialize=function(){return n.a.Serialize(this)},e.Parse=function(t){return n.a.Parse(function(){return new e},t,null,null)},i.c([Object(n.c)()],e.prototype,"_globalHue",void 0),i.c([Object(n.c)()],e.prototype,"_globalDensity",void 0),i.c([Object(n.c)()],e.prototype,"_globalSaturation",void 0),i.c([Object(n.c)()],e.prototype,"_globalExposure",void 0),i.c([Object(n.c)()],e.prototype,"_highlightsHue",void 0),i.c([Object(n.c)()],e.prototype,"_highlightsDensity",void 0),i.c([Object(n.c)()],e.prototype,"_highlightsSaturation",void 0),i.c([Object(n.c)()],e.prototype,"_highlightsExposure",void 0),i.c([Object(n.c)()],e.prototype,"_midtonesHue",void 0),i.c([Object(n.c)()],e.prototype,"_midtonesDensity",void 0),i.c([Object(n.c)()],e.prototype,"_midtonesSaturation",void 0),i.c([Object(n.c)()],e.prototype,"_midtonesExposure",void 0),e}();n.a._ColorCurvesParser=s.Parse},145:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var i=function(){return function(){this.previous=null,this.next=null}}()},17:function(e,t,r){"use strict";r.d(t,"a",function(){return l});var i=r(9),n=r(19),o=r(0),s=r(21),a=r(3),u=r(44),l=function(){function e(){}return e.BindEyePosition=function(e,t){t._forcedViewPosition?e.setVector3("vEyePosition",t._forcedViewPosition):e.setVector3("vEyePosition",t._mirroredCameraPosition?t._mirroredCameraPosition:t.activeCamera.globalPosition)},e.PrepareDefinesForMergedUV=function(e,t,r){t._needUVs=!0,t[r]=!0,e.getTextureMatrix().isIdentityAs3x2()?(t[r+"DIRECTUV"]=e.coordinatesIndex+1,0===e.coordinatesIndex?t.MAINUV1=!0:t.MAINUV2=!0):t[r+"DIRECTUV"]=0},e.BindTextureMatrix=function(e,t,r){var i=e.getTextureMatrix();i.isIdentityAs3x2()||t.updateMatrix(r+"Matrix",i)},e.PrepareDefinesForMisc=function(e,t,r,i,o,s,a){a._areMiscDirty&&(a.LOGARITHMICDEPTH=r,a.POINTSIZE=i,a.FOG=t.fogEnabled&&e.applyFog&&t.fogMode!==n.Scene.FOGMODE_NONE&&o,a.NONUNIFORMSCALING=e.nonUniformScaling,a.ALPHATEST=s)},e.PrepareDefinesForFrameBoundValues=function(e,t,r,i,n){void 0===n&&(n=null);var o,s,a,u,l=!1;o=null==n?void 0!==e.clipPlane&&null!==e.clipPlane:n,s=null==n?void 0!==e.clipPlane2&&null!==e.clipPlane2:n,a=null==n?void 0!==e.clipPlane3&&null!==e.clipPlane3:n,u=null==n?void 0!==e.clipPlane4&&null!==e.clipPlane4:n,r.CLIPPLANE!==o&&(r.CLIPPLANE=o,l=!0),r.CLIPPLANE2!==s&&(r.CLIPPLANE2=s,l=!0),r.CLIPPLANE3!==a&&(r.CLIPPLANE3=a,l=!0),r.CLIPPLANE4!==u&&(r.CLIPPLANE4=u,l=!0),r.DEPTHPREPASS!==!t.getColorWrite()&&(r.DEPTHPREPASS=!r.DEPTHPREPASS,l=!0),r.INSTANCES!==i&&(r.INSTANCES=i,l=!0),l&&r.markAsUnprocessed()},e.PrepareDefinesForAttributes=function(e,t,r,i,n,o){if(void 0===n&&(n=!1),void 0===o&&(o=!0),!t._areAttributesDirty&&t._needNormals===t._normals&&t._needUVs===t._uvs)return!1;if(t._normals=t._needNormals,t._uvs=t._needUVs,t.NORMAL=t._needNormals&&e.isVerticesDataPresent(a.b.NormalKind),t._needNormals&&e.isVerticesDataPresent(a.b.TangentKind)&&(t.TANGENT=!0),t._needUVs?(t.UV1=e.isVerticesDataPresent(a.b.UVKind),t.UV2=e.isVerticesDataPresent(a.b.UV2Kind)):(t.UV1=!1,t.UV2=!1),r){var s=e.useVertexColors&&e.isVerticesDataPresent(a.b.ColorKind);t.VERTEXCOLOR=s,t.VERTEXALPHA=e.hasVertexAlpha&&s&&o}if(i)if(e.useBones&&e.computeBonesUsingShaders&&e.skeleton){t.NUM_BONE_INFLUENCERS=e.numBoneInfluencers;var u=void 0!==t.BONETEXTURE;e.skeleton.isUsingTextureForMatrices&&u?t.BONETEXTURE=!0:(t.BonesPerMesh=e.skeleton.bones.length+1,t.BONETEXTURE=!u&&void 0)}else t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0;if(n){var l=e.morphTargetManager;l?(t.MORPHTARGETS_TANGENT=l.supportsTangents&&t.TANGENT,t.MORPHTARGETS_NORMAL=l.supportsNormals&&t.NORMAL,t.MORPHTARGETS=l.numInfluencers>0,t.NUM_MORPH_INFLUENCERS=l.numInfluencers):(t.MORPHTARGETS_TANGENT=!1,t.MORPHTARGETS_NORMAL=!1,t.MORPHTARGETS=!1,t.NUM_MORPH_INFLUENCERS=0)}return!0},e.PrepareDefinesForLights=function(e,t,r,i,n,o){if(void 0===n&&(n=4),void 0===o&&(o=!1),!r._areLightsDirty)return r._needNormals;var s=0,a=!1,l=!1,c=!1,h=!1,f=!1;if(e.lightsEnabled&&!o)for(var p=0,d=t._lightSources;p<d.length;p++){var _=d[p];switch(a=!0,void 0===r["LIGHT"+s]&&(l=!0),r["LIGHT"+s]=!0,r["SPOTLIGHT"+s]=!1,r["HEMILIGHT"+s]=!1,r["POINTLIGHT"+s]=!1,r["DIRLIGHT"+s]=!1,_.prepareLightSpecificDefines(r,s),r["LIGHT_FALLOFF_PHYSICAL"+s]=!1,r["LIGHT_FALLOFF_GLTF"+s]=!1,r["LIGHT_FALLOFF_STANDARD"+s]=!1,_.falloffType){case u.a.FALLOFF_GLTF:r["LIGHT_FALLOFF_GLTF"+s]=!0;break;case u.a.FALLOFF_PHYSICAL:r["LIGHT_FALLOFF_PHYSICAL"+s]=!0;break;case u.a.FALLOFF_STANDARD:r["LIGHT_FALLOFF_STANDARD"+s]=!0}if(i&&!_.specular.equalsFloats(0,0,0)&&(f=!0),r["SHADOW"+s]=!1,r["SHADOWPCF"+s]=!1,r["SHADOWPCSS"+s]=!1,r["SHADOWPOISSON"+s]=!1,r["SHADOWESM"+s]=!1,r["SHADOWCUBE"+s]=!1,r["SHADOWLOWQUALITY"+s]=!1,r["SHADOWMEDIUMQUALITY"+s]=!1,t&&t.receiveShadows&&e.shadowsEnabled&&_.shadowEnabled){var g=_.getShadowGenerator();if(g){var m=g.getShadowMap();m&&m.renderList&&m.renderList.length>0&&(h=!0,g.prepareDefines(r,s))}}if(_.lightmapMode!=u.a.LIGHTMAP_DEFAULT?(c=!0,r["LIGHTMAPEXCLUDED"+s]=!0,r["LIGHTMAPNOSPECULAR"+s]=_.lightmapMode==u.a.LIGHTMAP_SHADOWSONLY):(r["LIGHTMAPEXCLUDED"+s]=!1,r["LIGHTMAPNOSPECULAR"+s]=!1),++s===n)break}r.SPECULARTERM=f,r.SHADOWS=h;for(var T=s;T<n;T++)void 0!==r["LIGHT"+T]&&(r["LIGHT"+T]=!1,r["HEMILIGHT"+s]=!1,r["POINTLIGHT"+s]=!1,r["DIRLIGHT"+s]=!1,r["SPOTLIGHT"+s]=!1,r["SHADOW"+s]=!1);var E=e.getEngine().getCaps();return void 0===r.SHADOWFLOAT&&(l=!0),r.SHADOWFLOAT=h&&(E.textureFloatRender&&E.textureFloatLinearFiltering||E.textureHalfFloatRender&&E.textureHalfFloatLinearFiltering),r.LIGHTMAPEXCLUDED=c,l&&r.rebuild(),a},e.PrepareUniformsAndSamplersList=function(e,t,r,i){var n;void 0===i&&(i=4);var o=null;if(e.uniformsNames){var s=e;n=s.uniformsNames,o=s.uniformBuffersNames,t=s.samplers,r=s.defines,i=s.maxSimultaneousLights}else n=e,t||(t=[]);for(var a=0;a<i&&r["LIGHT"+a];a++)n.push("vLightData"+a,"vLightDiffuse"+a,"vLightSpecular"+a,"vLightDirection"+a,"vLightFalloff"+a,"vLightGround"+a,"lightMatrix"+a,"shadowsInfo"+a,"depthValues"+a),o&&o.push("Light"+a),t.push("shadowSampler"+a),t.push("depthSampler"+a),r["PROJECTEDLIGHTTEXTURE"+a]&&(t.push("projectionLightSampler"+a),n.push("textureProjectionMatrix"+a));r.NUM_MORPH_INFLUENCERS&&n.push("morphTargetInfluences")},e.HandleFallbacksForShadows=function(e,t,r,i){void 0===r&&(r=4),void 0===i&&(i=0);for(var n=0,o=0;o<r&&e["LIGHT"+o];o++)o>0&&(n=i+o,t.addFallback(n,"LIGHT"+o)),e.SHADOWS||(e["SHADOW"+o]&&t.addFallback(i,"SHADOW"+o),e["SHADOWPCF"+o]&&t.addFallback(i,"SHADOWPCF"+o),e["SHADOWPCSS"+o]&&t.addFallback(i,"SHADOWPCSS"+o),e["SHADOWPOISSON"+o]&&t.addFallback(i,"SHADOWPOISSON"+o),e["SHADOWESM"+o]&&t.addFallback(i,"SHADOWESM"+o));return n++},e.PrepareAttributesForMorphTargets=function(e,t,r){var n=r.NUM_MORPH_INFLUENCERS;if(n>0&&s.a.LastCreatedEngine)for(var o=s.a.LastCreatedEngine.getCaps().maxVertexAttribs,u=t.morphTargetManager,l=u&&u.supportsNormals&&r.NORMAL,c=u&&u.supportsTangents&&r.TANGENT,h=0;h<n;h++)e.push(a.b.PositionKind+h),l&&e.push(a.b.NormalKind+h),c&&e.push(a.b.TangentKind+h),e.length>o&&i.a.Error("Cannot add more vertex attributes for mesh "+t.name)},e.PrepareAttributesForBones=function(e,t,r,i){r.NUM_BONE_INFLUENCERS>0&&(i.addCPUSkinningFallback(0,t),e.push(a.b.MatricesIndicesKind),e.push(a.b.MatricesWeightsKind),r.NUM_BONE_INFLUENCERS>4&&(e.push(a.b.MatricesIndicesExtraKind),e.push(a.b.MatricesWeightsExtraKind)))},e.PrepareAttributesForInstances=function(e,t){t.INSTANCES&&(e.push("world0"),e.push("world1"),e.push("world2"),e.push("world3"))},e.BindLightShadow=function(e,t,r,i){if(e.shadowEnabled&&t.receiveShadows){var n=e.getShadowGenerator();n&&n.bindShadowLight(r,i)}},e.BindLightProperties=function(e,t,r){e.transferToEffect(t,r+"")},e.BindLights=function(t,r,i,n,s,a){void 0===s&&(s=4),void 0===a&&(a=!1);for(var u=Math.min(r._lightSources.length,s),l=0;l<u;l++){var c=r._lightSources[l],h=l.toString(),f=c.getScaledIntensity();c._uniformBuffer.bindToEffect(i,"Light"+l),e.BindLightProperties(c,i,l),c.diffuse.scaleToRef(f,o.Tmp.Color3[0]),c._uniformBuffer.updateColor4("vLightDiffuse",o.Tmp.Color3[0],a?c.radius:c.range,h),n.SPECULARTERM&&(c.specular.scaleToRef(f,o.Tmp.Color3[1]),c._uniformBuffer.updateColor3("vLightSpecular",o.Tmp.Color3[1],h)),t.shadowsEnabled&&this.BindLightShadow(c,r,h,i),c._uniformBuffer.update()}},e.BindFogParameters=function(e,t,r,i){void 0===i&&(i=!1),e.fogEnabled&&t.applyFog&&e.fogMode!==n.Scene.FOGMODE_NONE&&(r.setFloat4("vFogInfos",e.fogMode,e.fogStart,e.fogEnd,e.fogDensity),i?(e.fogColor.toLinearSpaceToRef(this._tempFogColor),r.setColor3("vFogColor",this._tempFogColor)):r.setColor3("vFogColor",e.fogColor))},e.BindBonesParameters=function(e,t){if(t&&e&&(e.computeBonesUsingShaders&&t._bonesComputationForcedToCPU&&(e.computeBonesUsingShaders=!1),e.useBones&&e.computeBonesUsingShaders&&e.skeleton)){var r=e.skeleton;if(r.isUsingTextureForMatrices&&t.getUniformIndex("boneTextureWidth")>-1){var i=r.getTransformMatrixTexture();t.setTexture("boneSampler",i),t.setFloat("boneTextureWidth",4*(r.bones.length+1))}else{var n=r.getTransformMatrices(e);n&&t.setMatrices("mBones",n)}}},e.BindMorphTargetParameters=function(e,t){var r=e.morphTargetManager;e&&r&&t.setFloatArray("morphTargetInfluences",r.influences)},e.BindLogDepth=function(e,t,r){e.LOGARITHMICDEPTH&&t.setFloat("logarithmicDepthConstant",2/(Math.log(r.activeCamera.maxZ+1)/Math.LN2))},e.BindClipPlane=function(e,t){if(t.clipPlane){var r=t.clipPlane;e.setFloat4("vClipPlane",r.normal.x,r.normal.y,r.normal.z,r.d)}if(t.clipPlane2){r=t.clipPlane2;e.setFloat4("vClipPlane2",r.normal.x,r.normal.y,r.normal.z,r.d)}if(t.clipPlane3){r=t.clipPlane3;e.setFloat4("vClipPlane3",r.normal.x,r.normal.y,r.normal.z,r.d)}if(t.clipPlane4){r=t.clipPlane4;e.setFloat4("vClipPlane4",r.normal.x,r.normal.y,r.normal.z,r.d)}},e._tempFogColor=o.Color3.Black(),e}()},192:function(e,t,r){"use strict";r.d(t,"a",function(){return l});var i=r(1),n=r(0),o=r(6),s=r(39),a=r(50),u=r(4),l=function(e){function t(t,r,i,s,a,l,c){void 0===a&&(a=u.a.TEXTURETYPE_UNSIGNED_INT),void 0===l&&(l=o.a.BILINEAR_SAMPLINGMODE),void 0===c&&(c=!0);var h=e.call(this,t,r,i,s,!0,a,!1,l,c)||this;return h.scene=i,h.mirrorPlane=new n.Plane(0,1,0,1),h._transformMatrix=n.Matrix.Zero(),h._mirrorMatrix=n.Matrix.Zero(),h._adaptiveBlurKernel=0,h._blurKernelX=0,h._blurKernelY=0,h._blurRatio=1,h.ignoreCameraViewport=!0,h._updateGammaSpace(),h._imageProcessingConfigChangeObserver=i.imageProcessingConfiguration.onUpdateParameters.add(function(){h._updateGammaSpace}),h.onBeforeRenderObservable.add(function(){n.Matrix.ReflectionToRef(h.mirrorPlane,h._mirrorMatrix),h._savedViewMatrix=i.getViewMatrix(),h._mirrorMatrix.multiplyToRef(h._savedViewMatrix,h._transformMatrix),i.setTransformMatrix(h._transformMatrix,i.getProjectionMatrix()),i.clipPlane=h.mirrorPlane,i.getEngine().cullBackFaces=!1,i._mirroredCameraPosition=n.Vector3.TransformCoordinates(i.activeCamera.globalPosition,h._mirrorMatrix)}),h.onAfterRenderObservable.add(function(){i.setTransformMatrix(h._savedViewMatrix,i.getProjectionMatrix()),i.getEngine().cullBackFaces=!0,i._mirroredCameraPosition=null,delete i.clipPlane}),h}return i.d(t,e),Object.defineProperty(t.prototype,"blurRatio",{get:function(){return this._blurRatio},set:function(e){this._blurRatio!==e&&(this._blurRatio=e,this._preparePostProcesses())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"adaptiveBlurKernel",{set:function(e){this._adaptiveBlurKernel=e,this._autoComputeBlurKernel()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blurKernel",{set:function(e){this.blurKernelX=e,this.blurKernelY=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blurKernelX",{get:function(){return this._blurKernelX},set:function(e){this._blurKernelX!==e&&(this._blurKernelX=e,this._preparePostProcesses())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blurKernelY",{get:function(){return this._blurKernelY},set:function(e){this._blurKernelY!==e&&(this._blurKernelY=e,this._preparePostProcesses())},enumerable:!0,configurable:!0}),t.prototype._autoComputeBlurKernel=function(){var e=this.getScene().getEngine(),t=this.getRenderWidth()/e.getRenderWidth(),r=this.getRenderHeight()/e.getRenderHeight();this.blurKernelX=this._adaptiveBlurKernel*t,this.blurKernelY=this._adaptiveBlurKernel*r},t.prototype._onRatioRescale=function(){this._sizeRatio&&(this.resize(this._initialSizeParameter),this._adaptiveBlurKernel||this._preparePostProcesses()),this._adaptiveBlurKernel&&this._autoComputeBlurKernel()},t.prototype._updateGammaSpace=function(){this.gammaSpace=!this.scene.imageProcessingConfiguration.isEnabled||!this.scene.imageProcessingConfiguration.applyByPostProcess},t.prototype._preparePostProcesses=function(){if(this.clearPostProcesses(!0),this._blurKernelX&&this._blurKernelY){var e=this.getScene().getEngine(),t=e.getCaps().textureFloatRender?u.a.TEXTURETYPE_FLOAT:u.a.TEXTURETYPE_HALF_FLOAT;this._blurX=new a.a("horizontal blur",new n.Vector2(1,0),this._blurKernelX,this._blurRatio,null,o.a.BILINEAR_SAMPLINGMODE,e,!1,t),this._blurX.autoClear=!1,1===this._blurRatio&&this.samples<2&&this._texture?this._blurX.inputTexture=this._texture:this._blurX.alwaysForcePOT=!0,this._blurY=new a.a("vertical blur",new n.Vector2(0,1),this._blurKernelY,this._blurRatio,null,o.a.BILINEAR_SAMPLINGMODE,e,!1,t),this._blurY.autoClear=!1,this._blurY.alwaysForcePOT=1!==this._blurRatio,this.addPostProcess(this._blurX),this.addPostProcess(this._blurY)}else this._blurY&&(this.removePostProcess(this._blurY),this._blurY.dispose(),this._blurY=null),this._blurX&&(this.removePostProcess(this._blurX),this._blurX.dispose(),this._blurX=null)},t.prototype.clone=function(){var e=this.getScene();if(!e)return this;var r=this.getSize(),i=new t(this.name,r.width,e,this._renderTargetOptions.generateMipMaps,this._renderTargetOptions.type,this._renderTargetOptions.samplingMode,this._renderTargetOptions.generateDepthBuffer);return i.hasAlpha=this.hasAlpha,i.level=this.level,i.mirrorPlane=this.mirrorPlane.clone(),this.renderList&&(i.renderList=this.renderList.slice(0)),i},t.prototype.serialize=function(){if(!this.name)return null;var t=e.prototype.serialize.call(this);return t.mirrorPlane=this.mirrorPlane.asArray(),t},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.scene.imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingConfigChangeObserver)},t}(s.a);o.a._CreateMirror=function(e,t,r,i){return new l(e,t,r,i)}},193:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var i=r(1),n=r(7),o=r(5),s=r(9),a=r(6),u=function(e){function t(t,r,i,n,s,u,l){void 0===n&&(n=!1),void 0===s&&(s=!1),void 0===u&&(u=a.a.TRILINEAR_SAMPLINGMODE),void 0===l&&(l={autoPlay:!0,loop:!0,autoUpdateTexture:!0});var c=e.call(this,null,i,!n,s)||this;c._onUserActionRequestedObservable=null,c._stillImageCaptured=!1,c._displayingPosterTexture=!1,c._createInternalTexture=function(){if(null!=c._texture){if(!c._displayingPosterTexture)return;c._texture.dispose(),c._displayingPosterTexture=!1}if(!c._engine.needPOTTextures||o.h.IsExponentOfTwo(c.video.videoWidth)&&o.h.IsExponentOfTwo(c.video.videoHeight)?(c.wrapU=a.a.WRAP_ADDRESSMODE,c.wrapV=a.a.WRAP_ADDRESSMODE):(c.wrapU=a.a.CLAMP_ADDRESSMODE,c.wrapV=a.a.CLAMP_ADDRESSMODE,c._generateMipMaps=!1),c._texture=c._engine.createDynamicTexture(c.video.videoWidth,c.video.videoHeight,c._generateMipMaps,c.samplingMode),c.video.autoplay||c._settings.poster)c._texture.isReady=!0,c._updateInternalTexture(),c.onLoadObservable.hasObservers()&&c.onLoadObservable.notifyObservers(c);else{var e=c.video.onplaying,t=!1;c.video.onplaying=function(){c.video.onplaying=e,c._texture.isReady=!0,c._updateInternalTexture(),t||c.video.pause(),c.onLoadObservable.hasObservers()&&c.onLoadObservable.notifyObservers(c)};var r=c.video.play();r?r.then(function(){}).catch(function(){t=!0,c._onUserActionRequestedObservable&&c._onUserActionRequestedObservable.hasObservers()&&c._onUserActionRequestedObservable.notifyObservers(c)}):(c.video.onplaying=e,c._texture.isReady=!0,c._updateInternalTexture(),c.onLoadObservable.hasObservers()&&c.onLoadObservable.notifyObservers(c))}},c.reset=function(){null!=c._texture&&(c._displayingPosterTexture||(c._texture.dispose(),c._texture=null))},c._updateInternalTexture=function(){null!=c._texture&&c._texture.isReady&&(c.video.readyState<c.video.HAVE_CURRENT_DATA||c._displayingPosterTexture||c._engine.updateVideoTexture(c._texture,c.video,c._invertY))},c._engine=c.getScene().getEngine(),c._generateMipMaps=n,c._initialSamplingMode=u,c.autoUpdateTexture=l.autoUpdateTexture,c.name=t||c._getName(r),c.video=c._getVideo(r),c._settings=l,l.poster&&(c.video.poster=l.poster),void 0!==l.autoPlay&&(c.video.autoplay=l.autoPlay),void 0!==l.loop&&(c.video.loop=l.loop),c.video.setAttribute("playsinline",""),c.video.addEventListener("paused",c._updateInternalTexture),c.video.addEventListener("seeked",c._updateInternalTexture),c.video.addEventListener("emptied",c.reset),c._createInternalTextureOnEvent=l.poster&&!l.autoPlay?"play":"canplay",c.video.addEventListener(c._createInternalTextureOnEvent,c._createInternalTexture);var h=c.video.readyState>=c.video.HAVE_CURRENT_DATA;return!l.poster||l.autoPlay&&h?h&&c._createInternalTexture():(c._texture=c._engine.createTexture(l.poster,!1,!0,i),c._displayingPosterTexture=!0),c}return i.d(t,e),Object.defineProperty(t.prototype,"onUserActionRequestedObservable",{get:function(){return this._onUserActionRequestedObservable||(this._onUserActionRequestedObservable=new n.c),this._onUserActionRequestedObservable},enumerable:!0,configurable:!0}),t.prototype._getName=function(e){return e instanceof HTMLVideoElement?e.currentSrc:"object"==typeof e?e.toString():e},t.prototype._getVideo=function(e){if(e instanceof HTMLVideoElement)return o.h.SetCorsBehavior(e.currentSrc,e),e;var t=document.createElement("video");return"string"==typeof e?(o.h.SetCorsBehavior(e,t),t.src=e):(o.h.SetCorsBehavior(e[0],t),e.forEach(function(e){var r=document.createElement("source");r.src=e,t.appendChild(r)})),t},t.prototype._rebuild=function(){this.update()},t.prototype.update=function(){this.autoUpdateTexture&&this.updateTexture(!0)},t.prototype.updateTexture=function(e){e&&(this.video.paused&&this._stillImageCaptured||(this._stillImageCaptured=!0,this._updateInternalTexture()))},t.prototype.updateURL=function(e){this.video.src=e},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._onUserActionRequestedObservable&&(this._onUserActionRequestedObservable.clear(),this._onUserActionRequestedObservable=null),this.video.removeEventListener(this._createInternalTextureOnEvent,this._createInternalTexture),this.video.removeEventListener("paused",this._updateInternalTexture),this.video.removeEventListener("seeked",this._updateInternalTexture),this.video.removeEventListener("emptied",this.reset),this.video.pause()},t.CreateFromWebCam=function(e,r,i){var n,o=document.createElement("video");o.setAttribute("autoplay",""),o.setAttribute("muted",""),o.setAttribute("playsinline",""),i&&i.deviceId&&(n={exact:i.deviceId}),window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,navigator.mediaDevices?navigator.mediaDevices.getUserMedia({video:i}).then(function(i){void 0!==o.mozSrcObject?o.mozSrcObject=i:o.srcObject=i;var n=function(){r&&r(new t("video",o,e,!0,!0)),o.removeEventListener("playing",n)};o.addEventListener("playing",n),o.play()}).catch(function(e){s.a.Error(e.name)}):(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia&&navigator.getUserMedia({video:{deviceId:n,width:{min:i&&i.minWidth||256,max:i&&i.maxWidth||640},height:{min:i&&i.minHeight||256,max:i&&i.maxHeight||480}}},function(i){void 0!==o.mozSrcObject?o.mozSrcObject=i:o.src=window.URL&&window.URL.createObjectURL(i)||i,o.play(),r&&r(new t("video",o,e,!0,!0))},function(e){s.a.Error(e.name)}))},t}(a.a)},20:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var i=r(11),n=r(4),o=function(){function e(){}return Object.defineProperty(e,"DiffuseTextureEnabled",{get:function(){return this._DiffuseTextureEnabled},set:function(e){this._DiffuseTextureEnabled!==e&&(this._DiffuseTextureEnabled=e,i.Engine.MarkAllMaterialsAsDirty(n.a.MATERIAL_TextureDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AmbientTextureEnabled",{get:function(){return this._AmbientTextureEnabled},set:function(e){this._AmbientTextureEnabled!==e&&(this._AmbientTextureEnabled=e,i.Engine.MarkAllMaterialsAsDirty(n.a.MATERIAL_TextureDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OpacityTextureEnabled",{get:function(){return this._OpacityTextureEnabled},set:function(e){this._OpacityTextureEnabled!==e&&(this._OpacityTextureEnabled=e,i.Engine.MarkAllMaterialsAsDirty(n.a.MATERIAL_TextureDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ReflectionTextureEnabled",{get:function(){return this._ReflectionTextureEnabled},set:function(e){this._ReflectionTextureEnabled!==e&&(this._ReflectionTextureEnabled=e,i.Engine.MarkAllMaterialsAsDirty(n.a.MATERIAL_TextureDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EmissiveTextureEnabled",{get:function(){return this._EmissiveTextureEnabled},set:function(e){this._EmissiveTextureEnabled!==e&&(this._EmissiveTextureEnabled=e,i.Engine.MarkAllMaterialsAsDirty(n.a.MATERIAL_TextureDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SpecularTextureEnabled",{get:function(){return this._SpecularTextureEnabled},set:function(e){this._SpecularTextureEnabled!==e&&(this._SpecularTextureEnabled=e,i.Engine.MarkAllMaterialsAsDirty(n.a.MATERIAL_TextureDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BumpTextureEnabled",{get:function(){return this._BumpTextureEnabled},set:function(e){this._BumpTextureEnabled!==e&&(this._BumpTextureEnabled=e,i.Engine.MarkAllMaterialsAsDirty(n.a.MATERIAL_TextureDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"LightmapTextureEnabled",{get:function(){return this._LightmapTextureEnabled},set:function(e){this._LightmapTextureEnabled!==e&&(this._LightmapTextureEnabled=e,i.Engine.MarkAllMaterialsAsDirty(n.a.MATERIAL_TextureDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RefractionTextureEnabled",{get:function(){return this._RefractionTextureEnabled},set:function(e){this._RefractionTextureEnabled!==e&&(this._RefractionTextureEnabled=e,i.Engine.MarkAllMaterialsAsDirty(n.a.MATERIAL_TextureDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ColorGradingTextureEnabled",{get:function(){return this._ColorGradingTextureEnabled},set:function(e){this._ColorGradingTextureEnabled!==e&&(this._ColorGradingTextureEnabled=e,i.Engine.MarkAllMaterialsAsDirty(n.a.MATERIAL_TextureDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FresnelEnabled",{get:function(){return this._FresnelEnabled},set:function(e){this._FresnelEnabled!==e&&(this._FresnelEnabled=e,i.Engine.MarkAllMaterialsAsDirty(n.a.MATERIAL_FresnelDirtyFlag))},enumerable:!0,configurable:!0}),e._DiffuseTextureEnabled=!0,e._AmbientTextureEnabled=!0,e._OpacityTextureEnabled=!0,e._ReflectionTextureEnabled=!0,e._EmissiveTextureEnabled=!0,e._SpecularTextureEnabled=!0,e._BumpTextureEnabled=!0,e._LightmapTextureEnabled=!0,e._RefractionTextureEnabled=!0,e._ColorGradingTextureEnabled=!0,e._FresnelEnabled=!0,e}()},202:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var i=r(1),n=r(2),o=r(137),s=r(26),a=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i._useRoughnessFromMetallicTextureAlpha=!1,i._useRoughnessFromMetallicTextureGreen=!0,i._useMetallnessFromMetallicTextureBlue=!0,i.metallic=1,i.roughness=1,i}return i.d(t,e),t.prototype.getClassName=function(){return"PBRMetallicRoughnessMaterial"},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this.baseTexture&&t.push(this.baseTexture),this.metallicRoughnessTexture&&t.push(this.metallicRoughnessTexture),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||(this.baseTexture===t||this.metallicRoughnessTexture===t)},t.prototype.clone=function(e){var r=this,i=n.a.Clone(function(){return new t(e,r.getScene())},this);return i.id=e,i.name=e,i},t.prototype.serialize=function(){var e=n.a.Serialize(this);return e.customType="BABYLON.PBRMetallicRoughnessMaterial",e},t.Parse=function(e,r,i){return n.a.Parse(function(){return new t(e.name,r)},e,r,i)},i.c([Object(n.e)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty","_albedoColor")],t.prototype,"baseColor",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty","_albedoTexture")],t.prototype,"baseTexture",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"metallic",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"roughness",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty","_metallicTexture")],t.prototype,"metallicRoughnessTexture",void 0),t}(o.a);s.a.RegisteredTypes["BABYLON.PBRMetallicRoughnessMaterial"]=a},203:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var i=r(1),n=r(6),o=r(39),s=r(4),a=function(e){function t(t,r,i,o,a){var u=this,l=!(!a||!a.generateMipMaps)&&a.generateMipMaps,c=!(!a||!a.generateDepthTexture)&&a.generateDepthTexture,h=!a||void 0===a.doNotChangeAspectRatio||a.doNotChangeAspectRatio;if((u=e.call(this,t,r,o,l,h)||this)._engine=o.getEngine(),u.isSupported){for(var f=[],p=[],d=0;d<i;d++)a&&a.types&&void 0!==a.types[d]?f.push(a.types[d]):f.push(a&&a.defaultType?a.defaultType:s.a.TEXTURETYPE_UNSIGNED_INT),a&&a.samplingModes&&void 0!==a.samplingModes[d]?p.push(a.samplingModes[d]):p.push(n.a.BILINEAR_SAMPLINGMODE);var _=!a||void 0===a.generateDepthBuffer||a.generateDepthBuffer,g=!(!a||void 0===a.generateStencilBuffer)&&a.generateStencilBuffer;return u._size=r,u._multiRenderTargetOptions={samplingModes:p,generateMipMaps:l,generateDepthBuffer:_,generateStencilBuffer:g,generateDepthTexture:c,types:f,textureCount:i},u._createInternalTextures(),u._createTextures(),u}u.dispose()}return i.d(t,e),Object.defineProperty(t.prototype,"isSupported",{get:function(){return this._engine.webGLVersion>1||this._engine.getCaps().drawBuffersExtension},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textures",{get:function(){return this._textures},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"depthTexture",{get:function(){return this._textures[this._textures.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wrapU",{set:function(e){if(this._textures)for(var t=0;t<this._textures.length;t++)this._textures[t].wrapU=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wrapV",{set:function(e){if(this._textures)for(var t=0;t<this._textures.length;t++)this._textures[t].wrapV=e},enumerable:!0,configurable:!0}),t.prototype._rebuild=function(){this.releaseInternalTextures(),this._createInternalTextures();for(var e=0;e<this._internalTextures.length;e++){this._textures[e]._texture=this._internalTextures[e]}this._texture=this._internalTextures[0]},t.prototype._createInternalTextures=function(){this._internalTextures=this._engine.createMultipleRenderTarget(this._size,this._multiRenderTargetOptions)},t.prototype._createTextures=function(){this._textures=[];for(var e=0;e<this._internalTextures.length;e++){var t=new n.a(null,this.getScene());t._texture=this._internalTextures[e],this._textures.push(t)}this._texture=this._internalTextures[0]},Object.defineProperty(t.prototype,"samples",{get:function(){return this._samples},set:function(e){this._samples!==e&&(this._samples=this._engine.updateMultipleRenderTargetTextureSampleCount(this._internalTextures,e))},enumerable:!0,configurable:!0}),t.prototype.resize=function(e){this.releaseInternalTextures(),this._internalTextures=this._engine.createMultipleRenderTarget(e,this._multiRenderTargetOptions),this._createInternalTextures()},t.prototype.unbindFrameBuffer=function(e,t){var r=this;e.unBindMultiColorAttachmentFramebuffer(this._internalTextures,this.isCube,function(){r.onAfterRenderObservable.notifyObservers(t)})},t.prototype.dispose=function(){this.releaseInternalTextures(),e.prototype.dispose.call(this)},t.prototype.releaseInternalTextures=function(){if(this._internalTextures)for(var e=this._internalTextures.length-1;e>=0;e--)void 0!==this._internalTextures[e]&&(this._internalTextures[e].dispose(),this._internalTextures.splice(e,1))},t}(o.a)},204:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var i=r(5),n=r(15),o=function(){function e(e){this.name=n.a.NAME_PROCEDURALTEXTURE,this.scene=e,this.scene.proceduralTextures=new Array,e.layers=new Array}return e.prototype.register=function(){this.scene._beforeClearStage.registerStep(n.a.STEP_BEFORECLEAR_PROCEDURALTEXTURE,this,this._beforeClear)},e.prototype.rebuild=function(){},e.prototype.dispose=function(){},e.prototype._beforeClear=function(){if(this.scene.proceduralTexturesEnabled){i.h.StartPerformanceCounter("Procedural textures",this.scene.proceduralTextures.length>0);for(var e=0;e<this.scene.proceduralTextures.length;e++){var t=this.scene.proceduralTextures[e];t._shouldRender()&&t.render()}i.h.EndPerformanceCounter("Procedural textures",this.scene.proceduralTextures.length>0)}},e}()},205:function(e,t,r){"use strict";r.d(t,"a",function(){return l});var i=r(1),n=r(2),o=r(112),s=r(30),a=r(83),u=r(4),l=function(e){function t(t,r,i,n,o,s,a,l,c){void 0===n&&(n=u.a.TEXTUREFORMAT_RGBA),void 0===o&&(o=u.a.TEXTURETYPE_UNSIGNED_INT),void 0===s&&(s=!1),void 0===a&&(a=!1),void 0===l&&(l=u.a.TEXTURE_TRILINEAR_SAMPLINGMODE),void 0===c&&(c=null);var h=e.call(this,"",t)||this;return h._texture=t.getEngine().createRawCubeTexture(r,i,n,o,s,a,l,c),h}return i.d(t,e),t.prototype.update=function(e,t,r,i,n){void 0===n&&(n=null),this._texture.getEngine().updateRawCubeTexture(this._texture,e,t,r,i,n)},t.prototype.updateRGBDAsync=function(e,r,i,n){return void 0===r&&(r=null),void 0===i&&(i=.8),void 0===n&&(n=0),t._UpdateRGBDAsync(this._texture,e,r,i,n)},t.prototype.clone=function(){var e=this;return n.a.Clone(function(){var r=e.getScene(),i=e._texture,n=new t(r,i._bufferViewArray,i.width,i.format,i.type,i.generateMipMaps,i.invertY,i.samplingMode,i._compression);return i.dataSource===s.a.DATASOURCE_CUBERAW_RGBD&&n.updateRGBDAsync(i._bufferViewArrayArray,i._sphericalPolynomial,i._lodGenerationScale,i._lodGenerationOffset),n},this)},t._UpdateRGBDAsync=function(e,t,r,i,n){return e._dataSource=s.a.DATASOURCE_CUBERAW_RGBD,e._bufferViewArrayArray=t,e._lodGenerationScale=i,e._lodGenerationOffset=n,e._sphericalPolynomial=r,o.a.UploadLevelsAsync(e,t).then(function(){e.isReady=!0})},t}(a.a)},231:function(e,t,r){"use strict";var i=r(12);r.d(t,"r",function(){return i.a});var n=r(0);r.d(t,"a",function(){return n.Angle}),r.d(t,"b",function(){return n.Arc2}),r.d(t,"c",function(){return n.Axis}),r.d(t,"d",function(){return n.BezierCurve}),r.d(t,"e",function(){return n.Color3}),r.d(t,"f",function(){return n.Color4}),r.d(t,"g",function(){return n.Curve3}),r.d(t,"h",function(){return n.Epsilon}),r.d(t,"i",function(){return n.Frustum}),r.d(t,"j",function(){return n.Matrix}),r.d(t,"k",function(){return n.Orientation}),r.d(t,"l",function(){return n.Path2}),r.d(t,"m",function(){return n.Path3D}),r.d(t,"n",function(){return n.Plane}),r.d(t,"o",function(){return n.PositionNormalTextureVertex}),r.d(t,"p",function(){return n.PositionNormalVertex}),r.d(t,"q",function(){return n.Quaternion}),r.d(t,"s",function(){return n.Size}),r.d(t,"t",function(){return n.Space}),r.d(t,"w",function(){return n.Tmp}),r.d(t,"x",function(){return n.ToGammaSpace}),r.d(t,"y",function(){return n.ToLinearSpace}),r.d(t,"z",function(){return n.Vector2}),r.d(t,"A",function(){return n.Vector3}),r.d(t,"B",function(){return n.Vector4}),r.d(t,"C",function(){return n.Viewport});var o=r(68);r.d(t,"u",function(){return o.a}),r.d(t,"v",function(){return o.b})},246:function(e,t,r){"use strict";var i=r(100),n=r(140),o=r(8),s=r(41),a=r(0),u=r(11),l=r(2),c=r(4),h=function(){function e(){this._isEnabled=!0,this.leftColor=a.Color3.White(),this.rightColor=a.Color3.Black(),this.bias=0,this.power=1}return Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(e){this._isEnabled!==e&&(this._isEnabled=e,u.Engine.MarkAllMaterialsAsDirty(c.a.MATERIAL_FresnelDirtyFlag|c.a.MATERIAL_MiscDirtyFlag))},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return s.a.DeepCopy(this,t),t},e.prototype.serialize=function(){var e={};return e.isEnabled=this.isEnabled,e.leftColor=this.leftColor.asArray(),e.rightColor=this.rightColor.asArray(),e.bias=this.bias,e.power=this.power,e},e.Parse=function(t){var r=new e;return r.isEnabled=t.isEnabled,r.leftColor=a.Color3.FromArray(t.leftColor),r.rightColor=a.Color3.FromArray(t.rightColor),r.bias=t.bias,r.power=t.power||1,r},e}();l.a._FresnelParametersParser=h.Parse;var f=r(40),p=r(14),d=r(76),_=r(17),g=r(84),m=r(60),T=r(137),E=r(54),b=r(202),A=r(1),v=r(26),y=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i._useMicroSurfaceFromReflectivityMapAlpha=!0,i}return A.d(t,e),t.prototype.getClassName=function(){return"PBRSpecularGlossinessMaterial"},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this.diffuseTexture&&t.push(this.diffuseTexture),this.specularGlossinessTexture&&t.push(this.specularGlossinessTexture),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||(this.diffuseTexture===t||this.specularGlossinessTexture===t)},t.prototype.clone=function(e){var r=this,i=l.a.Clone(function(){return new t(e,r.getScene())},this);return i.id=e,i.name=e,i},t.prototype.serialize=function(){var e=l.a.Serialize(this);return e.customType="BABYLON.PBRSpecularGlossinessMaterial",e},t.Parse=function(e,r,i){return l.a.Parse(function(){return new t(e.name,r)},e,r,i)},A.c([Object(l.e)("diffuse"),Object(l.b)("_markAllSubMeshesAsTexturesDirty","_albedoColor")],t.prototype,"diffuseColor",void 0),A.c([Object(l.l)(),Object(l.b)("_markAllSubMeshesAsTexturesDirty","_albedoTexture")],t.prototype,"diffuseTexture",void 0),A.c([Object(l.e)("specular"),Object(l.b)("_markAllSubMeshesAsTexturesDirty","_reflectivityColor")],t.prototype,"specularColor",void 0),A.c([Object(l.c)(),Object(l.b)("_markAllSubMeshesAsTexturesDirty","_microSurface")],t.prototype,"glossiness",void 0),A.c([Object(l.l)(),Object(l.b)("_markAllSubMeshesAsTexturesDirty","_reflectivityTexture")],t.prototype,"specularGlossinessTexture",void 0),t}(T.a);v.a.RegisteredTypes["BABYLON.PBRSpecularGlossinessMaterial"]=y;var x=r(90),O=r(78),R=r(31),M=r(58),C=function(e){function t(t,r){var i=e.call(this,r)||this;return t?(i._engine=r.getEngine(),i._textureMatrix=a.Matrix.Identity(),i.name=t,i.url=t,i.hasAlpha=!1,i.isCube=!1,i.is3D=i._engine.webGLVersion>1,i.wrapU=c.a.TEXTURE_CLAMP_ADDRESSMODE,i.wrapV=c.a.TEXTURE_CLAMP_ADDRESSMODE,i.wrapR=c.a.TEXTURE_CLAMP_ADDRESSMODE,i.anisotropicFilteringLevel=1,i._texture=i._getFromCache(t,!0),i._texture||(r.useDelayedTextureLoading?i.delayLoadState=c.a.DELAYLOADSTATE_NOTLOADED:i.loadTexture()),i):i}return A.d(t,e),t.prototype.getTextureMatrix=function(){return this._textureMatrix},t.prototype.load3dlTexture=function(){var e,r=this._engine;e=1===r.webGLVersion?r.createRawTexture(null,1,1,c.a.TEXTUREFORMAT_RGBA,!1,!1,c.a.TEXTURE_BILINEAR_SAMPLINGMODE):r.createRawTexture3D(null,1,1,1,c.a.TEXTUREFORMAT_RGBA,!1,!1,c.a.TEXTURE_BILINEAR_SAMPLINGMODE),this._texture=e;var i=function(i){if("string"==typeof i){for(var n,o=null,s=null,a=i.split("\n"),u=0,l=0,h=0,f=0,p=0,d=0;d<a.length;d++)if(n=a[d],t._noneEmptyLineRegex.test(n)&&0!==n.indexOf("#")){var _=n.split(" ");if(0!==u){if(0!=u){var g=Math.max(parseInt(_[0]),0),m=Math.max(parseInt(_[1]),0),T=Math.max(parseInt(_[2]),0);p=Math.max(g,p),p=Math.max(m,p),p=Math.max(T,p);var E=4*(l+f*u+h*u*u);s&&(s[E+0]=g,s[E+1]=m,s[E+2]=T),++h%u==0&&(h=0,++f%u==0&&(l++,f=0))}}else u=_.length,o=new Uint8Array(u*u*u*4),s=new Float32Array(u*u*u*4)}if(s&&o)for(d=0;d<s.length;d++)if(d>0&&(d+1)%4==0)o[d]=255;else{var b=s[d];o[d]=b/p*255}e.is3D?(e.updateSize(u,u,u),r.updateRawTexture3D(e,o,c.a.TEXTUREFORMAT_RGBA,!1)):(e.updateSize(u*u,u),r.updateRawTexture(e,o,c.a.TEXTUREFORMAT_RGBA,!1))}},n=this.getScene();return n?n._loadFile(this.url,i):this._engine._loadFile(this.url,i),this._texture},t.prototype.loadTexture=function(){this.url&&this.url.toLocaleLowerCase().indexOf(".3dl")==this.url.length-4&&this.load3dlTexture()},t.prototype.clone=function(){var e=new t(this.url,this.getScene());return e.level=this.level,e},t.prototype.delayLoad=function(){this.delayLoadState===c.a.DELAYLOADSTATE_NOTLOADED&&(this.delayLoadState=c.a.DELAYLOADSTATE_LOADED,this._texture=this._getFromCache(this.url,!0),this._texture||this.loadTexture())},t.Parse=function(e,r){var i=null;return e.name&&!e.isRenderTarget&&((i=new t(e.name,r)).name=e.name,i.level=e.level),i},t.prototype.serialize=function(){if(!this.name)return null;var e={};return e.name=this.name,e.level=this.level,e.customType="BABYLON.ColorGradingTexture",e},t._noneEmptyLineRegex=/\S+/,t}(M.a);v.a.RegisteredTypes["BABYLON.ColorGradingTexture"]=C;var S=r(83),P=r(77),L=r(135),I=r(30),D=r(145),F=r(68),N=r(105),B=function(){function e(){this.supportCascades=!0}return e.prototype.canLoad=function(e,t,r,i,n){return 0===e.indexOf(".dds")},e.prototype.transformUrl=function(e,t){return e},e.prototype.getFallbackTextureUrl=function(e,t){return null},e.prototype.loadCubeData=function(e,t,r,i,n){var o,s=t.getEngine(),a=!1;if(Array.isArray(e))for(var u=0;u<e.length;u++){var l=e[u];o=N.a.GetDDSInfo(l),t.width=o.width,t.height=o.height,a=(o.isRGB||o.isLuminance||o.mipmapCount>1)&&t.generateMipMaps,s._unpackFlipY(o.isCompressed),N.a.UploadDDSLevels(s,t,l,o,a,6,-1,u),o.isFourCC||1!==o.mipmapCount||s.generateMipMapsForCubemap(t)}else{var c=e;o=N.a.GetDDSInfo(c),t.width=o.width,t.height=o.height,r&&(o.sphericalPolynomial=new F.b),a=(o.isRGB||o.isLuminance||o.mipmapCount>1)&&t.generateMipMaps,s._unpackFlipY(o.isCompressed),N.a.UploadDDSLevels(s,t,c,o,a,6),o.isFourCC||1!==o.mipmapCount||s.generateMipMapsForCubemap(t)}s._setCubeMapTextureParams(a),t.isReady=!0,i&&i({isDDS:!0,width:t.width,info:o,data:e,texture:t})},e.prototype.loadData=function(e,t,r){var i=N.a.GetDDSInfo(e),n=(i.isRGB||i.isLuminance||i.mipmapCount>1)&&t.generateMipMaps&&i.width>>i.mipmapCount-1==1;r(i.width,i.height,n,i.isFourCC,function(){N.a.UploadDDSLevels(t.getEngine(),t,e,i,n,1)})},e}();u.Engine._TextureLoaders.push(new B);var U=r(112),w=function(){function e(){this.supportCascades=!1}return e.prototype.canLoad=function(e,t,r,i,n){return 0===e.indexOf(".env")},e.prototype.transformUrl=function(e,t){return e},e.prototype.getFallbackTextureUrl=function(e,t){return null},e.prototype.loadCubeData=function(e,t,r,i,n){if(!Array.isArray(e)){e=e;var o=U.a.GetEnvInfo(e);o?(t.width=o.width,t.height=o.width,U.a.UploadEnvSpherical(t,o),U.a.UploadEnvLevelsAsync(t,e,o).then(function(){t.isReady=!0,i&&i()})):n&&n("Can not parse the environment file",null)}},e.prototype.loadData=function(e,t,r){throw".env not supported in 2d."},e}();u.Engine._TextureLoaders.push(new w);var G=r(149),k=function(){function e(){this.supportCascades=!1}return e.prototype.canLoad=function(e,t,r,i,n){return!(!t||i||r||n)},e.prototype.transformUrl=function(e,t){var r=e.lastIndexOf(".");return-1!=r&&"ktx"==e.substring(r+1)?e:(r>-1?e.substring(0,r):e)+t},e.prototype.getFallbackTextureUrl=function(e,t){var r=new RegExp(t+"$");return e.replace(r,"")},e.prototype.loadCubeData=function(e,t,r,i,n){if(!Array.isArray(e)){t._invertVScale=!t.invertY;var o=t.getEngine(),s=new G.a(e,6),a=s.numberOfMipmapLevels>1&&t.generateMipMaps;o._unpackFlipY(!0),s.uploadLevels(t,t.generateMipMaps),t.width=s.pixelWidth,t.height=s.pixelHeight,o._setCubeMapTextureParams(a),t.isReady=!0}},e.prototype.loadData=function(e,t,r){t._invertVScale=!t.invertY;var i=new G.a(e,1);r(i.pixelWidth,i.pixelHeight,!1,!0,function(){i.uploadLevels(t,t.generateMipMaps)},i.isInvalid)},e}();u.Engine._TextureLoaders.unshift(new k);var j=r(119),H=function(){function e(){this.supportCascades=!1}return e.prototype.canLoad=function(e,t,r,i,n){return 0===e.indexOf(".tga")},e.prototype.transformUrl=function(e,t){return e},e.prototype.getFallbackTextureUrl=function(e,t){return null},e.prototype.loadCubeData=function(e,t,r,i,n){throw".env not supported in Cube."},e.prototype.loadData=function(e,t,r){var i=new Uint8Array(e),n=j.a.GetTGAHeader(i);r(n.width,n.height,t.generateMipMaps,!1,function(){j.a.UploadContent(t,i)})},e}();u.Engine._TextureLoaders.push(new H);var V=r(192),z=r(203),X=r(5),Y=r(9),W=r(6),K=r(91),Q=function(e){function t(t,r,i,n,o,s){var a=e.call(this,t,i,null,n,o,s)||this;return a._animate=!0,a._time=0,a._texturePath=r,a._loadJson(r),a.refreshRate=1,a}return A.d(t,e),t.prototype._loadJson=function(e){var t=this,r=function(){Y.a.Log("No config file found in "+e+" trying to use ShadersStore or DOM element");try{t.setFragment(t._texturePath)}catch(e){Y.a.Error("No json or ShaderStore or DOM element found for CustomProceduralTexture")}},i=e+"/config.json",n=new XMLHttpRequest;n.open("GET",i,!0),n.addEventListener("load",function(){if(200===n.status||n.responseText&&n.responseText.length>0)try{t._config=JSON.parse(n.response),t.updateShaderUniforms(),t.updateTextures(),t.setFragment(t._texturePath+"/custom"),t._animate=t._config.animate,t.refreshRate=t._config.refreshrate}catch(e){r()}else r()},!1),n.addEventListener("error",function(){r()},!1);try{X.h.UseCustomRequestHeaders&&X.h.InjectCustomRequestHeaders(n),n.send()}catch(e){Y.a.Error("CustomProceduralTexture: Error on XHR send request.")}},t.prototype.isReady=function(){if(!e.prototype.isReady.call(this))return!1;for(var t in this._textures){if(!this._textures[t].isReady())return!1}return!0},t.prototype.render=function(t){var r=this.getScene();this._animate&&r&&(this._time+=.03*r.getAnimationRatio(),this.updateShaderUniforms()),e.prototype.render.call(this,t)},t.prototype.updateTextures=function(){for(var e=0;e<this._config.sampler2Ds.length;e++)this.setTexture(this._config.sampler2Ds[e].sample2Dname,new W.a(this._texturePath+"/"+this._config.sampler2Ds[e].textureRelativeUrl,this.getScene()))},t.prototype.updateShaderUniforms=function(){if(this._config)for(var e=0;e<this._config.uniforms.length;e++){var t=this._config.uniforms[e];switch(t.type){case"float":this.setFloat(t.name,t.value);break;case"color3":this.setColor3(t.name,new a.Color3(t.r,t.g,t.b));break;case"color4":this.setColor4(t.name,new a.Color4(t.r,t.g,t.b,t.a));break;case"vector2":this.setVector2(t.name,new a.Vector2(t.x,t.y));break;case"vector3":this.setVector3(t.name,new a.Vector3(t.x,t.y,t.z))}}this.setFloat("time",this._time)},Object.defineProperty(t.prototype,"animate",{get:function(){return this._animate},set:function(e){this._animate=e},enumerable:!0,configurable:!0}),t}(K.a),Z=r(21),J=(r(288),function(e){function t(t,r,i,n,o){void 0===r&&(r=256),void 0===i&&(i=Z.a.LastCreatedScene);var s=e.call(this,t,r,"noise",i,n,o)||this;return s._time=0,s.brightness=.2,s.octaves=3,s.persistence=.8,s.animationSpeedFactor=1,s.autoClear=!1,s._updateShaderUniforms(),s}return A.d(t,e),t.prototype._updateShaderUniforms=function(){var e=this.getScene();e&&(this._time+=e.getAnimationRatio()*this.animationSpeedFactor*.01,this.setFloat("brightness",this.brightness),this.setFloat("persistence",this.persistence),this.setFloat("timeScale",this._time))},t.prototype._getDefines=function(){return"#define OCTAVES "+(0|this.octaves)},t.prototype.render=function(t){this._updateShaderUniforms(),e.prototype.render.call(this,t)},t.prototype.serialize=function(){var e={customType:"BABYLON.NoiseProceduralTexture"};return e.brightness=this.brightness,e.octaves=this.octaves,e.persistence=this.persistence,e.animationSpeedFactor=this.animationSpeedFactor,e.size=this.getSize().width,e.generateMipMaps=this._generateMipMaps,e},t.Parse=function(e,r){var i=new t(e.name,e.size,r,void 0,e.generateMipMaps);return i.brightness=e.brightness,i.octaves=e.octaves,i.persistence=e.persistence,i.animationSpeedFactor=e.animationSpeedFactor,i},t}(K.a));v.a.RegisteredTypes["BABYLON.NoiseProceduralTexture"]=J;var q=r(204),$=r(205),ee=r(72),te=function(e){function t(t,r,i,n,o,s,a,u,l,h){void 0===a&&(a=!0),void 0===u&&(u=!1),void 0===l&&(l=W.a.TRILINEAR_SAMPLINGMODE),void 0===h&&(h=c.a.TEXTURETYPE_UNSIGNED_INT);var f=e.call(this,null,s,!a,u)||this;return f.format=o,f._engine=s.getEngine(),f._texture=s.getEngine().createRawTexture3D(t,r,i,n,o,a,u,l,void 0,h),f.is3D=!0,f}return A.d(t,e),t.prototype.update=function(e){this._texture&&this._engine.updateRawTexture3D(this._texture,e,this._texture.format,this._texture.invertY,void 0,this._texture.type)},t}(W.a),re=r(39),ie=function(e){function t(t,r,i,n){var o=e.call(this,t,r,i,n,!0)||this;return o.refractionPlane=new a.Plane(0,1,0,1),o.depth=2,o.onBeforeRenderObservable.add(function(){i.clipPlane=o.refractionPlane}),o.onAfterRenderObservable.add(function(){delete i.clipPlane}),o}return A.d(t,e),t.prototype.clone=function(){var e=this.getScene();if(!e)return this;var r=this.getSize(),i=new t(this.name,r.width,e,this._generateMipMaps);return i.hasAlpha=this.hasAlpha,i.level=this.level,i.refractionPlane=this.refractionPlane.clone(),this.renderList&&(i.renderList=this.renderList.slice(0)),i.depth=this.depth,i},t.prototype.serialize=function(){if(!this.name)return null;var t=e.prototype.serialize.call(this);return t.mirrorPlane=this.refractionPlane.asArray(),t.depth=this.depth,t},t}(re.a),ne=r(193),oe=r(99),se=r(20);r.d(t,"a",function(){return i.a}),r.d(t,"c",function(){return n.a}),r.d(t,"k",function(){return o.c}),r.d(t,"j",function(){return o.b}),r.d(t,"i",function(){return o.a}),r.d(t,"l",function(){return h}),r.d(t,"o",function(){return f.b}),r.d(t,"n",function(){return f.a}),r.d(t,"q",function(){return p.a}),r.d(t,"r",function(){return d.a}),r.d(t,"t",function(){return _.a}),r.d(t,"v",function(){return g.a}),r.d(t,"y",function(){return m.a}),r.d(t,"z",function(){return T.a}),r.d(t,"A",function(){return E.a}),r.d(t,"B",function(){return b.a}),r.d(t,"C",function(){return y}),r.d(t,"F",function(){return x.a}),r.d(t,"L",function(){return O.a}),r.d(t,"N",function(){return R.StandardMaterialDefines}),r.d(t,"M",function(){return R.StandardMaterial}),r.d(t,"b",function(){return M.a}),r.d(t,"p",function(){return I.a}),r.d(t,"g",function(){return D.a}),r.d(t,"O",function(){return W.a}),r.d(t,"d",function(){return C}),r.d(t,"e",function(){return S.a}),r.d(t,"h",function(){return P.a}),r.d(t,"m",function(){return L.a}),r.d(t,"u",function(){return V.a}),r.d(t,"w",function(){return z.a}),r.d(t,"G",function(){return $.a}),r.d(t,"H",function(){return ee.a}),r.d(t,"I",function(){return te}),r.d(t,"J",function(){return ie}),r.d(t,"K",function(){return re.a}),r.d(t,"Q",function(){return ne.a}),r.d(t,"R",function(){return B}),r.d(t,"S",function(){return w}),r.d(t,"T",function(){return k}),r.d(t,"U",function(){return H}),r.d(t,"f",function(){return Q}),r.d(t,"x",function(){return J}),r.d(t,"D",function(){return K.a}),r.d(t,"E",function(){return q.a}),r.d(t,"P",function(){return oe.a}),r.d(t,"s",function(){return se.a})},259:function(e,t,r){"use strict";var i=r(11),n=function(){function e(e,t,r){void 0===t&&(t=""),void 0===r&&(r="black");var i=this;this._renderingCanvas=e,this._loadingText=t,this._loadingDivBackgroundColor=r,this._resizeLoadingUI=function(){var e=i._renderingCanvas.getBoundingClientRect(),t=window.getComputedStyle(i._renderingCanvas).position;i._loadingDiv&&(i._loadingDiv.style.position="fixed"===t?"fixed":"absolute",i._loadingDiv.style.left=e.left+"px",i._loadingDiv.style.top=e.top+"px",i._loadingDiv.style.width=e.width+"px",i._loadingDiv.style.height=e.height+"px")}}return e.prototype.displayLoadingUI=function(){if(!this._loadingDiv){this._loadingDiv=document.createElement("div"),this._loadingDiv.id="babylonjsLoadingDiv",this._loadingDiv.style.opacity="0",this._loadingDiv.style.transition="opacity 1.5s ease",this._loadingDiv.style.pointerEvents="none",this._loadingTextDiv=document.createElement("div"),this._loadingTextDiv.style.position="absolute",this._loadingTextDiv.style.left="0",this._loadingTextDiv.style.top="50%",this._loadingTextDiv.style.marginTop="80px",this._loadingTextDiv.style.width="100%",this._loadingTextDiv.style.height="20px",this._loadingTextDiv.style.fontFamily="Arial",this._loadingTextDiv.style.fontSize="14px",this._loadingTextDiv.style.color="white",this._loadingTextDiv.style.textAlign="center",this._loadingTextDiv.innerHTML="Loading",this._loadingDiv.appendChild(this._loadingTextDiv),this._loadingTextDiv.innerHTML=this._loadingText;var e=document.createElement("style");e.type="text/css";e.innerHTML="@-webkit-keyframes spin1 {                    0% { -webkit-transform: rotate(0deg);}\n                    100% { -webkit-transform: rotate(360deg);}\n                }                @keyframes spin1 {                    0% { transform: rotate(0deg);}\n                    100% { transform: rotate(360deg);}\n                }",document.getElementsByTagName("head")[0].appendChild(e);var t=new Image;t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAYAAAA5ZDbSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAYq0lEQVR4Xu2dCZRcVZnHScAJUZSwjSOIbAJmEAZwQCCMoAInYRGIg8AwegQx7AFzUBBmzAFlE4EAwxz2GRk2w7AnAURZBiEOZgyEQDAQAjmEJqTpNd3V1V3Vmd+/6utKV7/1vnpVXd2p/zn3vOV+27vfu/fd/W3QQAPrBZqbm7fJZrN79vf3T+/r67uf4wO9vb37WXQDIwWtra0Tenp6voQTv5XP56/BkfcR3iLk1g6B7hEeI+zP5V+ZiAbqBZ2dnZ8lV+6Gg87CobfhpOc4byf0FjwYE9DneBkWcXrM2tmzNzTxDdQKJPyETCazI46YgiMuI9zJuXJltuChFIHsP/PSfIfTjU19A2mira1tcxy3ey6XO5vEnkV4kes11XBmENDVj97XOT2O03FmWgMuoNLzGRJva8IUnPkzjjcT/kLoKCZzfQB7XiX8M2G8md7AUJgzJ+Z6e88gZ1xGuj3HsY17PcVkrG9gp7CUF/F8PUvxqdZDrFq1ahNVfKjwTCYxZuDE2wjKlc2WViMePM+HPNsFPOdf22OPblD5OZQHvphnV65cjTMzxaQY3eA5V9OO/hmnm1lSjE7woFsQbiXki4++foHnXkW4mLC1JUl947333tsMY3emqfB9jtPJlXN5U0+bOXPmWCPxgOccSy4+AfqPio+9/oFnbyatbqVE28GSZfjQ1NT0KQzaHMcdyPfyaNoE12HcvdxT29K3Fkv8A2vWrPmcifAFZNtD91yRY+SBZ+9UsMtEgD+jTpeenp6JXI6xpKkuUDqRcA6Kr0Wpens+InQTnIpV6Fdi+BQT64ulS5eOIzefD62na7CeoGcnLCM8ykt5OWlzcPv772/BS/w3nP+K+xU11+DvQe5dcrQlTfWAwbNMb8XA8AyGX80xtLlA6TAJuteMbVhhia1v5VMcr+LWMeoZ4xiYw7q6urbhHbgG+paCkIRQehHu4pO3O5fVydEomF5Ulx548JfVD2wqfKE2I3R3ob/f2GoC1DWhdz7HG3i5j2pvb9+Z24m6HvVZQtYsZFWcowlzePEP4jJdR/OQhxTVpAs9NMXxmZxuZKo8IG4s+v8R2tUFphSBTBWzH+OAFwn/gS3TuN55xYoVqfc6dXd3fwHZ1xFaTX0iyGbwjJqXXAammxP00EXx6UMGEx7ram7+vKnzBZ/87Xiwp40tEdDTgYwlHG/CmadSjO7L+XiialOZAej7POFG2VK0Khngl6Pn8/LL0YEtlFh4n8oDAqvaAYH8tzH2iNDm1IIFn8Ax50G7xtgCAU07CfAG4RHOz+vLZL7e0dGxlYlKHaj8BHo25xgrsfV5wrYH4KmouxV+ZZDnCUdwmXxMGgFvFUVWD+jQuOot6rI0tb4gcfaG9v+MrcAn+wj38gL8C7cObmlp2ZRjOkWYD6ypuAf6zjFHLSJ0c/6YQ813DM/yZXgehreiVgP8cvSfsOeExYsXuzs6n8v9j8mqBRZQmdjXVPuira1NHSpn8UDf4Xu0vd2uCtDzacJOlDDf5ng94X8JTWarB8R1EK7ju7udiYgEz/v3pLFKm4oHUHhh3iZdfshpaEYpA4pvKLLXBujLYKRq71XLhUHg27z12rW9B6L/QhLrWWxRH7nzeDK8awi/5HRTEx0K6MZQ694LHk0DqrgfADkreIYz1q5c+UlTEQzesIuMryrggYQWjNL3RGO7p2tuFMeqjaOidgzyCz1yJMTJ6L6d66WEVCcHIO/dQkI75Chs2g97Hoc3jRz9Lge1ED5l4r0gckqRPB0gTw34t1B+h3IqxZkmrn2SULUa7ezZszdE5xfR9130Xsm5ilrnHrmkQOcKvrkncxqrIiY6wlewbw7BOUfDo/b84zzvj9C7J7eCS0NrUiRKCPjUE7ScMBdlF/B2HqBi0ERXBcuXL99YnQz9fX2ah3Up4UnsWGEmDRuUhoTn+Z5PfvbZZ2N/fuCZRJgnfhNVBu73EZoIKt7l0L2UBsYeDZg016nb5EUCWuXQewinUtTuyq2aTStF14a8SD+VDQVj6hDYxjuXf4Hjl83sSMCmTp8j4FtoMuRQ5dAZcii3kk/0s2bBhxIcBxjxUlib1hWInEDO/6qKV+y4geO5HAMntEE/pq+nZyo0ywsG1SmwL4Orf+0yqGCfmvR73LAn9lAeBjQTEhkA+1h49a08iRflcq4H5iuXFU9cz4lqihC/LXS/NZa6Bc+pz5gql5ub6VXD2tZWTSPeyS7XgeLhXrMnEhj6MSHSwaIhFGZH8oA/JzzFeexvJbRN2HW03moT6cEChx6w4QY2rurn85JWrxsiCy0FwjcIqos8w7GZNPulkawDEbFHlaBtjzODEDrVztuKXMmADPWA3RaljyJeNdKq98ilAez8iJdyGqfO31V4NoV/EvyaCqR54V2EshE5Lqcb+TrkstkTLD4WKB4PNNZQ8P05HAelMXNSPWChC8JsYvwthJo0jSoF6fIqjjqe08Aat+LIkd+AVjn09zxbZFqK3tjXAUbXUaWDjTUSyN4J45YZX2Igo4cEOVfFson2ALIxSjR0jog5YNgpfNHM90BxIjDyWIB8Z2NfB01HISJ20wPaw4w1FlavXq1v8aPGXhFw9JNRFTDItifU/RwwpfmKxYsDK180kU4x0lhAXvOSJUs+bezlIDL2N4xi4GpjK4MGCuzUA+SPxzn3m4iKgKyV2DCV08DeMWg0B+zHHOt2DpjS3Mz1BfFOM25C5ZH4LxldJBB0g7GVARkaXgv8VsKqZtIMPpN9RUnJgRzU5Wfp22vifcG3+2vQvmdsdQXsX2pm+oKX+GYjjQXkPWqsXshpRhcJ0RpbGShSHiSuheP37ZYHsGusVHOrU1lMxkO9od4eE+8LlSzQqfetpnPAooBN/2Um+gISp89MkF8K4G3RrMJYoOhbYGxlQEGhSOGogfoLwipExGtUZVVBYIVAluaAaUpuWA+YujlPF22Ra/iBLYEOsV6tV4w0FiitfmLsXiBMU0NiAVrfsp77Zd8MHPgbDoHtva6uLs1jiv1piAKy5tCG+4KJ9wVO/p6RDzvy+b5rzSwP9Okh/WKPERiCWzfk4K8bUSTiOljAyCdx5DZG4gE8W5Dov+NYUfsV/j50fUC4dmXIQDh0qQ6PVgJsOcLM8oA410Ggvo6Ojr81di+g2TKuQOiyJOKWxlpCJpM5zUjKAL3awTsamQfEbYhjtDGKa5tPsyn/wAuiURftlBO56h6aunEwCMxxvV1d+2Fr7Jce2vAu5LUtLeoGi/19gtbToCaR97BoD6BvUs+WkXqgbw6OuhC6wH5l4rRGaCFOvYnjYbyxnpcsCvDVhYOxo6+zszNwSNHVTtJEmSiwzlMAQmNPwIPW42Dds2hfEK/5WJo0Fth+5VNxFHSlkoTzFRh/N3wnq0OGWxXtdoO8enFwaI4jsyidYgNZTxhrMEjEJ4w+En65ESWRXZ7Q4K/COqDAPlhka87WedB8KawmngTIHREOJs5pMiRp+p/GGgxL1FiA9hxjK6G1tVVdhJGAV15+cPXq1f7dahVC20Wg4miCp0uTe3Xh4Hwu93rY1B7SR/t7xQbP5R1FGgpy8IlKe+MJhZ9Aa7u5jPm+pGLX2BMDOZ+hDXgQiXIJ5xoXHZg96anEEFcvOTi0SMUXS4w0FijSTzTWYEA3hkTSEtDI2qw6RoytDLA6jctCvzKqJ8oPFOO7kAhnYe9cZGiWiZ/N9ezguWaSL4h3TUfvKJIfoN0I4sjigYSdZyxlcDVMgEczEY41ER6oZFBOh2Yqegf2zYoziFC3DuZZrjSTPLDtMlxaNPmPP/54W2OPxksrVozP5fLPGr8vEOpbxJCr3jQSJyDvGRNRhv7iHh8vE5LMpKznHBz4zSTOaXwe+mXGGh9tbWvVQf+iyfCAON/ZlTj4v43ECfB94Le4CuMrWVpTtw7O9fZOM5M8oD7xVSOLBdLuNWN1g7bgJUF8+4qpBjf7Te9M6hD4tBDc0289Wh2MHbuaSR7gsHOMLBaQ9W/G6o5MJrNDPu9dcYdQ33Yc95I6OFV5hnp2cGCliDingX5KU+9MShd0dmqta/k8J4zwnV2JsuuNxAnI83VwNpO52kiSoC4djA255cuXBzYPycGzjTQWkPdNY00OfRcQVLafRnd39ySLLsG1i20AyPZ3cDb7AyNJgnp1cOhUHUhcFiL045v9jTUa8Gjlm29fsQQhb3DzJLUEhC+oiK7EISPOwapoEh+7JQJti5YfGXs0YNC62ouC1h9lsrlToClsjc/RM7uSe0kd3EmlzTO/Kqk8Q106mM/Yw2aOB9jnOg6sWTHxJ9FraSJMy6nGz7RbZUDYmN7e3BnQ5Gisez7u3J9c0JwA6Pb0aCFvNObgwKk6NoU59uJwaJ8y1viAT4vCtEFXYO8SFQGtCZpllyXQtNqL+4lmZ/BN/5qJKQFZozEHe9JtAGSaw4wsFnie4JmUQcjleh8yZq0Fnmq3y0D02IzPMgnonYqYIfA4pC+TcXrgIahLB+PEb5s5HrjaR0b7kbHGB0pK7TDO1/T39x1lUZGAPlUH0xTbz+KSoC4dDDx2DQCHzTCaWOB5zjbW+KCSpW0IS0BIJmy6zWCk7WDuxZ4r5oO6dHB7e/sBZo4H2OfUsYOv9jHW+ECJdkAtA/c6MpmMd+XaEKj7km9M4F5TEfBzSKovDLKG1cHobw+b6EDa3WOksYBPAhevBUJMxl8GJTRhFyMLBKSJFn5ls9nvmogS0DfaHOzb3h8AcUuNNBLQNiWa0gRv4MwMMyBwCqxAfCIH82JdYSJKQN+ocjA5NHD2I/e1aj/23iPyhbG6A+bAgXsZoUEII/UAkkQORu71JqIE7o22HBw4VaelpWU74mPPDc/39d1trO5Qb4vJ8QXxbwat06WofcTInMCzeToAtN4VXUn/l1AXDkan9tDSfmL6C81BZooHxDkN9CMveLFZFFAWWZtDwVta3G0sJcAbe3bmYEiniShBXabcL+wflQDD5mD0yKlvk0b/Tk33AG5F7idG+/ibRe54oEl1nLG6A+ZYe1jyAIuG/u2LB3MazxwAfL5vJFGJinxQUwcju6c/n3+FNPm5JhJyy2k/sQTp5nm+2HBJCGi1X1WpwzuBoQXAN+IcjDz8mdePKi/WhH1uxd7GcCjIVBcWpUYDfZ0VbclEJSr2akMBhVrdX6j+Jx3DpSh7vKB8CIiqKwcrcXGqdr05k3RKbU9ryTQVkUB3aHMrEshw7kGCXiv8xxG0h6Uzent6Fpn6MhA17A6GT/3yTxNO1coJbgWur3JFf1fXNuTes5AZe18xXobFHJKv04JZc3O7CtIcgGL9KW03u3QCfL4D4b292dhrpoYgsYOhEz4kaOuHqXKqiagYiN9QnUlyKgX84JUYsQFP9GKzMFRSe8XJb9upE9Dn62CK/KQT75wdTLz+NXgPNdrDuYzeUd0ByN4Wp07n+EdCRZuTY1/ymZQDwIjQye9pA32xdw6IiUgHc639mN8kzCLRjkxzQRzitUpkZ8LZBP1CILUd55EVvdgsCrzJl5i8mgCja+Zgjst4Pq3DUnMmtSWqyNIuQruRU3+CbO08n+pvBAZAjf1IU5kcGJc0YRMBfVV3MPd2RN4+YbvYukI/3sSpe+LUmbw0ryG/6ts1oSLeYrMw6C0xeaFAGc+Wq3hbfeRk582b55lrzf3UHJwWkD0Wp+6BQ3+BfXEXw6UCdHX4TVB0BoJi9Y1Cp59XbUWN8HW7lRjLli3zbINE+1hNiCRI1cGakIhT99ani/A6z1z1nDoUqNQfbO40kyqDfrCBwMg3E5rsCy+8sFlHR8dEnFzRTq/I8hQ9NFFOtGhXVOxgFeUqfknUK7Ctpjl1ANKJ/vmUkvrdwRZmWjpA4J9MTyja2toKY8TQa/ufxP/Whdd5c5cQJHIwfBsTvkKiaqd6/fRyOHKqavdL0H+V2sxmWvrQCAeKItfmQlNyDG/8SVwnetMHyxmA7lm0K2I7GFrlVBW/V6FPP9GqeU4V0Kt2+O2yhctUN6AJBEWD9ngMnessJxh5AfCoQe+8q+xQOYLuWbQrQh2MXP1XYh8S9DKC2sI1z6kCatW3/RCZ6Vj9fNPMqx2wQVNJQlcNEl/mGG5pv48bi7HxMVSOoHsW7QqPg5GlvnJtk6/B9+HMqYUfaXE6rampqWy4dVhgi8FfLprnBXEex+i/wCSkNiSNDSpUxxt7Ccj2nQQYAwUHc9yE3HEotuifDklnfFYMdGNC/lWCxotDf4PvB/jHZTs71c+f2n+ryqCPPcb5/pKdGrTvbH2MUjH4ByOLBDpON9YSFi5cuI1FOwFbbyTox5T6y+iwFL8CqvWvwVtolWgSv/N4sXbl5ZP3r8hRLT50d56KgYJDCYXVhYOhtqqReKDdZuGJtSQSOk8f67x581SspvH3lpoBe9Vefbg/lzveaXmnAf6tEDMNGRp3LnV3ch29o10lQIf+bOKZc+XnmMGARF2EK4vUwQiSw33n7ZlqDWwcaK9Ob29vd26vwj+OT8m3kKFxdd9tlILSJ1Wo8Y8RZT/YiKOY4le5P3SGZJAc7telg7FroL16Jc/n/a1cBBCxsSblwT8LOfofcCh4AQ4x1uoCXZtgVKnYDXLMUECnPSQD29VBcrhfVw7GHrVXb6WylGg0SvUZcrr+YPYuwWVfaE9ltmpA2Q6EQq2UY+yigzf2oqCH4v4MIysD94fdwdig9uqDnB4T5/d+gwHPGNVFcOopyJiPLOfmGTwa0Ek8qS8RKDKORLFWH95utwbDd94SRqqN/Cv4PDXbTFfXfUZWBvRUPJCRBJiIqfnnccy0Dz74wHkWoypY2D4ZGU8gK+kKjQKQ8RcTW1uQI2fmc7nH7LIMFEW+sw6xdyN4CgvNByNIDjp+ZyRVhzlV7dVLaZc7t1cRoW0w9of/No6ptbuRdZupqC3QPZY33HchMkbJiRPssgyaHkN82XaJXPtOJuN+JRuixQI6Cu1VXiZtJehcFGpeNPyXI6cqPWTIvsxU1R7o912akevre4OHfTHot3fEfRbD3y8+Qu0djO5Ce5UXNGl7dTt4z0RGqnOuhgLZgmcPk2FHrrd3jgwkAVQ58e1ioxjcHeMLPWQcq+5gZKm9+hJHjXo5z4xQBQsxxyDjEfir+nNq5GfQo/nYh6f9e4NUgGEFx3DEzvw1nPrOhSJ+kh6GUBUHw6//Kmls96dJ2qv6FxNF9z8g405kVLVXDfkaiFAd4JIkttYUGFpyDOf91Ch/YVEe8DA/gORpuywDfLNMjBOQt4qEupbTPTX4YeJig+/qrnoxkfMeIdH2UHGBfP0H6kFepElc1rY5lBQYXZbzuO7BWYH7b3V3d/+TX1FEG/JSExEJdOi7qsnrx3DuNM8Zdg2NqnN/BjK0EXlVhxORr56wP6Lv/DT+X1FzYLynaOWe2s1TjCQW4An9t6Jk4hBVdH6YpB9YNXoS+SRk/JaQZHd5J2CnesLuyGaze3KZ2hTemoNcpO+uB3pAQuzvC7SeJSfc0258Wo97aX9PT+TmMEMB73jsO0wJzXnVx4llL7pe5kWaFtSqGHHgu6rpPr5jsdx+hyI59G+hA4C25GDO1V69mbf/77h0+lZpzZX44B+Ye1X1cWKz92pKrYlcjtzc6gfN+ufhApd/ErcwTvuTRNI0m4c4Tg77u6gfbCHdTuQcrRFaRKiFU7Xl1O/RqX9RObevRxR43gmEBYUn9wEJIMeF/jk0yVKTta2tE0jg43kx1OatWifEYKDrHYKGDnfkMrU1xHUPaoh7k8i+030EvoV3c6i4aTCoc/9+9NVkFgh6BmZFaig08he3oxYkwBEkQGCzg7gfG6kzaDvuSyLfgIyqt1cF6SAspoS4iJf3c9xaf3JrGEgUzZcOGgvO4agzjTQUkI9V5z4851MuLhBvUUp1gR7tjXEHL+shXFZnduNIBomi6T73FVLLByQePu4N3CxMbVxyzfeQUTYZrdpA3yvoPVf/1jdTGggC6aXx0ieLSecFcWoj72vkhU4IcswU7gVORksb6FHnufbouJ4Xbv+gf1g0EADav9uSeO9YenpA3IfURFVZ0gqEms1rRg0qCzM4TuYy1T061jt0dXXpX0xJ96FMDXIqQXtJ3tSfze6OaY0KU1ogfTUgUJMK0lBIL06dS/F/LJeRe0k2kAAk7BgSWN2GVW/aCOjRuPCbBHVGBG6J3ECKIN3VlfjroguqA+RrMsFvCNqisf5mRox2qPlB4s8vuiMdIE/fVjVvLlRnhKlqYLig7QIpOiva40PAqR2E22neJFrN10AVgWMOIDgPuMOjmRFa+HVaR0fHliaugXoEOe80nBWrZg2dZkZoYffuaW5u1kCVkadmbT70AGdqJodWOhxHqP2eFg1UDvsLatnSFq41M+KKnp6eXbhsdB2OdGiCeX8+/2ecqgnmk/VXNYtqYLSAnNposzpjgw3+H/belpVa8J7TAAAAAElFTkSuQmCC",t.style.position="absolute",t.style.left="50%",t.style.top="50%",t.style.marginLeft="-60px",t.style.marginTop="-60px",t.style.animation="spin1 2s infinite ease-in-out",t.style.webkitAnimation="spin1 2s infinite ease-in-out",t.style.transformOrigin="50% 50%",t.style.webkitTransformOrigin="50% 50%",this._loadingDiv.appendChild(t),this._resizeLoadingUI(),window.addEventListener("resize",this._resizeLoadingUI),this._loadingDiv.style.backgroundColor=this._loadingDivBackgroundColor,document.body.appendChild(this._loadingDiv),this._loadingDiv.style.opacity="1"}},e.prototype.hideLoadingUI=function(){var e=this;if(this._loadingDiv){this._loadingDiv.style.opacity="0",this._loadingDiv.addEventListener("transitionend",function(){e._loadingDiv&&(e._loadingDiv.parentElement&&e._loadingDiv.parentElement.removeChild(e._loadingDiv),window.removeEventListener("resize",e._resizeLoadingUI),e._loadingDiv=null)})}},Object.defineProperty(e.prototype,"loadingUIText",{get:function(){return this._loadingText},set:function(e){this._loadingText=e,this._loadingTextDiv&&(this._loadingTextDiv.innerHTML=this._loadingText)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loadingUIBackgroundColor",{get:function(){return this._loadingDivBackgroundColor},set:function(e){this._loadingDivBackgroundColor=e,this._loadingDiv&&(this._loadingDiv.style.backgroundColor=this._loadingDivBackgroundColor)},enumerable:!0,configurable:!0}),e}();i.Engine.DefaultLoadingScreenFactory=function(e){return new n(e)};var o=r(9),s=r(22),a=r(0),u=r(10),l=r(32),c=r(49),h=r(14),f=r(84),p=r(83),d=r(135),_=r(16),g=r(126),m=r(44),T=r(15),E=r(29),b=r(38),A=r(87),v=r(86),y=r(92),x=r(118),O=r(199),R=r(200),M=r(201),C=function(e,t,r,i){for(var n=0,o=t.materials.length;n<o;n++){var s=t.materials[n];if(s.id===e)return h.a.Parse(s,r,i)}return null},S=function(e,t,r){for(var i in t)if(e.name===t[i])return r.push(e.id),!0;return!(!e.parentId||-1===r.indexOf(e.parentId))&&(r.push(e.id),!0)},P=function(e,t){return e+" of "+(t?t.file+" from "+t.name+" version: "+t.version+", exporter version: "+t.exporter_version:"unknown")},L=function(e,t,r,i,n){void 0===n&&(n=!1);var a=new A.a(e),p="importScene has failed JSON parse";try{var d=JSON.parse(t);p="";var T,O,R=E.a.loggingLevel===E.a.DETAILED_LOGGING;if(void 0!==d.lights&&null!==d.lights)for(T=0,O=d.lights.length;T<O;T++){var C=d.lights[T],S=m.a.Parse(C,e);S&&(a.lights.push(S),p+=0===T?"\n\tLights:":"",p+="\n\t\t"+S.toString(R))}if(void 0!==d.reflectionProbes&&null!==d.reflectionProbes)for(T=0,O=d.reflectionProbes.length;T<O;T++){var L=d.reflectionProbes[T],I=M.a.Parse(L,e,r);I&&(a.reflectionProbes.push(I),p+=0===T?"\n\tReflection Probes:":"",p+="\n\t\t"+I.toString(R))}if(void 0!==d.animations&&null!==d.animations)for(T=0,O=d.animations.length;T<O;T++){var D=d.animations[T],F=_.a.Parse(D);e.animations.push(F),a.animations.push(F),p+=0===T?"\n\tAnimations:":"",p+="\n\t\t"+F.toString(R)}if(void 0!==d.materials&&null!==d.materials)for(T=0,O=d.materials.length;T<O;T++){var N=d.materials[T],B=h.a.Parse(N,e,r);a.materials.push(B),p+=0===T?"\n\tMaterials:":"",p+="\n\t\t"+B.toString(R)}if(void 0!==d.multiMaterials&&null!==d.multiMaterials)for(T=0,O=d.multiMaterials.length;T<O;T++){var U=d.multiMaterials[T],w=f.a.ParseMultiMaterial(U,e);a.multiMaterials.push(w),p+=0===T?"\n\tMultiMaterials:":"",p+="\n\t\t"+w.toString(R)}if(void 0!==d.morphTargetManagers&&null!==d.morphTargetManagers)for(var G=0,k=d.morphTargetManagers;G<k.length;G++){var j=k[G];a.morphTargetManagers.push(x.a.Parse(j,e))}if(void 0!==d.skeletons&&null!==d.skeletons)for(T=0,O=d.skeletons.length;T<O;T++){var H=d.skeletons[T],V=y.a.Parse(H,e);a.skeletons.push(V),p+=0===T?"\n\tSkeletons:":"",p+="\n\t\t"+V.toString(R)}var z=d.geometries;if(null!=z){var X=new Array,Y=z.boxes;if(null!=Y)for(T=0,O=Y.length;T<O;T++){var W=Y[T];X.push(l.a.Parse(W,e))}var K=z.spheres;if(null!=K)for(T=0,O=K.length;T<O;T++){var Q=K[T];X.push(l.h.Parse(Q,e))}var Z=z.cylinders;if(null!=Z)for(T=0,O=Z.length;T<O;T++){var J=Z[T];X.push(l.b.Parse(J,e))}var q=z.toruses;if(null!=q)for(T=0,O=q.length;T<O;T++){var $=q[T];X.push(l.j.Parse($,e))}var ee=z.grounds;if(null!=ee)for(T=0,O=ee.length;T<O;T++){var te=ee[T];X.push(l.e.Parse(te,e))}var re=z.planes;if(null!=re)for(T=0,O=re.length;T<O;T++){var ie=re[T];X.push(l.f.Parse(ie,e))}var ne=z.torusKnots;if(null!=ne)for(T=0,O=ne.length;T<O;T++){var oe=ne[T];X.push(l.k.Parse(oe,e))}var se=z.vertexData;if(null!=se)for(T=0,O=se.length;T<O;T++){var ae=se[T];X.push(l.d.Parse(ae,e,r))}X.forEach(function(e){e&&a.geometries.push(e)})}if(void 0!==d.transformNodes&&null!==d.transformNodes)for(T=0,O=d.transformNodes.length;T<O;T++){var ue=d.transformNodes[T],le=c.a.Parse(ue,e,r);a.transformNodes.push(le)}if(void 0!==d.meshes&&null!==d.meshes)for(T=0,O=d.meshes.length;T<O;T++){var ce=d.meshes[T],he=u.a.Parse(ce,e,r);a.meshes.push(he),p+=0===T?"\n\tMeshes:":"",p+="\n\t\t"+he.toString(R)}if(void 0!==d.cameras&&null!==d.cameras)for(T=0,O=d.cameras.length;T<O;T++){var fe=d.cameras[T],pe=s.a.Parse(fe,e);a.cameras.push(pe),p+=0===T?"\n\tCameras:":"",p+="\n\t\t"+pe.toString(R)}if(void 0!==d.animationGroups&&null!==d.animationGroups)for(T=0,O=d.animationGroups.length;T<O;T++){var de=d.animationGroups[T],_e=g.a.Parse(de,e);a.animationGroups.push(_e),p+=0===T?"\n\tAnimationGroups:":"",p+="\n\t\t"+_e.toString(R)}for(T=0,O=e.cameras.length;T<O;T++){(pe=e.cameras[T])._waitingParentId&&(pe.parent=e.getLastEntryByID(pe._waitingParentId),pe._waitingParentId=null)}for(T=0,O=e.lights.length;T<O;T++){var ge=e.lights[T];ge&&ge._waitingParentId&&(ge.parent=e.getLastEntryByID(ge._waitingParentId),ge._waitingParentId=null)}for(T=0,O=e.transformNodes.length;T<O;T++){var me=e.transformNodes[T];me._waitingParentId&&(me.parent=e.getLastEntryByID(me._waitingParentId),me._waitingParentId=null)}for(T=0,O=e.meshes.length;T<O;T++){(he=e.meshes[T])._waitingParentId&&(he.parent=e.getLastEntryByID(he._waitingParentId),he._waitingParentId=null)}for(T=0,O=e.meshes.length;T<O;T++){var Te=e.meshes[T];Te._waitingFreezeWorldMatrix?(Te.freezeWorldMatrix(),Te._waitingFreezeWorldMatrix=null):Te.computeWorldMatrix(!0)}for(T=0,O=e.lights.length;T<O;T++){var Ee=e.lights[T];if(Ee._excludedMeshesIds.length>0){for(var be=0;be<Ee._excludedMeshesIds.length;be++){var Ae=e.getMeshByID(Ee._excludedMeshesIds[be]);Ae&&Ee.excludedMeshes.push(Ae)}Ee._excludedMeshesIds=[]}if(Ee._includedOnlyMeshesIds.length>0){for(var ve=0;ve<Ee._includedOnlyMeshesIds.length;ve++){var ye=e.getMeshByID(Ee._includedOnlyMeshesIds[ve]);ye&&Ee.includedOnlyMeshes.push(ye)}Ee._includedOnlyMeshesIds=[]}}for(b.a.Parse(d,e,a,r),T=0,O=e.meshes.length;T<O;T++){(he=e.meshes[T])._waitingActions&&(v.a.Parse(he._waitingActions,he,e),he._waitingActions=null)}void 0!==d.actions&&null!==d.actions&&v.a.Parse(d.actions,null,e),n||a.removeAllFromScene()}catch(e){var xe=P("loadAssets",d?d.producer:"Unknown")+p;if(!i)throw o.a.Log(xe),e;i(xe,e)}finally{null!==p&&E.a.loggingLevel!==E.a.NO_LOGGING&&o.a.Log(P("loadAssets",d?d.producer:"Unknown")+(E.a.loggingLevel!==E.a.MINIMAL_LOGGING?p:""))}return a};E.a.RegisterPlugin({name:"babylon.js",extensions:".babylon",canDirectLoad:function(e){return-1!==e.indexOf("babylon")},importMesh:function(e,t,r,i,n,s,a,c){var h="importMesh has failed JSON parse";try{var p=JSON.parse(r);h="";var d=E.a.loggingLevel===E.a.DETAILED_LOGGING;e?Array.isArray(e)||(e=[e]):e=null;var _=new Array;if(void 0!==p.meshes&&null!==p.meshes){var g,m,A,v=[],O=[];for(g=0,m=p.meshes.length;g<m;g++){var R=p.meshes[g];if(null===e||S(R,e,_)){if(null!==e&&delete e[e.indexOf(R.name)],void 0!==R.geometryId&&null!==R.geometryId&&void 0!==p.geometries&&null!==p.geometries){var M=!1;["boxes","spheres","cylinders","toruses","grounds","planes","torusKnots","vertexData"].forEach(function(e){!0!==M&&p.geometries[e]&&Array.isArray(p.geometries[e])&&p.geometries[e].forEach(function(r){if(r.id===R.geometryId){switch(e){case"boxes":l.a.Parse(r,t);break;case"spheres":l.h.Parse(r,t);break;case"cylinders":l.b.Parse(r,t);break;case"toruses":l.j.Parse(r,t);break;case"grounds":l.e.Parse(r,t);break;case"planes":l.f.Parse(r,t);break;case"torusKnots":l.k.Parse(r,t);break;case"vertexData":l.d.Parse(r,t,i)}M=!0}})}),!1===M&&o.a.Warn("Geometry not found for mesh "+R.id)}if(R.materialId){var L=-1!==O.indexOf(R.materialId);if(!1===L&&void 0!==p.multiMaterials&&null!==p.multiMaterials)for(var I=0,D=p.multiMaterials.length;I<D;I++){var F=p.multiMaterials[I];if(F.id===R.materialId){for(var N=0,B=F.materials.length;N<B;N++){var U,w=F.materials[N];O.push(w),(U=C(w,p,t,i))&&(h+="\n\tMaterial "+U.toString(d))}O.push(F.id);var G=f.a.ParseMultiMaterial(F,t);G&&(L=!0,h+="\n\tMulti-Material "+G.toString(d));break}}if(!1===L)O.push(R.materialId),(U=C(R.materialId,p,t,i))?h+="\n\tMaterial "+U.toString(d):o.a.Warn("Material not found for mesh "+R.id)}if(R.skeletonId>-1&&void 0!==p.skeletons&&null!==p.skeletons)if(!1===v.indexOf(R.skeletonId)>-1)for(var k=0,j=p.skeletons.length;k<j;k++){var H=p.skeletons[k];if(H.id===R.skeletonId){var V=y.a.Parse(H,t);a.push(V),v.push(H.id),h+="\n\tSkeleton "+V.toString(d)}}if(void 0!==p.morphTargetManagers&&null!==p.morphTargetManagers)for(var z=0,X=p.morphTargetManagers;z<X.length;z++){var Y=X[z];x.a.Parse(Y,t)}var W=u.a.Parse(R,t,i);n.push(W),h+="\n\tMesh "+W.toString(d)}}for(g=0,m=t.meshes.length;g<m;g++)(A=t.meshes[g])._waitingParentId&&(A.parent=t.getLastEntryByID(A._waitingParentId),A._waitingParentId=null);for(g=0,m=t.meshes.length;g<m;g++)(A=t.meshes[g])._waitingFreezeWorldMatrix?(A.freezeWorldMatrix(),A._waitingFreezeWorldMatrix=null):A.computeWorldMatrix(!0)}if(void 0!==p.particleSystems&&null!==p.particleSystems){var K=b.a.GetIndividualParser(T.a.NAME_PARTICLESYSTEM);if(K)for(g=0,m=p.particleSystems.length;g<m;g++){var Q=p.particleSystems[g];-1!==_.indexOf(Q.emitterId)&&s.push(K(Q,t,i))}}return!0}catch(e){var Z=P("importMesh",p?p.producer:"Unknown")+h;if(!c)throw o.a.Log(Z),e;c(Z,e)}finally{null!==h&&E.a.loggingLevel!==E.a.NO_LOGGING&&o.a.Log(P("importMesh",p?p.producer:"Unknown")+(E.a.loggingLevel!==E.a.MINIMAL_LOGGING?h:""))}return!1},load:function(e,t,r,i){var n="importScene has failed JSON parse";try{var s=JSON.parse(t);if(n="",void 0!==s.useDelayedTextureLoading&&null!==s.useDelayedTextureLoading&&(e.useDelayedTextureLoading=s.useDelayedTextureLoading&&!E.a.ForceFullSceneLoadingForIncremental),void 0!==s.autoClear&&null!==s.autoClear&&(e.autoClear=s.autoClear),void 0!==s.clearColor&&null!==s.clearColor&&(e.clearColor=a.Color4.FromArray(s.clearColor)),void 0!==s.ambientColor&&null!==s.ambientColor&&(e.ambientColor=a.Color3.FromArray(s.ambientColor)),void 0!==s.gravity&&null!==s.gravity&&(e.gravity=a.Vector3.FromArray(s.gravity)),s.fogMode&&0!==s.fogMode)switch(e.fogMode=s.fogMode,e.fogColor=a.Color3.FromArray(s.fogColor),e.fogStart=s.fogStart,e.fogEnd=s.fogEnd,e.fogDensity=s.fogDensity,n+="\tFog mode for scene:  ",e.fogMode){case 1:n+="exp\n";break;case 2:n+="exp2\n";break;case 3:n+="linear\n"}if(s.physicsEnabled){var u;"cannon"===s.physicsEngine?u=new O.a:"oimo"===s.physicsEngine&&(u=new R.a),n="\tPhysics engine "+(s.physicsEngine?s.physicsEngine:"oimo")+" enabled\n";var l=s.physicsGravity?a.Vector3.FromArray(s.physicsGravity):null;e.enablePhysics(l,u)}if(void 0!==s.metadata&&null!==s.metadata&&(e.metadata=s.metadata),void 0!==s.collisionsEnabled&&null!==s.collisionsEnabled&&(e.collisionsEnabled=s.collisionsEnabled),!L(e,t,r,i,!0))return!1;if(s.autoAnimate&&e.beginAnimation(e,s.autoAnimateFrom,s.autoAnimateTo,s.autoAnimateLoop,s.autoAnimateSpeed||1),void 0!==s.activeCameraID&&null!==s.activeCameraID&&e.setActiveCameraByID(s.activeCameraID),void 0!==s.environmentTexture&&null!==s.environmentTexture){var c=void 0===s.isPBR||s.isPBR;if(s.environmentTextureType&&"BABYLON.HDRCubeTexture"===s.environmentTextureType){var h=s.environmentTextureSize?s.environmentTextureSize:128,f=new d.a(r+s.environmentTexture,e,h,!0,!c);s.environmentTextureRotationY&&(f.rotationY=s.environmentTextureRotationY),e.environmentTexture=f}else{var _=p.a.CreateFromPrefilteredData(r+s.environmentTexture,e);s.environmentTextureRotationY&&(_.rotationY=s.environmentTextureRotationY),e.environmentTexture=_}if(!0===s.createDefaultSkybox){var g=void 0!==e.activeCamera&&null!==e.activeCamera?(e.activeCamera.maxZ-e.activeCamera.minZ)/2:1e3,m=s.skyboxBlurLevel||0;e.createDefaultSkybox(e.environmentTexture,c,g,m)}}return!0}catch(e){var T=P("importScene",s?s.producer:"Unknown")+n;if(!i)throw o.a.Log(T),e;i(T,e)}finally{null!==n&&E.a.loggingLevel!==E.a.NO_LOGGING&&o.a.Log(P("importScene",s?s.producer:"Unknown")+(E.a.loggingLevel!==E.a.MINIMAL_LOGGING?n:""))}return!1},loadAssetContainer:function(e,t,r,i){return L(e,t,r,i)}});var I=r(66);r.d(t,"a",function(){return n}),r.d(t,"e",function(){return!0}),r.d(t,"d",function(){return E.b}),r.d(t,"b",function(){return E.a}),r.d(t,"c",function(){return I.a})},29:function(e,t,r){"use strict";r.d(t,"b",function(){return f}),r.d(t,"a",function(){return p});var i=r(5),n=r(7),o=r(79),s=r(19),a=r(11),u=r(21),l=r(9),c=r(4),h=r(66),f=function(){function e(e,t,r){this.lengthComputable=e,this.loaded=t,this.total=r}return e.FromProgressEvent=function(t){return new e(t.lengthComputable,t.loaded,t.total)},e}(),p=function(){function e(){}return Object.defineProperty(e,"ForceFullSceneLoadingForIncremental",{get:function(){return h.a.ForceFullSceneLoadingForIncremental},set:function(e){h.a.ForceFullSceneLoadingForIncremental=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ShowLoadingScreen",{get:function(){return h.a.ShowLoadingScreen},set:function(e){h.a.ShowLoadingScreen=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loggingLevel",{get:function(){return h.a.loggingLevel},set:function(e){h.a.loggingLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CleanBoneMatrixWeights",{get:function(){return h.a.CleanBoneMatrixWeights},set:function(e){h.a.CleanBoneMatrixWeights=e},enumerable:!0,configurable:!0}),e._getDefaultPlugin=function(){return e._registeredPlugins[".babylon"]},e._getPluginForExtension=function(t){var r=e._registeredPlugins[t];return r||(l.a.Warn("Unable to find a plugin to load "+t+" files. Trying to use .babylon default plugin. To load from a specific filetype (eg. gltf) see: http://doc.babylonjs.com/how_to/load_from_any_file_type"),e._getDefaultPlugin())},e._getPluginForDirectLoad=function(t){for(var r in e._registeredPlugins){var i=e._registeredPlugins[r].plugin;if(i.canDirectLoad&&i.canDirectLoad(t))return e._registeredPlugins[r]}return e._getDefaultPlugin()},e._getPluginForFilename=function(t){var r=t.indexOf("?");-1!==r&&(t=t.substring(0,r));var i=t.lastIndexOf("."),n=t.substring(i,t.length).toLowerCase();return e._getPluginForExtension(n)},e._getDirectLoad=function(e){return"data:"===e.substr(0,5)?e.substr(5):null},e._loadData=function(t,r,n,s,u,l,c){var h,p=e._getDirectLoad(t.name),d=c?e._getPluginForExtension(c):p?e._getPluginForDirectLoad(t.name):e._getPluginForFilename(t.name);h=d.plugin.createPlugin?d.plugin.createPlugin():d.plugin;var _,g=d.isBinary;e.OnPluginActivatedObservable.notifyObservers(h);var m=function(e,t){r.isDisposed?u("Scene has been disposed"):(r.offlineProvider=_,n(h,e,t))},T=null,E=!1,b=h.onDisposeObservable;b&&b.add(function(){E=!0,T&&(T.abort(),T=null),l()});var A=function(){E||(T=i.h.LoadFile(t.url,m,s?function(e){s(f.FromProgressEvent(e))}:void 0,_,g,function(e,t){u("Failed to load scene."+(t?" "+t.message:""),t)}))};if(p)return m(p),h;var v=t.file||o.a.FilesToLoad[t.name.toLowerCase()];if(-1===t.rootUrl.indexOf("file:")||-1!==t.rootUrl.indexOf("file:")&&!v){var y=r.getEngine(),x=y.enableOfflineSupport;if(x){for(var O=!1,R=0,M=r.disableOfflineSupportExceptionRules;R<M.length;R++){if(M[R].test(t.url)){O=!0;break}}x=!O}x&&a.Engine.OfflineProviderFactory?_=a.Engine.OfflineProviderFactory(t.url,A,y.disableManifestCheck):A()}else v?T=i.h.ReadFile(v,m,s,g):u("Unable to find file named "+t.name);return h},e._getFileInfo=function(e,t){var r,n,o=null;if(t)if(t.lastModified){var s=t;r=e+s.name,n=s.name,o=s}else{var a=t;if("/"===a.substr(0,1))return i.h.Error("Wrong sceneFilename parameter"),null;r=e+a,n=a}else r=e,n=i.h.GetFilename(e),e=i.h.GetFolderPath(e);return{url:r,rootUrl:e,name:n,file:o}},e.GetPluginForExtension=function(t){return e._getPluginForExtension(t).plugin},e.IsPluginForExtensionAvailable=function(t){return!!e._registeredPlugins[t]},e.RegisterPlugin=function(t){if("string"==typeof t.extensions){var r=t.extensions;e._registeredPlugins[r.toLowerCase()]={plugin:t,isBinary:!1}}else{var i=t.extensions;Object.keys(i).forEach(function(r){e._registeredPlugins[r.toLowerCase()]={plugin:t,isBinary:i[r].isBinary}})}},e.ImportMesh=function(t,r,i,n,o,s,a,c){if(void 0===i&&(i=""),void 0===n&&(n=u.a.LastCreatedScene),void 0===o&&(o=null),void 0===s&&(s=null),void 0===a&&(a=null),void 0===c&&(c=null),!n)return l.a.Error("No scene available to import mesh to"),null;var h=e._getFileInfo(r,i);if(!h)return null;var f={};n._addPendingData(f);var p=function(){n._removePendingData(f)},d=function(e,t){var r="Unable to import meshes from "+h.url+": "+e;a?a(n,r,t):l.a.Error(r),p()},_=s?function(e){try{s(e)}catch(e){d("Error in onProgress callback",e)}}:void 0,g=function(e,t,r,i){if(n.importedMeshesFiles.push(h.url),o)try{o(e,t,r,i)}catch(e){d("Error in onSuccess callback",e)}n._removePendingData(f)};return e._loadData(h,n,function(e,r,i){if(e.rewriteRootURL&&(h.rootUrl=e.rewriteRootURL(h.rootUrl,i)),e.importMesh){var o=e,s=new Array,a=new Array,u=new Array;if(!o.importMesh(t,n,r,h.rootUrl,s,a,u,d))return;n.loadingPluginName=e.name,g(s,a,u,[])}else{e.importMeshAsync(t,n,r,h.rootUrl,_,h.name).then(function(t){n.loadingPluginName=e.name,g(t.meshes,t.particleSystems,t.skeletons,t.animationGroups)}).catch(function(e){d(e.message,e)})}},_,d,p,c)},e.ImportMeshAsync=function(t,r,i,n,o,s){return void 0===i&&(i=""),void 0===n&&(n=u.a.LastCreatedScene),void 0===o&&(o=null),void 0===s&&(s=null),new Promise(function(a,u){e.ImportMesh(t,r,i,n,function(e,t,r,i){a({meshes:e,particleSystems:t,skeletons:r,animationGroups:i})},o,function(e,t,r){u(r||new Error(t))},s)})},e.Load=function(t,r,n,o,a,l,c){return void 0===r&&(r=""),void 0===n&&(n=u.a.LastCreatedEngine),void 0===o&&(o=null),void 0===a&&(a=null),void 0===l&&(l=null),void 0===c&&(c=null),n?e.Append(t,r,new s.Scene(n),o,a,l,c):(i.h.Error("No engine available"),null)},e.LoadAsync=function(t,r,i,n,o){return void 0===r&&(r=""),void 0===i&&(i=u.a.LastCreatedEngine),void 0===n&&(n=null),void 0===o&&(o=null),new Promise(function(s,a){e.Load(t,r,i,function(e){s(e)},n,function(e,t,r){a(r||new Error(t))},o)})},e.Append=function(t,r,i,n,o,s,a){if(void 0===r&&(r=""),void 0===i&&(i=u.a.LastCreatedScene),void 0===n&&(n=null),void 0===o&&(o=null),void 0===s&&(s=null),void 0===a&&(a=null),!i)return l.a.Error("No scene available to append to"),null;var c=e._getFileInfo(t,r);if(!c)return null;e.ShowLoadingScreen&&i.getEngine().displayLoadingUI();var h={};i._addPendingData(h);var f=function(){i._removePendingData(h),i.getEngine().hideLoadingUI()},p=function(e,t){var r="Unable to load from "+c.url+(e?": "+e:"");s?s(i,r,t):l.a.Error(r),f()},d=o?function(e){try{o(e)}catch(e){p("Error in onProgress callback",e)}}:void 0,_=function(){if(n)try{n(i)}catch(e){p("Error in onSuccess callback",e)}i._removePendingData(h)};return e._loadData(c,i,function(t,r){if(t.load){if(!t.load(i,r,c.rootUrl,p))return;i.loadingPluginName=t.name,_()}else{t.loadAsync(i,r,c.rootUrl,d,c.name).then(function(){i.loadingPluginName=t.name,_()}).catch(function(e){p(e.message,e)})}e.ShowLoadingScreen&&i.executeWhenReady(function(){i.getEngine().hideLoadingUI()})},d,p,f,a)},e.AppendAsync=function(t,r,i,n,o){return void 0===r&&(r=""),void 0===i&&(i=u.a.LastCreatedScene),void 0===n&&(n=null),void 0===o&&(o=null),new Promise(function(s,a){e.Append(t,r,i,function(e){s(e)},n,function(e,t,r){a(r||new Error(t))},o)})},e.LoadAssetContainer=function(t,r,i,n,o,s,a){if(void 0===r&&(r=""),void 0===i&&(i=u.a.LastCreatedScene),void 0===n&&(n=null),void 0===o&&(o=null),void 0===s&&(s=null),void 0===a&&(a=null),!i)return l.a.Error("No scene available to load asset container to"),null;var c=e._getFileInfo(t,r);if(!c)return null;var h={};i._addPendingData(h);var f=function(){i._removePendingData(h)},p=function(e,t){var r="Unable to load assets from "+c.url+(e?": "+e:"");s?s(i,r,t):l.a.Error(r),f()},d=o?function(e){try{o(e)}catch(e){p("Error in onProgress callback",e)}}:void 0,_=function(e){if(n)try{n(e)}catch(e){p("Error in onSuccess callback",e)}i._removePendingData(h)};return e._loadData(c,i,function(t,r){if(t.loadAssetContainer){var n=t.loadAssetContainer(i,r,c.rootUrl,p);if(!n)return;i.loadingPluginName=t.name,_(n)}else if(t.loadAssetContainerAsync){t.loadAssetContainerAsync(i,r,c.rootUrl,d,c.name).then(function(e){i.loadingPluginName=t.name,_(e)}).catch(function(e){p(e.message,e)})}else p("LoadAssetContainer is not supported by this plugin. Plugin did not provide a loadAssetContainer or loadAssetContainerAsync method.");e.ShowLoadingScreen&&i.executeWhenReady(function(){i.getEngine().hideLoadingUI()})},d,p,f,a)},e.LoadAssetContainerAsync=function(t,r,i,n,o){return void 0===r&&(r=""),void 0===i&&(i=u.a.LastCreatedScene),void 0===n&&(n=null),void 0===o&&(o=null),new Promise(function(s,a){e.LoadAssetContainer(t,r,i,function(e){s(e)},n,function(e,t,r){a(r||new Error(t))},o)})},e.NO_LOGGING=c.a.SCENELOADER_NO_LOGGING,e.MINIMAL_LOGGING=c.a.SCENELOADER_MINIMAL_LOGGING,e.SUMMARY_LOGGING=c.a.SCENELOADER_SUMMARY_LOGGING,e.DETAILED_LOGGING=c.a.SCENELOADER_DETAILED_LOGGING,e.OnPluginActivatedObservable=new n.c,e._registeredPlugins={},e}()},30:function(e,t,r){"use strict";r.d(t,"a",function(){return s});var i=r(7),n=r(139),o=r(4),s=function(){function e(t,r,n){void 0===n&&(n=!1),this.onLoadedObservable=new i.c,this.previous=null,this.next=null,this._invertVScale=!1,this._initialSlot=-1,this._designatedSlot=-1,this._dataSource=e.DATASOURCE_UNKNOWN,this._comparisonFunction=0,this._sphericalPolynomial=null,this._lodGenerationScale=0,this._lodGenerationOffset=0,this._isRGBD=!1,this._references=1,this._engine=t,this._dataSource=r,n||(this._webGLTexture=t._createTexture())}return e.prototype.getEngine=function(){return this._engine},Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},enumerable:!0,configurable:!0}),e.prototype.incrementReferences=function(){this._references++},e.prototype.updateSize=function(e,t,r){void 0===r&&(r=1),this.width=e,this.height=t,this.depth=r,this.baseWidth=e,this.baseHeight=t,this.baseDepth=r,this._size=e*t*r},e.prototype._rebuild=function(){var t,r=this;switch(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedAnisotropicFilteringLevel=null,this._dataSource){case e.DATASOURCE_TEMP:return;case e.DATASOURCE_URL:return void(t=this._engine.createTexture(this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,function(){t._swapAndDie(r),r.isReady=!0},null,this._buffer,void 0,this.format));case e.DATASOURCE_RAW:return(t=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case e.DATASOURCE_RAW3D:return(t=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case e.DATASOURCE_DYNAMIC:return(t=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode))._swapAndDie(this),void this._engine.updateDynamicTexture(this,this._engine.getRenderingCanvas(),this.invertY,void 0,void 0,!0);case e.DATASOURCE_RENDERTARGET:var i=new n.a;if(i.generateDepthBuffer=this._generateDepthBuffer,i.generateMipMaps=this.generateMipMaps,i.generateStencilBuffer=this._generateStencilBuffer,i.samplingMode=this.samplingMode,i.type=this.type,this.isCube)t=this._engine.createRenderTargetCubeTexture(this.width,i);else{var s={width:this.width,height:this.height};t=this._engine.createRenderTargetTexture(s,i)}return t._swapAndDie(this),void(this.isReady=!0);case e.DATASOURCE_DEPTHTEXTURE:var a={bilinearFiltering:this.samplingMode!==o.a.TEXTURE_BILINEAR_SAMPLINGMODE,comparisonFunction:this._comparisonFunction,generateStencil:this._generateStencilBuffer,isCube:this.isCube};return(t=this._engine.createDepthStencilTexture({width:this.width,height:this.height},a))._swapAndDie(this),void(this.isReady=!0);case e.DATASOURCE_CUBE:return void(t=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,function(){t._swapAndDie(r),r.isReady=!0},null,this.format,this._extension));case e.DATASOURCE_CUBERAW:return(t=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case e.DATASOURCE_CUBERAW_RGBD:return t=this._engine.createRawCubeTexture(null,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression),void e._UpdateRGBDAsync(t,this._bufferViewArrayArray,this._sphericalPolynomial,this._lodGenerationScale,this._lodGenerationOffset).then(function(){t._swapAndDie(r),r.isReady=!0});case e.DATASOURCE_CUBEPREFILTERED:return void((t=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,function(e){e&&e._swapAndDie(r),r.isReady=!0},null,this.format,this._extension))._sphericalPolynomial=this._sphericalPolynomial)}},e.prototype._swapAndDie=function(e){e._webGLTexture=this._webGLTexture,this._framebuffer&&(e._framebuffer=this._framebuffer),this._depthStencilBuffer&&(e._depthStencilBuffer=this._depthStencilBuffer),this._lodTextureHigh&&(e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(e._lodTextureLow&&e._lodTextureLow.dispose(),e._lodTextureLow=this._lodTextureLow);var t=this._engine.getLoadedTexturesCache(),r=t.indexOf(this);-1!==r&&t.splice(r,1)},e.prototype.dispose=function(){this._webGLTexture&&(this._references--,0===this._references&&(this._engine._releaseTexture(this),this._webGLTexture=null,this.previous=null,this.next=null))},e._UpdateRGBDAsync=function(e,t,r,i,n){throw"environmentTextureTools needs to be imported before rebuilding RGBD textures."},e.DATASOURCE_UNKNOWN=0,e.DATASOURCE_URL=1,e.DATASOURCE_TEMP=2,e.DATASOURCE_RAW=3,e.DATASOURCE_DYNAMIC=4,e.DATASOURCE_RENDERTARGET=5,e.DATASOURCE_MULTIRENDERTARGET=6,e.DATASOURCE_CUBE=7,e.DATASOURCE_CUBERAW=8,e.DATASOURCE_CUBEPREFILTERED=9,e.DATASOURCE_RAW3D=10,e.DATASOURCE_DEPTHTEXTURE=11,e.DATASOURCE_CUBERAW_RGBD=12,e}()},31:function(e,t,r){"use strict";r.r(t),r.d(t,"StandardMaterialDefines",function(){return T}),r.d(t,"StandardMaterial",function(){return E});var i=r(1),n=r(2),o=r(36),s=r(19),a=r(0),u=r(3),l=r(40),c=r(8),h=r(76),f=r(90),p=r(17),d=r(6),_=r(26),g=r(20),m=(r(323),r(322),r(4)),T=function(e){function t(){var t=e.call(this)||this;return t.MAINUV1=!1,t.MAINUV2=!1,t.DIFFUSE=!1,t.DIFFUSEDIRECTUV=0,t.AMBIENT=!1,t.AMBIENTDIRECTUV=0,t.OPACITY=!1,t.OPACITYDIRECTUV=0,t.OPACITYRGB=!1,t.REFLECTION=!1,t.EMISSIVE=!1,t.EMISSIVEDIRECTUV=0,t.SPECULAR=!1,t.SPECULARDIRECTUV=0,t.BUMP=!1,t.BUMPDIRECTUV=0,t.PARALLAX=!1,t.PARALLAXOCCLUSION=!1,t.SPECULAROVERALPHA=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.ALPHATEST=!1,t.DEPTHPREPASS=!1,t.ALPHAFROMDIFFUSE=!1,t.POINTSIZE=!1,t.FOG=!1,t.SPECULARTERM=!1,t.DIFFUSEFRESNEL=!1,t.OPACITYFRESNEL=!1,t.REFLECTIONFRESNEL=!1,t.REFRACTIONFRESNEL=!1,t.EMISSIVEFRESNEL=!1,t.FRESNEL=!1,t.NORMAL=!1,t.UV1=!1,t.UV2=!1,t.VERTEXCOLOR=!1,t.VERTEXALPHA=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.BONETEXTURE=!1,t.INSTANCES=!1,t.GLOSSINESS=!1,t.ROUGHNESS=!1,t.EMISSIVEASILLUMINATION=!1,t.LINKEMISSIVEWITHDIFFUSE=!1,t.REFLECTIONFRESNELFROMSPECULAR=!1,t.LIGHTMAP=!1,t.LIGHTMAPDIRECTUV=0,t.OBJECTSPACE_NORMALMAP=!1,t.USELIGHTMAPASSHADOWMAP=!1,t.REFLECTIONMAP_3D=!1,t.REFLECTIONMAP_SPHERICAL=!1,t.REFLECTIONMAP_PLANAR=!1,t.REFLECTIONMAP_CUBIC=!1,t.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,t.REFLECTIONMAP_PROJECTION=!1,t.REFLECTIONMAP_SKYBOX=!1,t.REFLECTIONMAP_SKYBOX_TRANSFORMED=!1,t.REFLECTIONMAP_EXPLICIT=!1,t.REFLECTIONMAP_EQUIRECTANGULAR=!1,t.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,t.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,t.INVERTCUBICMAP=!1,t.LOGARITHMICDEPTH=!1,t.REFRACTION=!1,t.REFRACTIONMAP_3D=!1,t.REFLECTIONOVERALPHA=!1,t.TWOSIDEDLIGHTING=!1,t.SHADOWFLOAT=!1,t.MORPHTARGETS=!1,t.MORPHTARGETS_NORMAL=!1,t.MORPHTARGETS_TANGENT=!1,t.NUM_MORPH_INFLUENCERS=0,t.NONUNIFORMSCALING=!1,t.PREMULTIPLYALPHA=!1,t.IMAGEPROCESSING=!1,t.VIGNETTE=!1,t.VIGNETTEBLENDMODEMULTIPLY=!1,t.VIGNETTEBLENDMODEOPAQUE=!1,t.TONEMAPPING=!1,t.TONEMAPPING_ACES=!1,t.CONTRAST=!1,t.COLORCURVES=!1,t.COLORGRADING=!1,t.COLORGRADING3D=!1,t.SAMPLER3DGREENDEPTH=!1,t.SAMPLER3DBGRMAP=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.IS_REFLECTION_LINEAR=!1,t.IS_REFRACTION_LINEAR=!1,t.EXPOSURE=!1,t.rebuild(),t}return i.d(t,e),t.prototype.setReflectionMode=function(e){for(var t=0,r=["REFLECTIONMAP_CUBIC","REFLECTIONMAP_EXPLICIT","REFLECTIONMAP_PLANAR","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_SKYBOX","REFLECTIONMAP_SPHERICAL","REFLECTIONMAP_EQUIRECTANGULAR","REFLECTIONMAP_EQUIRECTANGULAR_FIXED","REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED"];t<r.length;t++){var i=r[t];this[i]=i===e}},t}(h.a),E=function(e){function t(r,i){var n=e.call(this,r,i)||this;return n.ambientColor=new a.Color3(0,0,0),n.diffuseColor=new a.Color3(1,1,1),n.specularColor=new a.Color3(1,1,1),n.emissiveColor=new a.Color3(0,0,0),n.specularPower=64,n._useAlphaFromDiffuseTexture=!1,n._useEmissiveAsIllumination=!1,n._linkEmissiveWithDiffuse=!1,n._useSpecularOverAlpha=!1,n._useReflectionOverAlpha=!1,n._disableLighting=!1,n._useObjectSpaceNormalMap=!1,n._useParallax=!1,n._useParallaxOcclusion=!1,n.parallaxScaleBias=.05,n._roughness=0,n.indexOfRefraction=.98,n.invertRefractionY=!0,n.alphaCutOff=.4,n._useLightmapAsShadowmap=!1,n._useReflectionFresnelFromSpecular=!1,n._useGlossinessFromSpecularMapAlpha=!1,n._maxSimultaneousLights=4,n._invertNormalMapX=!1,n._invertNormalMapY=!1,n._twoSidedLighting=!1,n._renderTargets=new o.a(16),n._worldViewProjectionMatrix=a.Matrix.Zero(),n._globalAmbientColor=new a.Color3(0,0,0),n._attachImageProcessingConfiguration(null),n.getRenderTargetTextures=function(){return n._renderTargets.reset(),t.ReflectionTextureEnabled&&n._reflectionTexture&&n._reflectionTexture.isRenderTarget&&n._renderTargets.push(n._reflectionTexture),t.RefractionTextureEnabled&&n._refractionTexture&&n._refractionTexture.isRenderTarget&&n._renderTargets.push(n._refractionTexture),n._renderTargets},n}return i.d(t,e),Object.defineProperty(t.prototype,"imageProcessingConfiguration",{get:function(){return this._imageProcessingConfiguration},set:function(e){this._attachImageProcessingConfiguration(e),this._markAllSubMeshesAsTexturesDirty()},enumerable:!0,configurable:!0}),t.prototype._attachImageProcessingConfiguration=function(e){var t=this;e!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),this._imageProcessingConfiguration=e||this.getScene().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add(function(){t._markAllSubMeshesAsImageProcessingDirty()})))},Object.defineProperty(t.prototype,"cameraColorCurvesEnabled",{get:function(){return this.imageProcessingConfiguration.colorCurvesEnabled},set:function(e){this.imageProcessingConfiguration.colorCurvesEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraColorGradingEnabled",{get:function(){return this.imageProcessingConfiguration.colorGradingEnabled},set:function(e){this.imageProcessingConfiguration.colorGradingEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraToneMappingEnabled",{get:function(){return this._imageProcessingConfiguration.toneMappingEnabled},set:function(e){this._imageProcessingConfiguration.toneMappingEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraExposure",{get:function(){return this._imageProcessingConfiguration.exposure},set:function(e){this._imageProcessingConfiguration.exposure=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraContrast",{get:function(){return this._imageProcessingConfiguration.contrast},set:function(e){this._imageProcessingConfiguration.contrast=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraColorGradingTexture",{get:function(){return this._imageProcessingConfiguration.colorGradingTexture},set:function(e){this._imageProcessingConfiguration.colorGradingTexture=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraColorCurves",{get:function(){return this._imageProcessingConfiguration.colorCurves},set:function(e){this._imageProcessingConfiguration.colorCurves=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasRenderTargetTextures",{get:function(){return!!(t.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget)||!!(t.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget)},enumerable:!0,configurable:!0}),t.prototype.getClassName=function(){return"StandardMaterial"},Object.defineProperty(t.prototype,"useLogarithmicDepth",{get:function(){return this._useLogarithmicDepth},set:function(e){this._useLogarithmicDepth=e&&this.getScene().getEngine().getCaps().fragmentDepthSupported,this._markAllSubMeshesAsMiscDirty()},enumerable:!0,configurable:!0}),t.prototype.needAlphaBlending=function(){return this.alpha<1||null!=this._opacityTexture||this._shouldUseAlphaFromDiffuseTexture()||this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled},t.prototype.needAlphaTesting=function(){return null!=this._diffuseTexture&&this._diffuseTexture.hasAlpha},t.prototype._shouldUseAlphaFromDiffuseTexture=function(){return null!=this._diffuseTexture&&this._diffuseTexture.hasAlpha&&this._useAlphaFromDiffuseTexture},t.prototype.getAlphaTestTexture=function(){return this._diffuseTexture},t.prototype.isReadyForSubMesh=function(e,r,i){if(void 0===i&&(i=!1),r.effect&&this.isFrozen&&this._wasPreviouslyReady)return!0;r._materialDefines||(r._materialDefines=new T);var n=this.getScene(),o=r._materialDefines;if(!this.checkReadyOnEveryCall&&r.effect&&o._renderId===n.getRenderId())return!0;var s=n.getEngine();if(o._needNormals=p.a.PrepareDefinesForLights(n,e,o,!0,this._maxSimultaneousLights,this._disableLighting),o._areTexturesDirty){if(o._needUVs=!1,o.MAINUV1=!1,o.MAINUV2=!1,n.texturesEnabled){if(this._diffuseTexture&&t.DiffuseTextureEnabled){if(!this._diffuseTexture.isReadyOrNotBlocking())return!1;p.a.PrepareDefinesForMergedUV(this._diffuseTexture,o,"DIFFUSE")}else o.DIFFUSE=!1;if(this._ambientTexture&&t.AmbientTextureEnabled){if(!this._ambientTexture.isReadyOrNotBlocking())return!1;p.a.PrepareDefinesForMergedUV(this._ambientTexture,o,"AMBIENT")}else o.AMBIENT=!1;if(this._opacityTexture&&t.OpacityTextureEnabled){if(!this._opacityTexture.isReadyOrNotBlocking())return!1;p.a.PrepareDefinesForMergedUV(this._opacityTexture,o,"OPACITY"),o.OPACITYRGB=this._opacityTexture.getAlphaFromRGB}else o.OPACITY=!1;if(this._reflectionTexture&&t.ReflectionTextureEnabled){if(!this._reflectionTexture.isReadyOrNotBlocking())return!1;switch(o._needNormals=!0,o.REFLECTION=!0,o.ROUGHNESS=this._roughness>0,o.REFLECTIONOVERALPHA=this._useReflectionOverAlpha,o.INVERTCUBICMAP=this._reflectionTexture.coordinatesMode===d.a.INVCUBIC_MODE,o.REFLECTIONMAP_3D=this._reflectionTexture.isCube,this._reflectionTexture.coordinatesMode){case d.a.EXPLICIT_MODE:o.setReflectionMode("REFLECTIONMAP_EXPLICIT");break;case d.a.PLANAR_MODE:o.setReflectionMode("REFLECTIONMAP_PLANAR");break;case d.a.PROJECTION_MODE:o.setReflectionMode("REFLECTIONMAP_PROJECTION");break;case d.a.SKYBOX_MODE:o.setReflectionMode("REFLECTIONMAP_SKYBOX"),o.REFLECTIONMAP_SKYBOX_TRANSFORMED=!this._reflectionTexture.getReflectionTextureMatrix().isIdentity();break;case d.a.SPHERICAL_MODE:o.setReflectionMode("REFLECTIONMAP_SPHERICAL");break;case d.a.EQUIRECTANGULAR_MODE:o.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR");break;case d.a.FIXED_EQUIRECTANGULAR_MODE:o.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR_FIXED");break;case d.a.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:o.setReflectionMode("REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED");break;case d.a.CUBIC_MODE:case d.a.INVCUBIC_MODE:default:o.setReflectionMode("REFLECTIONMAP_CUBIC")}o.USE_LOCAL_REFLECTIONMAP_CUBIC=!!this._reflectionTexture.boundingBoxSize}else o.REFLECTION=!1;if(this._emissiveTexture&&t.EmissiveTextureEnabled){if(!this._emissiveTexture.isReadyOrNotBlocking())return!1;p.a.PrepareDefinesForMergedUV(this._emissiveTexture,o,"EMISSIVE")}else o.EMISSIVE=!1;if(this._lightmapTexture&&t.LightmapTextureEnabled){if(!this._lightmapTexture.isReadyOrNotBlocking())return!1;p.a.PrepareDefinesForMergedUV(this._lightmapTexture,o,"LIGHTMAP"),o.USELIGHTMAPASSHADOWMAP=this._useLightmapAsShadowmap}else o.LIGHTMAP=!1;if(this._specularTexture&&t.SpecularTextureEnabled){if(!this._specularTexture.isReadyOrNotBlocking())return!1;p.a.PrepareDefinesForMergedUV(this._specularTexture,o,"SPECULAR"),o.GLOSSINESS=this._useGlossinessFromSpecularMapAlpha}else o.SPECULAR=!1;if(n.getEngine().getCaps().standardDerivatives&&this._bumpTexture&&t.BumpTextureEnabled){if(!this._bumpTexture.isReady())return!1;p.a.PrepareDefinesForMergedUV(this._bumpTexture,o,"BUMP"),o.PARALLAX=this._useParallax,o.PARALLAXOCCLUSION=this._useParallaxOcclusion,o.OBJECTSPACE_NORMALMAP=this._useObjectSpaceNormalMap}else o.BUMP=!1;if(this._refractionTexture&&t.RefractionTextureEnabled){if(!this._refractionTexture.isReadyOrNotBlocking())return!1;o._needUVs=!0,o.REFRACTION=!0,o.REFRACTIONMAP_3D=this._refractionTexture.isCube}else o.REFRACTION=!1;o.TWOSIDEDLIGHTING=!this._backFaceCulling&&this._twoSidedLighting}else o.DIFFUSE=!1,o.AMBIENT=!1,o.OPACITY=!1,o.REFLECTION=!1,o.EMISSIVE=!1,o.LIGHTMAP=!1,o.BUMP=!1,o.REFRACTION=!1;o.ALPHAFROMDIFFUSE=this._shouldUseAlphaFromDiffuseTexture(),o.EMISSIVEASILLUMINATION=this._useEmissiveAsIllumination,o.LINKEMISSIVEWITHDIFFUSE=this._linkEmissiveWithDiffuse,o.SPECULAROVERALPHA=this._useSpecularOverAlpha,o.PREMULTIPLYALPHA=this.alphaMode===m.a.ALPHA_PREMULTIPLIED||this.alphaMode===m.a.ALPHA_PREMULTIPLIED_PORTERDUFF}if(o._areImageProcessingDirty&&this._imageProcessingConfiguration){if(!this._imageProcessingConfiguration.isReady())return!1;this._imageProcessingConfiguration.prepareDefines(o),o.IS_REFLECTION_LINEAR=null!=this.reflectionTexture&&!this.reflectionTexture.gammaSpace,o.IS_REFRACTION_LINEAR=null!=this.refractionTexture&&!this.refractionTexture.gammaSpace}if(o._areFresnelDirty&&(t.FresnelEnabled?(this._diffuseFresnelParameters||this._opacityFresnelParameters||this._emissiveFresnelParameters||this._refractionFresnelParameters||this._reflectionFresnelParameters)&&(o.DIFFUSEFRESNEL=this._diffuseFresnelParameters&&this._diffuseFresnelParameters.isEnabled,o.OPACITYFRESNEL=this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled,o.REFLECTIONFRESNEL=this._reflectionFresnelParameters&&this._reflectionFresnelParameters.isEnabled,o.REFLECTIONFRESNELFROMSPECULAR=this._useReflectionFresnelFromSpecular,o.REFRACTIONFRESNEL=this._refractionFresnelParameters&&this._refractionFresnelParameters.isEnabled,o.EMISSIVEFRESNEL=this._emissiveFresnelParameters&&this._emissiveFresnelParameters.isEnabled,o._needNormals=!0,o.FRESNEL=!0):o.FRESNEL=!1),p.a.PrepareDefinesForMisc(e,n,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e),o),p.a.PrepareDefinesForAttributes(e,o,!0,!0,!0),p.a.PrepareDefinesForFrameBoundValues(n,s,o,i),o.isDirty){o.markAsProcessed();var a=new c.c;o.REFLECTION&&a.addFallback(0,"REFLECTION"),o.SPECULAR&&a.addFallback(0,"SPECULAR"),o.BUMP&&a.addFallback(0,"BUMP"),o.PARALLAX&&a.addFallback(1,"PARALLAX"),o.PARALLAXOCCLUSION&&a.addFallback(0,"PARALLAXOCCLUSION"),o.SPECULAROVERALPHA&&a.addFallback(0,"SPECULAROVERALPHA"),o.FOG&&a.addFallback(1,"FOG"),o.POINTSIZE&&a.addFallback(0,"POINTSIZE"),o.LOGARITHMICDEPTH&&a.addFallback(0,"LOGARITHMICDEPTH"),p.a.HandleFallbacksForShadows(o,a,this._maxSimultaneousLights),o.SPECULARTERM&&a.addFallback(0,"SPECULARTERM"),o.DIFFUSEFRESNEL&&a.addFallback(1,"DIFFUSEFRESNEL"),o.OPACITYFRESNEL&&a.addFallback(2,"OPACITYFRESNEL"),o.REFLECTIONFRESNEL&&a.addFallback(3,"REFLECTIONFRESNEL"),o.EMISSIVEFRESNEL&&a.addFallback(4,"EMISSIVEFRESNEL"),o.FRESNEL&&a.addFallback(4,"FRESNEL");var h=[u.b.PositionKind];o.NORMAL&&h.push(u.b.NormalKind),o.UV1&&h.push(u.b.UVKind),o.UV2&&h.push(u.b.UV2Kind),o.VERTEXCOLOR&&h.push(u.b.ColorKind),p.a.PrepareAttributesForBones(h,e,o,a),p.a.PrepareAttributesForInstances(h,o),p.a.PrepareAttributesForMorphTargets(h,e,o);var f="default",_=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vDiffuseColor","vSpecularColor","vEmissiveColor","vFogInfos","vFogColor","pointSize","vDiffuseInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vEmissiveInfos","vSpecularInfos","vBumpInfos","vLightmapInfos","vRefractionInfos","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","diffuseMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","specularMatrix","bumpMatrix","normalMatrix","lightmapMatrix","refractionMatrix","diffuseLeftColor","diffuseRightColor","opacityParts","reflectionLeftColor","reflectionRightColor","emissiveLeftColor","emissiveRightColor","refractionLeftColor","refractionRightColor","vReflectionPosition","vReflectionSize","logarithmicDepthConstant","vTangentSpaceParams","alphaCutOff","boneTextureWidth"],g=["diffuseSampler","ambientSampler","opacitySampler","reflectionCubeSampler","reflection2DSampler","emissiveSampler","specularSampler","bumpSampler","lightmapSampler","refractionCubeSampler","refraction2DSampler","boneSampler"],E=["Material","Scene"];l.a&&(l.a.PrepareUniforms(_,o),l.a.PrepareSamplers(g,o)),p.a.PrepareUniformsAndSamplersList({uniformsNames:_,uniformBuffersNames:E,samplers:g,defines:o,maxSimultaneousLights:this._maxSimultaneousLights}),this.customShaderNameResolve&&(f=this.customShaderNameResolve(f,_,E,g,o));var b=o.toString(),A=r.effect,v=n.getEngine().createEffect(f,{attributes:h,uniformsNames:_,uniformBuffersNames:E,samplers:g,defines:b,fallbacks:a,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this._maxSimultaneousLights,maxSimultaneousMorphTargets:o.NUM_MORPH_INFLUENCERS}},s);v&&(this.allowShaderHotSwapping&&A&&!v.isReady()?(v=A,o.markAsUnprocessed()):(n.resetCachedMaterial(),r.setEffect(v,o),this.buildUniformLayout()))}return!(!r.effect||!r.effect.isReady())&&(o._renderId=n.getRenderId(),this._wasPreviouslyReady=!0,!0)},t.prototype.buildUniformLayout=function(){this._uniformBuffer.addUniform("diffuseLeftColor",4),this._uniformBuffer.addUniform("diffuseRightColor",4),this._uniformBuffer.addUniform("opacityParts",4),this._uniformBuffer.addUniform("reflectionLeftColor",4),this._uniformBuffer.addUniform("reflectionRightColor",4),this._uniformBuffer.addUniform("refractionLeftColor",4),this._uniformBuffer.addUniform("refractionRightColor",4),this._uniformBuffer.addUniform("emissiveLeftColor",4),this._uniformBuffer.addUniform("emissiveRightColor",4),this._uniformBuffer.addUniform("vDiffuseInfos",2),this._uniformBuffer.addUniform("vAmbientInfos",2),this._uniformBuffer.addUniform("vOpacityInfos",2),this._uniformBuffer.addUniform("vReflectionInfos",2),this._uniformBuffer.addUniform("vReflectionPosition",3),this._uniformBuffer.addUniform("vReflectionSize",3),this._uniformBuffer.addUniform("vEmissiveInfos",2),this._uniformBuffer.addUniform("vLightmapInfos",2),this._uniformBuffer.addUniform("vSpecularInfos",2),this._uniformBuffer.addUniform("vBumpInfos",3),this._uniformBuffer.addUniform("diffuseMatrix",16),this._uniformBuffer.addUniform("ambientMatrix",16),this._uniformBuffer.addUniform("opacityMatrix",16),this._uniformBuffer.addUniform("reflectionMatrix",16),this._uniformBuffer.addUniform("emissiveMatrix",16),this._uniformBuffer.addUniform("lightmapMatrix",16),this._uniformBuffer.addUniform("specularMatrix",16),this._uniformBuffer.addUniform("bumpMatrix",16),this._uniformBuffer.addUniform("vTangentSpaceParams",2),this._uniformBuffer.addUniform("refractionMatrix",16),this._uniformBuffer.addUniform("vRefractionInfos",4),this._uniformBuffer.addUniform("vSpecularColor",4),this._uniformBuffer.addUniform("vEmissiveColor",3),this._uniformBuffer.addUniform("vDiffuseColor",4),this._uniformBuffer.addUniform("pointSize",1),this._uniformBuffer.create()},t.prototype.unbind=function(){if(this._activeEffect){var t=!1;this._reflectionTexture&&this._reflectionTexture.isRenderTarget&&(this._activeEffect.setTexture("reflection2DSampler",null),t=!0),this._refractionTexture&&this._refractionTexture.isRenderTarget&&(this._activeEffect.setTexture("refraction2DSampler",null),t=!0),t&&this._markAllSubMeshesAsTexturesDirty()}e.prototype.unbind.call(this)},t.prototype.bindForSubMesh=function(e,r,i){var n=this.getScene(),o=i._materialDefines;if(o){var u=i.effect;if(u){this._activeEffect=u,this.bindOnlyWorldMatrix(e),o.OBJECTSPACE_NORMALMAP&&(e.toNormalMatrix(this._normalMatrix),this.bindOnlyNormalMatrix(this._normalMatrix));var l=this._mustRebind(n,u,r.visibility);if(p.a.BindBonesParameters(r,u),l){if(this._uniformBuffer.bindToEffect(u,"Material"),this.bindViewProjection(u),!this._uniformBuffer.useUbo||!this.isFrozen||!this._uniformBuffer.isSync){if(t.FresnelEnabled&&o.FRESNEL&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled&&(this._uniformBuffer.updateColor4("diffuseLeftColor",this.diffuseFresnelParameters.leftColor,this.diffuseFresnelParameters.power),this._uniformBuffer.updateColor4("diffuseRightColor",this.diffuseFresnelParameters.rightColor,this.diffuseFresnelParameters.bias)),this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&this._uniformBuffer.updateColor4("opacityParts",new a.Color3(this.opacityFresnelParameters.leftColor.toLuminance(),this.opacityFresnelParameters.rightColor.toLuminance(),this.opacityFresnelParameters.bias),this.opacityFresnelParameters.power),this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled&&(this._uniformBuffer.updateColor4("reflectionLeftColor",this.reflectionFresnelParameters.leftColor,this.reflectionFresnelParameters.power),this._uniformBuffer.updateColor4("reflectionRightColor",this.reflectionFresnelParameters.rightColor,this.reflectionFresnelParameters.bias)),this.refractionFresnelParameters&&this.refractionFresnelParameters.isEnabled&&(this._uniformBuffer.updateColor4("refractionLeftColor",this.refractionFresnelParameters.leftColor,this.refractionFresnelParameters.power),this._uniformBuffer.updateColor4("refractionRightColor",this.refractionFresnelParameters.rightColor,this.refractionFresnelParameters.bias)),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(this._uniformBuffer.updateColor4("emissiveLeftColor",this.emissiveFresnelParameters.leftColor,this.emissiveFresnelParameters.power),this._uniformBuffer.updateColor4("emissiveRightColor",this.emissiveFresnelParameters.rightColor,this.emissiveFresnelParameters.bias))),n.texturesEnabled){if(this._diffuseTexture&&t.DiffuseTextureEnabled&&(this._uniformBuffer.updateFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),p.a.BindTextureMatrix(this._diffuseTexture,this._uniformBuffer,"diffuse"),this._diffuseTexture.hasAlpha&&u.setFloat("alphaCutOff",this.alphaCutOff)),this._ambientTexture&&t.AmbientTextureEnabled&&(this._uniformBuffer.updateFloat2("vAmbientInfos",this._ambientTexture.coordinatesIndex,this._ambientTexture.level),p.a.BindTextureMatrix(this._ambientTexture,this._uniformBuffer,"ambient")),this._opacityTexture&&t.OpacityTextureEnabled&&(this._uniformBuffer.updateFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,this._opacityTexture.level),p.a.BindTextureMatrix(this._opacityTexture,this._uniformBuffer,"opacity")),this._reflectionTexture&&t.ReflectionTextureEnabled&&(this._uniformBuffer.updateFloat2("vReflectionInfos",this._reflectionTexture.level,this.roughness),this._uniformBuffer.updateMatrix("reflectionMatrix",this._reflectionTexture.getReflectionTextureMatrix()),this._reflectionTexture.boundingBoxSize)){var c=this._reflectionTexture;this._uniformBuffer.updateVector3("vReflectionPosition",c.boundingBoxPosition),this._uniformBuffer.updateVector3("vReflectionSize",c.boundingBoxSize)}if(this._emissiveTexture&&t.EmissiveTextureEnabled&&(this._uniformBuffer.updateFloat2("vEmissiveInfos",this._emissiveTexture.coordinatesIndex,this._emissiveTexture.level),p.a.BindTextureMatrix(this._emissiveTexture,this._uniformBuffer,"emissive")),this._lightmapTexture&&t.LightmapTextureEnabled&&(this._uniformBuffer.updateFloat2("vLightmapInfos",this._lightmapTexture.coordinatesIndex,this._lightmapTexture.level),p.a.BindTextureMatrix(this._lightmapTexture,this._uniformBuffer,"lightmap")),this._specularTexture&&t.SpecularTextureEnabled&&(this._uniformBuffer.updateFloat2("vSpecularInfos",this._specularTexture.coordinatesIndex,this._specularTexture.level),p.a.BindTextureMatrix(this._specularTexture,this._uniformBuffer,"specular")),this._bumpTexture&&n.getEngine().getCaps().standardDerivatives&&t.BumpTextureEnabled&&(this._uniformBuffer.updateFloat3("vBumpInfos",this._bumpTexture.coordinatesIndex,1/this._bumpTexture.level,this.parallaxScaleBias),p.a.BindTextureMatrix(this._bumpTexture,this._uniformBuffer,"bump"),n._mirroredCameraPosition?this._uniformBuffer.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?1:-1,this._invertNormalMapY?1:-1):this._uniformBuffer.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?-1:1,this._invertNormalMapY?-1:1)),this._refractionTexture&&t.RefractionTextureEnabled){var h=1;this._refractionTexture.isCube||(this._uniformBuffer.updateMatrix("refractionMatrix",this._refractionTexture.getReflectionTextureMatrix()),this._refractionTexture.depth&&(h=this._refractionTexture.depth)),this._uniformBuffer.updateFloat4("vRefractionInfos",this._refractionTexture.level,this.indexOfRefraction,h,this.invertRefractionY?-1:1)}}this.pointsCloud&&this._uniformBuffer.updateFloat("pointSize",this.pointSize),o.SPECULARTERM&&this._uniformBuffer.updateColor4("vSpecularColor",this.specularColor,this.specularPower),this._uniformBuffer.updateColor3("vEmissiveColor",t.EmissiveTextureEnabled?this.emissiveColor:a.Color3.BlackReadOnly),this._uniformBuffer.updateColor4("vDiffuseColor",this.diffuseColor,this.alpha*r.visibility)}if(n.texturesEnabled&&(this._diffuseTexture&&t.DiffuseTextureEnabled&&u.setTexture("diffuseSampler",this._diffuseTexture),this._ambientTexture&&t.AmbientTextureEnabled&&u.setTexture("ambientSampler",this._ambientTexture),this._opacityTexture&&t.OpacityTextureEnabled&&u.setTexture("opacitySampler",this._opacityTexture),this._reflectionTexture&&t.ReflectionTextureEnabled&&(this._reflectionTexture.isCube?u.setTexture("reflectionCubeSampler",this._reflectionTexture):u.setTexture("reflection2DSampler",this._reflectionTexture)),this._emissiveTexture&&t.EmissiveTextureEnabled&&u.setTexture("emissiveSampler",this._emissiveTexture),this._lightmapTexture&&t.LightmapTextureEnabled&&u.setTexture("lightmapSampler",this._lightmapTexture),this._specularTexture&&t.SpecularTextureEnabled&&u.setTexture("specularSampler",this._specularTexture),this._bumpTexture&&n.getEngine().getCaps().standardDerivatives&&t.BumpTextureEnabled&&u.setTexture("bumpSampler",this._bumpTexture),this._refractionTexture&&t.RefractionTextureEnabled)){h=1;this._refractionTexture.isCube?u.setTexture("refractionCubeSampler",this._refractionTexture):u.setTexture("refraction2DSampler",this._refractionTexture)}p.a.BindClipPlane(u,n),n.ambientColor.multiplyToRef(this.ambientColor,this._globalAmbientColor),p.a.BindEyePosition(u,n),u.setColor3("vAmbientColor",this._globalAmbientColor)}!l&&this.isFrozen||(n.lightsEnabled&&!this._disableLighting&&p.a.BindLights(n,r,u,o,this._maxSimultaneousLights),(n.fogEnabled&&r.applyFog&&n.fogMode!==s.Scene.FOGMODE_NONE||this._reflectionTexture||this._refractionTexture)&&this.bindView(u),p.a.BindFogParameters(n,r,u),o.NUM_MORPH_INFLUENCERS&&p.a.BindMorphTargetParameters(r,u),p.a.BindLogDepth(o,u,n),this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.applyByPostProcess&&this._imageProcessingConfiguration.bind(this._activeEffect)),this._uniformBuffer.update(),this._afterBind(r,this._activeEffect)}}},t.prototype.getAnimatables=function(){var e=[];return this._diffuseTexture&&this._diffuseTexture.animations&&this._diffuseTexture.animations.length>0&&e.push(this._diffuseTexture),this._ambientTexture&&this._ambientTexture.animations&&this._ambientTexture.animations.length>0&&e.push(this._ambientTexture),this._opacityTexture&&this._opacityTexture.animations&&this._opacityTexture.animations.length>0&&e.push(this._opacityTexture),this._reflectionTexture&&this._reflectionTexture.animations&&this._reflectionTexture.animations.length>0&&e.push(this._reflectionTexture),this._emissiveTexture&&this._emissiveTexture.animations&&this._emissiveTexture.animations.length>0&&e.push(this._emissiveTexture),this._specularTexture&&this._specularTexture.animations&&this._specularTexture.animations.length>0&&e.push(this._specularTexture),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&e.push(this._bumpTexture),this._lightmapTexture&&this._lightmapTexture.animations&&this._lightmapTexture.animations.length>0&&e.push(this._lightmapTexture),this._refractionTexture&&this._refractionTexture.animations&&this._refractionTexture.animations.length>0&&e.push(this._refractionTexture),e},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this._diffuseTexture&&t.push(this._diffuseTexture),this._ambientTexture&&t.push(this._ambientTexture),this._opacityTexture&&t.push(this._opacityTexture),this._reflectionTexture&&t.push(this._reflectionTexture),this._emissiveTexture&&t.push(this._emissiveTexture),this._specularTexture&&t.push(this._specularTexture),this._bumpTexture&&t.push(this._bumpTexture),this._lightmapTexture&&t.push(this._lightmapTexture),this._refractionTexture&&t.push(this._refractionTexture),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||(this._diffuseTexture===t||(this._ambientTexture===t||(this._opacityTexture===t||(this._reflectionTexture===t||(this._emissiveTexture===t||(this._specularTexture===t||(this._bumpTexture===t||(this._lightmapTexture===t||this._refractionTexture===t))))))))},t.prototype.dispose=function(t,r){r&&(this._diffuseTexture&&this._diffuseTexture.dispose(),this._ambientTexture&&this._ambientTexture.dispose(),this._opacityTexture&&this._opacityTexture.dispose(),this._reflectionTexture&&this._reflectionTexture.dispose(),this._emissiveTexture&&this._emissiveTexture.dispose(),this._specularTexture&&this._specularTexture.dispose(),this._bumpTexture&&this._bumpTexture.dispose(),this._lightmapTexture&&this._lightmapTexture.dispose(),this._refractionTexture&&this._refractionTexture.dispose()),this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),e.prototype.dispose.call(this,t,r)},t.prototype.clone=function(e){var r=this,i=n.a.Clone(function(){return new t(e,r.getScene())},this);return i.name=e,i.id=e,i},t.prototype.serialize=function(){return n.a.Serialize(this)},t.Parse=function(e,r,i){return n.a.Parse(function(){return new t(e.name,r)},e,r,i)},Object.defineProperty(t,"DiffuseTextureEnabled",{get:function(){return g.a.DiffuseTextureEnabled},set:function(e){g.a.DiffuseTextureEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AmbientTextureEnabled",{get:function(){return g.a.AmbientTextureEnabled},set:function(e){g.a.AmbientTextureEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OpacityTextureEnabled",{get:function(){return g.a.OpacityTextureEnabled},set:function(e){g.a.OpacityTextureEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ReflectionTextureEnabled",{get:function(){return g.a.ReflectionTextureEnabled},set:function(e){g.a.ReflectionTextureEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EmissiveTextureEnabled",{get:function(){return g.a.EmissiveTextureEnabled},set:function(e){g.a.EmissiveTextureEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SpecularTextureEnabled",{get:function(){return g.a.SpecularTextureEnabled},set:function(e){g.a.SpecularTextureEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BumpTextureEnabled",{get:function(){return g.a.BumpTextureEnabled},set:function(e){g.a.BumpTextureEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightmapTextureEnabled",{get:function(){return g.a.LightmapTextureEnabled},set:function(e){g.a.LightmapTextureEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RefractionTextureEnabled",{get:function(){return g.a.RefractionTextureEnabled},set:function(e){g.a.RefractionTextureEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ColorGradingTextureEnabled",{get:function(){return g.a.ColorGradingTextureEnabled},set:function(e){g.a.ColorGradingTextureEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FresnelEnabled",{get:function(){return g.a.FresnelEnabled},set:function(e){g.a.FresnelEnabled=e},enumerable:!0,configurable:!0}),i.c([Object(n.l)("diffuseTexture")],t.prototype,"_diffuseTexture",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesAndMiscDirty")],t.prototype,"diffuseTexture",void 0),i.c([Object(n.l)("ambientTexture")],t.prototype,"_ambientTexture",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"ambientTexture",void 0),i.c([Object(n.l)("opacityTexture")],t.prototype,"_opacityTexture",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesAndMiscDirty")],t.prototype,"opacityTexture",void 0),i.c([Object(n.l)("reflectionTexture")],t.prototype,"_reflectionTexture",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"reflectionTexture",void 0),i.c([Object(n.l)("emissiveTexture")],t.prototype,"_emissiveTexture",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"emissiveTexture",void 0),i.c([Object(n.l)("specularTexture")],t.prototype,"_specularTexture",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"specularTexture",void 0),i.c([Object(n.l)("bumpTexture")],t.prototype,"_bumpTexture",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"bumpTexture",void 0),i.c([Object(n.l)("lightmapTexture")],t.prototype,"_lightmapTexture",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"lightmapTexture",void 0),i.c([Object(n.l)("refractionTexture")],t.prototype,"_refractionTexture",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"refractionTexture",void 0),i.c([Object(n.e)("ambient")],t.prototype,"ambientColor",void 0),i.c([Object(n.e)("diffuse")],t.prototype,"diffuseColor",void 0),i.c([Object(n.e)("specular")],t.prototype,"specularColor",void 0),i.c([Object(n.e)("emissive")],t.prototype,"emissiveColor",void 0),i.c([Object(n.c)()],t.prototype,"specularPower",void 0),i.c([Object(n.c)("useAlphaFromDiffuseTexture")],t.prototype,"_useAlphaFromDiffuseTexture",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useAlphaFromDiffuseTexture",void 0),i.c([Object(n.c)("useEmissiveAsIllumination")],t.prototype,"_useEmissiveAsIllumination",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useEmissiveAsIllumination",void 0),i.c([Object(n.c)("linkEmissiveWithDiffuse")],t.prototype,"_linkEmissiveWithDiffuse",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"linkEmissiveWithDiffuse",void 0),i.c([Object(n.c)("useSpecularOverAlpha")],t.prototype,"_useSpecularOverAlpha",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useSpecularOverAlpha",void 0),i.c([Object(n.c)("useReflectionOverAlpha")],t.prototype,"_useReflectionOverAlpha",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useReflectionOverAlpha",void 0),i.c([Object(n.c)("disableLighting")],t.prototype,"_disableLighting",void 0),i.c([Object(n.b)("_markAllSubMeshesAsLightsDirty")],t.prototype,"disableLighting",void 0),i.c([Object(n.c)("useObjectSpaceNormalMap")],t.prototype,"_useObjectSpaceNormalMap",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useObjectSpaceNormalMap",void 0),i.c([Object(n.c)("useParallax")],t.prototype,"_useParallax",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useParallax",void 0),i.c([Object(n.c)("useParallaxOcclusion")],t.prototype,"_useParallaxOcclusion",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useParallaxOcclusion",void 0),i.c([Object(n.c)()],t.prototype,"parallaxScaleBias",void 0),i.c([Object(n.c)("roughness")],t.prototype,"_roughness",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"roughness",void 0),i.c([Object(n.c)()],t.prototype,"indexOfRefraction",void 0),i.c([Object(n.c)()],t.prototype,"invertRefractionY",void 0),i.c([Object(n.c)()],t.prototype,"alphaCutOff",void 0),i.c([Object(n.c)("useLightmapAsShadowmap")],t.prototype,"_useLightmapAsShadowmap",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useLightmapAsShadowmap",void 0),i.c([Object(n.h)("diffuseFresnelParameters")],t.prototype,"_diffuseFresnelParameters",void 0),i.c([Object(n.b)("_markAllSubMeshesAsFresnelDirty")],t.prototype,"diffuseFresnelParameters",void 0),i.c([Object(n.h)("opacityFresnelParameters")],t.prototype,"_opacityFresnelParameters",void 0),i.c([Object(n.b)("_markAllSubMeshesAsFresnelAndMiscDirty")],t.prototype,"opacityFresnelParameters",void 0),i.c([Object(n.h)("reflectionFresnelParameters")],t.prototype,"_reflectionFresnelParameters",void 0),i.c([Object(n.b)("_markAllSubMeshesAsFresnelDirty")],t.prototype,"reflectionFresnelParameters",void 0),i.c([Object(n.h)("refractionFresnelParameters")],t.prototype,"_refractionFresnelParameters",void 0),i.c([Object(n.b)("_markAllSubMeshesAsFresnelDirty")],t.prototype,"refractionFresnelParameters",void 0),i.c([Object(n.h)("emissiveFresnelParameters")],t.prototype,"_emissiveFresnelParameters",void 0),i.c([Object(n.b)("_markAllSubMeshesAsFresnelDirty")],t.prototype,"emissiveFresnelParameters",void 0),i.c([Object(n.c)("useReflectionFresnelFromSpecular")],t.prototype,"_useReflectionFresnelFromSpecular",void 0),i.c([Object(n.b)("_markAllSubMeshesAsFresnelDirty")],t.prototype,"useReflectionFresnelFromSpecular",void 0),i.c([Object(n.c)("useGlossinessFromSpecularMapAlpha")],t.prototype,"_useGlossinessFromSpecularMapAlpha",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useGlossinessFromSpecularMapAlpha",void 0),i.c([Object(n.c)("maxSimultaneousLights")],t.prototype,"_maxSimultaneousLights",void 0),i.c([Object(n.b)("_markAllSubMeshesAsLightsDirty")],t.prototype,"maxSimultaneousLights",void 0),i.c([Object(n.c)("invertNormalMapX")],t.prototype,"_invertNormalMapX",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"invertNormalMapX",void 0),i.c([Object(n.c)("invertNormalMapY")],t.prototype,"_invertNormalMapY",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"invertNormalMapY",void 0),i.c([Object(n.c)("twoSidedLighting")],t.prototype,"_twoSidedLighting",void 0),i.c([Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"twoSidedLighting",void 0),i.c([Object(n.c)()],t.prototype,"useLogarithmicDepth",null),t}(f.a);_.a.RegisteredTypes["BABYLON.StandardMaterial"]=E,s.Scene.DefaultMaterialFactory=function(e){return new E("default material",e)}},39:function(e,t,r){"use strict";r.d(t,"a",function(){return h});var i=r(1),n=r(7),o=r(5),s=r(0),a=r(6),u=r(115),l=r(128),c=r(4),h=function(e){function t(t,r,i,o,u,h,f,p,d,_,g,m,T){void 0===u&&(u=!0),void 0===h&&(h=c.a.TEXTURETYPE_UNSIGNED_INT),void 0===f&&(f=!1),void 0===p&&(p=a.a.TRILINEAR_SAMPLINGMODE),void 0===d&&(d=!0),void 0===_&&(_=!1),void 0===g&&(g=!1),void 0===m&&(m=c.a.TEXTUREFORMAT_RGBA),void 0===T&&(T=!1);var E=e.call(this,null,i,!o)||this;return E.isCube=f,E.renderParticles=!0,E.renderSprites=!1,E.coordinatesMode=a.a.PROJECTION_MODE,E.ignoreCameraViewport=!1,E.onBeforeBindObservable=new n.c,E.onAfterUnbindObservable=new n.c,E.onBeforeRenderObservable=new n.c,E.onAfterRenderObservable=new n.c,E.onClearObservable=new n.c,E._currentRefreshId=-1,E._refreshRate=1,E._samples=1,E.boundingBoxPosition=s.Vector3.Zero(),(i=E.getScene())?(E.renderList=new Array,E._engine=i.getEngine(),E.name=t,E.isRenderTarget=!0,E._initialSizeParameter=r,E._processSizeParameter(r),E._resizeObserver=E.getScene().getEngine().onResizeObservable.add(function(){}),E._generateMipMaps=!!o,E._doNotChangeAspectRatio=u,E._renderingManager=new l.b(i),E._renderingManager._useSceneAutoClearSetup=!0,g?E:(E._renderTargetOptions={generateMipMaps:o,type:h,format:m,samplingMode:p,generateDepthBuffer:d,generateStencilBuffer:_},p===a.a.NEAREST_SAMPLINGMODE&&(E.wrapU=a.a.CLAMP_ADDRESSMODE,E.wrapV=a.a.CLAMP_ADDRESSMODE),T||(f?(E._texture=i.getEngine().createRenderTargetCubeTexture(E.getRenderSize(),E._renderTargetOptions),E.coordinatesMode=a.a.INVCUBIC_MODE,E._textureMatrix=s.Matrix.Identity()):E._texture=i.getEngine().createRenderTargetTexture(E._size,E._renderTargetOptions)),E)):E}return i.d(t,e),Object.defineProperty(t.prototype,"renderList",{get:function(){return this._renderList},set:function(e){this._renderList=e,this._renderList&&this._hookArray(this._renderList)},enumerable:!0,configurable:!0}),t.prototype._hookArray=function(e){var t=this,r=e.push;e.push=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var o=0===e.length,s=r.apply(e,i);return o&&t.getScene().meshes.forEach(function(e){e._markSubMeshesAsLightDirty()}),s};var i=e.splice;e.splice=function(r,n){var o=i.apply(e,[r,n]);return 0===e.length&&t.getScene().meshes.forEach(function(e){e._markSubMeshesAsLightDirty()}),o}},Object.defineProperty(t.prototype,"onAfterUnbind",{set:function(e){this._onAfterUnbindObserver&&this.onAfterUnbindObservable.remove(this._onAfterUnbindObserver),this._onAfterUnbindObserver=this.onAfterUnbindObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onBeforeRender",{set:function(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onAfterRender",{set:function(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onClear",{set:function(e){this._onClearObserver&&this.onClearObservable.remove(this._onClearObserver),this._onClearObserver=this.onClearObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderTargetOptions",{get:function(){return this._renderTargetOptions},enumerable:!0,configurable:!0}),t.prototype._onRatioRescale=function(){this._sizeRatio&&this.resize(this._initialSizeParameter)},Object.defineProperty(t.prototype,"boundingBoxSize",{get:function(){return this._boundingBoxSize},set:function(e){if(!this._boundingBoxSize||!this._boundingBoxSize.equals(e)){this._boundingBoxSize=e;var t=this.getScene();t&&t.markAllMaterialsAsDirty(c.a.MATERIAL_TextureDirtyFlag)}},enumerable:!0,configurable:!0}),t.prototype.createDepthStencilTexture=function(e,t,r){if(void 0===e&&(e=0),void 0===t&&(t=!0),void 0===r&&(r=!1),this.getScene()){var i=this.getScene().getEngine();this.depthStencilTexture=i.createDepthStencilTexture(this._size,{bilinearFiltering:t,comparisonFunction:e,generateStencil:r,isCube:this.isCube}),i.setFrameBufferDepthStencilTexture(this)}},t.prototype._processSizeParameter=function(e){e.ratio?(this._sizeRatio=e.ratio,this._size={width:this._bestReflectionRenderTargetDimension(this._engine.getRenderWidth(),this._sizeRatio),height:this._bestReflectionRenderTargetDimension(this._engine.getRenderHeight(),this._sizeRatio)}):this._size=e},Object.defineProperty(t.prototype,"samples",{get:function(){return this._samples},set:function(e){if(this._samples!==e){var t=this.getScene();t&&(this._samples=t.getEngine().updateRenderTargetTextureSampleCount(this._texture,e))}},enumerable:!0,configurable:!0}),t.prototype.resetRefreshCounter=function(){this._currentRefreshId=-1},Object.defineProperty(t.prototype,"refreshRate",{get:function(){return this._refreshRate},set:function(e){this._refreshRate=e,this.resetRefreshCounter()},enumerable:!0,configurable:!0}),t.prototype.addPostProcess=function(e){if(!this._postProcessManager){var t=this.getScene();if(!t)return;this._postProcessManager=new u.a(t),this._postProcesses=new Array}this._postProcesses.push(e),this._postProcesses[0].autoClear=!1},t.prototype.clearPostProcesses=function(e){if(void 0===e&&(e=!1),this._postProcesses){if(e)for(var t=0,r=this._postProcesses;t<r.length;t++){r[t].dispose()}this._postProcesses=[]}},t.prototype.removePostProcess=function(e){if(this._postProcesses){var t=this._postProcesses.indexOf(e);-1!==t&&(this._postProcesses.splice(t,1),this._postProcesses.length>0&&(this._postProcesses[0].autoClear=!1))}},t.prototype._shouldRender=function(){return-1===this._currentRefreshId?(this._currentRefreshId=1,!0):this.refreshRate===this._currentRefreshId?(this._currentRefreshId=1,!0):(this._currentRefreshId++,!1)},t.prototype.getRenderSize=function(){return this.getRenderWidth()},t.prototype.getRenderWidth=function(){return this._size.width?this._size.width:this._size},t.prototype.getRenderHeight=function(){return this._size.width?this._size.height:this._size},Object.defineProperty(t.prototype,"canRescale",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.scale=function(e){var t=this.getRenderSize()*e;this.resize(t)},t.prototype.getReflectionTextureMatrix=function(){return this.isCube?this._textureMatrix:e.prototype.getReflectionTextureMatrix.call(this)},t.prototype.resize=function(e){this.releaseInternalTexture();var t=this.getScene();t&&(this._processSizeParameter(e),this.isCube?this._texture=t.getEngine().createRenderTargetCubeTexture(this.getRenderSize(),this._renderTargetOptions):this._texture=t.getEngine().createRenderTargetTexture(this._size,this._renderTargetOptions))},t.prototype.render=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),a=this.getScene()){var r,i=a.getEngine();if(void 0!==this.useCameraPostProcesses&&(e=this.useCameraPostProcesses),this._waitingRenderList){this.renderList=[];for(var n=0;n<this._waitingRenderList.length;n++){var o=this._waitingRenderList[n],s=a.getMeshByID(o);s&&this.renderList.push(s)}delete this._waitingRenderList}if(this.renderListPredicate){var a;if(this.renderList?this.renderList.length=0:this.renderList=[],!(a=this.getScene()))return;var u=a.meshes;for(n=0;n<u.length;n++){var l=u[n];this.renderListPredicate(l)&&this.renderList.push(l)}}this.onBeforeBindObservable.notifyObservers(this),this.activeCamera?(r=this.activeCamera,i.setViewport(this.activeCamera.viewport,this.getRenderWidth(),this.getRenderHeight()),this.activeCamera!==a.activeCamera&&a.setTransformMatrix(this.activeCamera.getViewMatrix(),this.activeCamera.getProjectionMatrix(!0))):(r=a.activeCamera)&&i.setViewport(r.viewport,this.getRenderWidth(),this.getRenderHeight()),this._renderingManager.reset();for(var c=this.renderList?this.renderList:a.getActiveMeshes().data,h=this.renderList?this.renderList.length:a.getActiveMeshes().length,f=a.getRenderId(),p=0;p<h;p++){if(l=c[p]){if(!l.isReady(0===this.refreshRate)){this.resetRefreshCounter();continue}l._preActivateForIntermediateRendering(f);var d=void 0;if(d=!(this.renderList||!r)&&0==(l.layerMask&r.layerMask),l.isEnabled()&&l.isVisible&&l.subMeshes&&!d){l._activate(f);for(var _=0;_<l.subMeshes.length;_++){var g=l.subMeshes[_];a._activeIndices.addCount(g.indexCount,!1),this._renderingManager.dispatch(g,l)}}}}for(var m=0;m<a.particleSystems.length;m++){var T=a.particleSystems[m],E=T.emitter;T.isStarted()&&E&&E.position&&E.isEnabled()&&(c.indexOf(E)>=0&&this._renderingManager.dispatchParticles(T))}if(this.isCube)for(var b=0;b<6;b++)this.renderToTarget(b,c,e,t),a.incrementRenderId(),a.resetCachedMaterial();else this.renderToTarget(0,c,e,t);this.onAfterUnbindObservable.notifyObservers(this),a.activeCamera&&(this.activeCamera&&this.activeCamera!==a.activeCamera&&a.setTransformMatrix(a.activeCamera.getViewMatrix(),a.activeCamera.getProjectionMatrix(!0)),i.setViewport(a.activeCamera.viewport)),a.resetCachedMaterial()}},t.prototype._bestReflectionRenderTargetDimension=function(e,t){var r=e*t,i=o.h.NearestPOT(r+16384/(128+r));return Math.min(o.h.FloorPOT(e),i)},t.prototype.unbindFrameBuffer=function(e,t){var r=this;this._texture&&e.unBindFramebuffer(this._texture,this.isCube,function(){r.onAfterRenderObservable.notifyObservers(t)})},t.prototype.renderToTarget=function(e,t,r,i){var n=this.getScene();if(n){var s=n.getEngine();if(this._texture){this._postProcessManager?this._postProcessManager._prepareFrame(this._texture,this._postProcesses):r&&n.postProcessManager._prepareFrame(this._texture)||this._texture&&s.bindFramebuffer(this._texture,this.isCube?e:void 0,void 0,void 0,this.ignoreCameraViewport,this.depthStencilTexture?this.depthStencilTexture:void 0),this.onBeforeRenderObservable.notifyObservers(e),this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(s):s.clear(this.clearColor||n.clearColor,!0,!0,!0),this._doNotChangeAspectRatio||n.updateTransformMatrix(!0);for(var a=0,u=n._beforeRenderTargetDrawStage;a<u.length;a++){u[a].action(this)}this._renderingManager.render(this.customRenderFunction,t,this.renderParticles,this.renderSprites);for(var l=0,c=n._afterRenderTargetDrawStage;l<c.length;l++){c[l].action(this)}this._postProcessManager?this._postProcessManager._finalizeFrame(!1,this._texture,e,this._postProcesses,this.ignoreCameraViewport):r&&n.postProcessManager._finalizeFrame(!1,this._texture,e),this._doNotChangeAspectRatio||n.updateTransformMatrix(!0),i&&o.h.DumpFramebuffer(this.getRenderWidth(),this.getRenderHeight(),s),this.isCube&&5!==e?this.onAfterRenderObservable.notifyObservers(e):(this.isCube&&5===e&&s.generateMipMapsForCubemap(this._texture),this.unbindFrameBuffer(s,e))}}},t.prototype.setRenderingOrder=function(e,t,r,i){void 0===t&&(t=null),void 0===r&&(r=null),void 0===i&&(i=null),this._renderingManager.setRenderingOrder(e,t,r,i)},t.prototype.setRenderingAutoClearDepthStencil=function(e,t){this._renderingManager.setRenderingAutoClearDepthStencil(e,t),this._renderingManager._useSceneAutoClearSetup=!1},t.prototype.clone=function(){var e=this.getSize(),r=new t(this.name,e,this.getScene(),this._renderTargetOptions.generateMipMaps,this._doNotChangeAspectRatio,this._renderTargetOptions.type,this.isCube,this._renderTargetOptions.samplingMode,this._renderTargetOptions.generateDepthBuffer,this._renderTargetOptions.generateStencilBuffer);return r.hasAlpha=this.hasAlpha,r.level=this.level,r.coordinatesMode=this.coordinatesMode,this.renderList&&(r.renderList=this.renderList.slice(0)),r},t.prototype.serialize=function(){if(!this.name)return null;var t=e.prototype.serialize.call(this);if(t.renderTargetSize=this.getRenderSize(),t.renderList=[],this.renderList)for(var r=0;r<this.renderList.length;r++)t.renderList.push(this.renderList[r].id);return t},t.prototype.disposeFramebufferObjects=function(){var e=this.getInternalTexture(),t=this.getScene();e&&t&&t.getEngine()._releaseFramebufferObjects(e)},t.prototype.dispose=function(){this._postProcessManager&&(this._postProcessManager.dispose(),this._postProcessManager=null),this.clearPostProcesses(!0),this._resizeObserver&&(this.getScene().getEngine().onResizeObservable.remove(this._resizeObserver),this._resizeObserver=null),this.renderList=null;var t=this.getScene();if(t){var r=t.customRenderTargets.indexOf(this);r>=0&&t.customRenderTargets.splice(r,1);for(var i=0,n=t.cameras;i<n.length;i++){var o=n[i];(r=o.customRenderTargets.indexOf(this))>=0&&o.customRenderTargets.splice(r,1)}e.prototype.dispose.call(this)}},t.prototype._rebuild=function(){this.refreshRate===t.REFRESHRATE_RENDER_ONCE&&(this.refreshRate=t.REFRESHRATE_RENDER_ONCE),this._postProcessManager&&this._postProcessManager._rebuild()},t.prototype.freeRenderingGroups=function(){this._renderingManager&&this._renderingManager.freeRenderingGroups()},t.REFRESHRATE_RENDER_ONCE=0,t.REFRESHRATE_RENDER_ONEVERYFRAME=1,t.REFRESHRATE_RENDER_ONEVERYTWOFRAMES=2,t}(a.a);a.a._CreateRenderTargetTexture=function(e,t,r,i){return new h(e,t,r,i)}},40:function(e,t,r){"use strict";r.d(t,"b",function(){return c}),r.d(t,"a",function(){return h});var i=r(1),n=r(2),o=r(7),s=r(5),a=r(0),u=r(76),l=r(140),c=function(e){function t(){var t=e.call(this)||this;return t.IMAGEPROCESSING=!1,t.VIGNETTE=!1,t.VIGNETTEBLENDMODEMULTIPLY=!1,t.VIGNETTEBLENDMODEOPAQUE=!1,t.TONEMAPPING=!1,t.TONEMAPPING_ACES=!1,t.CONTRAST=!1,t.COLORCURVES=!1,t.COLORGRADING=!1,t.COLORGRADING3D=!1,t.SAMPLER3DGREENDEPTH=!1,t.SAMPLER3DBGRMAP=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.EXPOSURE=!1,t.rebuild(),t}return i.d(t,e),t}(u.a),h=function(){function e(){this.colorCurves=new l.a,this._colorCurvesEnabled=!1,this._colorGradingEnabled=!1,this._colorGradingWithGreenDepth=!0,this._colorGradingBGR=!0,this._exposure=1,this._toneMappingEnabled=!1,this._toneMappingType=e.TONEMAPPING_STANDARD,this._contrast=1,this.vignetteStretch=0,this.vignetteCentreX=0,this.vignetteCentreY=0,this.vignetteWeight=1.5,this.vignetteColor=new a.Color4(0,0,0,0),this.vignetteCameraFov=.5,this._vignetteBlendMode=e.VIGNETTEMODE_MULTIPLY,this._vignetteEnabled=!1,this._applyByPostProcess=!1,this._isEnabled=!0,this.onUpdateParameters=new o.c}return Object.defineProperty(e.prototype,"colorCurvesEnabled",{get:function(){return this._colorCurvesEnabled},set:function(e){this._colorCurvesEnabled!==e&&(this._colorCurvesEnabled=e,this._updateParameters())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorGradingTexture",{get:function(){return this._colorGradingTexture},set:function(e){this._colorGradingTexture!==e&&(this._colorGradingTexture=e,this._updateParameters())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorGradingEnabled",{get:function(){return this._colorGradingEnabled},set:function(e){this._colorGradingEnabled!==e&&(this._colorGradingEnabled=e,this._updateParameters())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorGradingWithGreenDepth",{get:function(){return this._colorGradingWithGreenDepth},set:function(e){this._colorGradingWithGreenDepth!==e&&(this._colorGradingWithGreenDepth=e,this._updateParameters())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorGradingBGR",{get:function(){return this._colorGradingBGR},set:function(e){this._colorGradingBGR!==e&&(this._colorGradingBGR=e,this._updateParameters())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exposure",{get:function(){return this._exposure},set:function(e){this._exposure!==e&&(this._exposure=e,this._updateParameters())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toneMappingEnabled",{get:function(){return this._toneMappingEnabled},set:function(e){this._toneMappingEnabled!==e&&(this._toneMappingEnabled=e,this._updateParameters())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toneMappingType",{get:function(){return this._toneMappingType},set:function(e){this._toneMappingType!==e&&(this._toneMappingType=e,this._updateParameters())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contrast",{get:function(){return this._contrast},set:function(e){this._contrast!==e&&(this._contrast=e,this._updateParameters())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vignetteBlendMode",{get:function(){return this._vignetteBlendMode},set:function(e){this._vignetteBlendMode!==e&&(this._vignetteBlendMode=e,this._updateParameters())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vignetteEnabled",{get:function(){return this._vignetteEnabled},set:function(e){this._vignetteEnabled!==e&&(this._vignetteEnabled=e,this._updateParameters())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"applyByPostProcess",{get:function(){return this._applyByPostProcess},set:function(e){this._applyByPostProcess!==e&&(this._applyByPostProcess=e,this._updateParameters())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(e){this._isEnabled!==e&&(this._isEnabled=e,this._updateParameters())},enumerable:!0,configurable:!0}),e.prototype._updateParameters=function(){this.onUpdateParameters.notifyObservers(this)},e.prototype.getClassName=function(){return"ImageProcessingConfiguration"},e.PrepareUniforms=function(e,t){t.EXPOSURE&&e.push("exposureLinear"),t.CONTRAST&&e.push("contrast"),t.COLORGRADING&&e.push("colorTransformSettings"),t.VIGNETTE&&(e.push("vInverseScreenSize"),e.push("vignetteSettings1"),e.push("vignetteSettings2")),t.COLORCURVES&&l.a.PrepareUniforms(e)},e.PrepareSamplers=function(e,t){t.COLORGRADING&&e.push("txColorTransform")},e.prototype.prepareDefines=function(t,r){if(void 0===r&&(r=!1),r!==this.applyByPostProcess||!this._isEnabled)return t.VIGNETTE=!1,t.TONEMAPPING=!1,t.TONEMAPPING_ACES=!1,t.CONTRAST=!1,t.EXPOSURE=!1,t.COLORCURVES=!1,t.COLORGRADING=!1,t.COLORGRADING3D=!1,t.IMAGEPROCESSING=!1,void(t.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess&&this._isEnabled);switch(t.VIGNETTE=this.vignetteEnabled,t.VIGNETTEBLENDMODEMULTIPLY=this.vignetteBlendMode===e._VIGNETTEMODE_MULTIPLY,t.VIGNETTEBLENDMODEOPAQUE=!t.VIGNETTEBLENDMODEMULTIPLY,t.TONEMAPPING=this.toneMappingEnabled,this._toneMappingType){case e.TONEMAPPING_ACES:t.TONEMAPPING_ACES=!0;break;default:t.TONEMAPPING_ACES=!1}t.CONTRAST=1!==this.contrast,t.EXPOSURE=1!==this.exposure,t.COLORCURVES=this.colorCurvesEnabled&&!!this.colorCurves,t.COLORGRADING=this.colorGradingEnabled&&!!this.colorGradingTexture,t.COLORGRADING?t.COLORGRADING3D=this.colorGradingTexture.is3D:t.COLORGRADING3D=!1,t.SAMPLER3DGREENDEPTH=this.colorGradingWithGreenDepth,t.SAMPLER3DBGRMAP=this.colorGradingBGR,t.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess,t.IMAGEPROCESSING=t.VIGNETTE||t.TONEMAPPING||t.CONTRAST||t.EXPOSURE||t.COLORCURVES||t.COLORGRADING},e.prototype.isReady=function(){return!this.colorGradingEnabled||!this.colorGradingTexture||this.colorGradingTexture.isReady()},e.prototype.bind=function(e,t){if(void 0===t&&(t=1),this._colorCurvesEnabled&&this.colorCurves&&l.a.Bind(this.colorCurves,e),this._vignetteEnabled){var r=1/e.getEngine().getRenderWidth(),i=1/e.getEngine().getRenderHeight();e.setFloat2("vInverseScreenSize",r,i);var n=Math.tan(.5*this.vignetteCameraFov),o=n*t,a=Math.sqrt(o*n);o=s.h.Mix(o,a,this.vignetteStretch),n=s.h.Mix(n,a,this.vignetteStretch),e.setFloat4("vignetteSettings1",o,n,-o*this.vignetteCentreX,-n*this.vignetteCentreY);var u=-2*this.vignetteWeight;e.setFloat4("vignetteSettings2",this.vignetteColor.r,this.vignetteColor.g,this.vignetteColor.b,u)}if(e.setFloat("exposureLinear",this.exposure),e.setFloat("contrast",this.contrast),this.colorGradingTexture){e.setTexture("txColorTransform",this.colorGradingTexture);var c=this.colorGradingTexture.getSize().height;e.setFloat4("colorTransformSettings",(c-1)/c,.5/c,c,this.colorGradingTexture.level)}},e.prototype.clone=function(){return n.a.Clone(function(){return new e},this)},e.prototype.serialize=function(){return n.a.Serialize(this)},e.Parse=function(t){return n.a.Parse(function(){return new e},t,null,null)},Object.defineProperty(e,"VIGNETTEMODE_MULTIPLY",{get:function(){return this._VIGNETTEMODE_MULTIPLY},enumerable:!0,configurable:!0}),Object.defineProperty(e,"VIGNETTEMODE_OPAQUE",{get:function(){return this._VIGNETTEMODE_OPAQUE},enumerable:!0,configurable:!0}),e.TONEMAPPING_STANDARD=0,e.TONEMAPPING_ACES=1,e._VIGNETTEMODE_MULTIPLY=0,e._VIGNETTEMODE_OPAQUE=1,i.c([Object(n.g)()],e.prototype,"colorCurves",void 0),i.c([Object(n.c)()],e.prototype,"_colorCurvesEnabled",void 0),i.c([Object(n.l)("colorGradingTexture")],e.prototype,"_colorGradingTexture",void 0),i.c([Object(n.c)()],e.prototype,"_colorGradingEnabled",void 0),i.c([Object(n.c)()],e.prototype,"_colorGradingWithGreenDepth",void 0),i.c([Object(n.c)()],e.prototype,"_colorGradingBGR",void 0),i.c([Object(n.c)()],e.prototype,"_exposure",void 0),i.c([Object(n.c)()],e.prototype,"_toneMappingEnabled",void 0),i.c([Object(n.c)()],e.prototype,"_toneMappingType",void 0),i.c([Object(n.c)()],e.prototype,"_contrast",void 0),i.c([Object(n.c)()],e.prototype,"vignetteStretch",void 0),i.c([Object(n.c)()],e.prototype,"vignetteCentreX",void 0),i.c([Object(n.c)()],e.prototype,"vignetteCentreY",void 0),i.c([Object(n.c)()],e.prototype,"vignetteWeight",void 0),i.c([Object(n.f)()],e.prototype,"vignetteColor",void 0),i.c([Object(n.c)()],e.prototype,"vignetteCameraFov",void 0),i.c([Object(n.c)()],e.prototype,"_vignetteBlendMode",void 0),i.c([Object(n.c)()],e.prototype,"_vignetteEnabled",void 0),i.c([Object(n.c)()],e.prototype,"_applyByPostProcess",void 0),i.c([Object(n.c)()],e.prototype,"_isEnabled",void 0),e}();n.a._ImageProcessingConfigurationParser=h.Parse},54:function(e,t,r){"use strict";r.d(t,"a",function(){return l});var i=r(1),n=r(2),o=r(101),s=r(0),a=r(60),u=r(26),l=function(e){function t(r,i){var n=e.call(this,r,i)||this;return n.directIntensity=1,n.emissiveIntensity=1,n.environmentIntensity=1,n.specularIntensity=1,n.disableBumpMap=!1,n.ambientTextureStrength=1,n.ambientTextureImpactOnAnalyticalLights=t.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,n.ambientColor=new s.Color3(0,0,0),n.albedoColor=new s.Color3(1,1,1),n.reflectivityColor=new s.Color3(1,1,1),n.reflectionColor=new s.Color3(1,1,1),n.emissiveColor=new s.Color3(0,0,0),n.microSurface=1,n.indexOfRefraction=.66,n.invertRefractionY=!1,n.linkRefractionWithTransparency=!1,n.useLightmapAsShadowmap=!1,n.useAlphaFromAlbedoTexture=!1,n.forceAlphaTest=!1,n.alphaCutOff=.4,n.useSpecularOverAlpha=!0,n.useMicroSurfaceFromReflectivityMapAlpha=!1,n.useRoughnessFromMetallicTextureAlpha=!0,n.useRoughnessFromMetallicTextureGreen=!1,n.useMetallnessFromMetallicTextureBlue=!1,n.useAmbientOcclusionFromMetallicTextureRed=!1,n.useAmbientInGrayScale=!1,n.useAutoMicroSurfaceFromReflectivityMap=!1,n.useRadianceOverAlpha=!0,n.useObjectSpaceNormalMap=!1,n.useParallax=!1,n.useParallaxOcclusion=!1,n.parallaxScaleBias=.05,n.disableLighting=!1,n.forceIrradianceInFragment=!1,n.maxSimultaneousLights=4,n.invertNormalMapX=!1,n.invertNormalMapY=!1,n.twoSidedLighting=!1,n.useAlphaFresnel=!1,n.useLinearAlphaFresnel=!1,n.environmentBRDFTexture=null,n.forceNormalForward=!1,n.enableSpecularAntiAliasing=!1,n.useHorizonOcclusion=!0,n.useRadianceOcclusion=!0,n.unlit=!1,n._environmentBRDFTexture=o.a.GetEnvironmentBRDFTexture(i),n}return i.d(t,e),Object.defineProperty(t.prototype,"usePhysicalLightFalloff",{get:function(){return this._lightFalloff===a.a.LIGHTFALLOFF_PHYSICAL},set:function(e){e!==this.usePhysicalLightFalloff&&(this._markAllSubMeshesAsTexturesDirty(),this._lightFalloff=e?a.a.LIGHTFALLOFF_PHYSICAL:a.a.LIGHTFALLOFF_STANDARD)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useGLTFLightFalloff",{get:function(){return this._lightFalloff===a.a.LIGHTFALLOFF_GLTF},set:function(e){e!==this.useGLTFLightFalloff&&(this._markAllSubMeshesAsTexturesDirty(),this._lightFalloff=e?a.a.LIGHTFALLOFF_GLTF:a.a.LIGHTFALLOFF_STANDARD)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageProcessingConfiguration",{get:function(){return this._imageProcessingConfiguration},set:function(e){this._attachImageProcessingConfiguration(e),this._markAllSubMeshesAsTexturesDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraColorCurvesEnabled",{get:function(){return this.imageProcessingConfiguration.colorCurvesEnabled},set:function(e){this.imageProcessingConfiguration.colorCurvesEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraColorGradingEnabled",{get:function(){return this.imageProcessingConfiguration.colorGradingEnabled},set:function(e){this.imageProcessingConfiguration.colorGradingEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraToneMappingEnabled",{get:function(){return this._imageProcessingConfiguration.toneMappingEnabled},set:function(e){this._imageProcessingConfiguration.toneMappingEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraExposure",{get:function(){return this._imageProcessingConfiguration.exposure},set:function(e){this._imageProcessingConfiguration.exposure=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraContrast",{get:function(){return this._imageProcessingConfiguration.contrast},set:function(e){this._imageProcessingConfiguration.contrast=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraColorGradingTexture",{get:function(){return this._imageProcessingConfiguration.colorGradingTexture},set:function(e){this._imageProcessingConfiguration.colorGradingTexture=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cameraColorCurves",{get:function(){return this._imageProcessingConfiguration.colorCurves},set:function(e){this._imageProcessingConfiguration.colorCurves=e},enumerable:!0,configurable:!0}),t.prototype.getClassName=function(){return"PBRMaterial"},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);return this._albedoTexture&&t.push(this._albedoTexture),this._ambientTexture&&t.push(this._ambientTexture),this._opacityTexture&&t.push(this._opacityTexture),this._reflectionTexture&&t.push(this._reflectionTexture),this._emissiveTexture&&t.push(this._emissiveTexture),this._reflectivityTexture&&t.push(this._reflectivityTexture),this._metallicTexture&&t.push(this._metallicTexture),this._microSurfaceTexture&&t.push(this._microSurfaceTexture),this._bumpTexture&&t.push(this._bumpTexture),this._lightmapTexture&&t.push(this._lightmapTexture),this._refractionTexture&&t.push(this._refractionTexture),t},t.prototype.hasTexture=function(t){return!!e.prototype.hasTexture.call(this,t)||(this._albedoTexture===t||(this._ambientTexture===t||(this._opacityTexture===t||(this._reflectionTexture===t||(this._reflectivityTexture===t||(this._metallicTexture===t||(this._microSurfaceTexture===t||(this._bumpTexture===t||(this._lightmapTexture===t||this._refractionTexture===t)))))))))},t.prototype.clone=function(e){var r=this,i=n.a.Clone(function(){return new t(e,r.getScene())},this);return i.id=e,i.name=e,i},t.prototype.serialize=function(){var e=n.a.Serialize(this);return e.customType="BABYLON.PBRMaterial",e},t.Parse=function(e,r,i){return n.a.Parse(function(){return new t(e.name,r)},e,r,i)},t.PBRMATERIAL_OPAQUE=a.a.PBRMATERIAL_OPAQUE,t.PBRMATERIAL_ALPHATEST=a.a.PBRMATERIAL_ALPHATEST,t.PBRMATERIAL_ALPHABLEND=a.a.PBRMATERIAL_ALPHABLEND,t.PBRMATERIAL_ALPHATESTANDBLEND=a.a.PBRMATERIAL_ALPHATESTANDBLEND,t.DEFAULT_AO_ON_ANALYTICAL_LIGHTS=a.a.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"directIntensity",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"emissiveIntensity",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"environmentIntensity",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"specularIntensity",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"disableBumpMap",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"albedoTexture",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"ambientTexture",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"ambientTextureStrength",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"ambientTextureImpactOnAnalyticalLights",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesAndMiscDirty")],t.prototype,"opacityTexture",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"reflectionTexture",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"emissiveTexture",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"reflectivityTexture",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"metallicTexture",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"metallic",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"roughness",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"microSurfaceTexture",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"bumpTexture",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty",null)],t.prototype,"lightmapTexture",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"refractionTexture",void 0),i.c([Object(n.e)("ambient"),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"ambientColor",void 0),i.c([Object(n.e)("albedo"),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"albedoColor",void 0),i.c([Object(n.e)("reflectivity"),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"reflectivityColor",void 0),i.c([Object(n.e)("reflection"),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"reflectionColor",void 0),i.c([Object(n.e)("emissive"),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"emissiveColor",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"microSurface",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"indexOfRefraction",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"invertRefractionY",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"linkRefractionWithTransparency",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useLightmapAsShadowmap",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesAndMiscDirty")],t.prototype,"useAlphaFromAlbedoTexture",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesAndMiscDirty")],t.prototype,"forceAlphaTest",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesAndMiscDirty")],t.prototype,"alphaCutOff",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useSpecularOverAlpha",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useMicroSurfaceFromReflectivityMapAlpha",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useRoughnessFromMetallicTextureAlpha",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useRoughnessFromMetallicTextureGreen",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useMetallnessFromMetallicTextureBlue",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useAmbientOcclusionFromMetallicTextureRed",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useAmbientInGrayScale",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useAutoMicroSurfaceFromReflectivityMap",void 0),i.c([Object(n.c)()],t.prototype,"usePhysicalLightFalloff",null),i.c([Object(n.c)()],t.prototype,"useGLTFLightFalloff",null),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useRadianceOverAlpha",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useObjectSpaceNormalMap",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useParallax",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useParallaxOcclusion",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"parallaxScaleBias",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsLightsDirty")],t.prototype,"disableLighting",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"forceIrradianceInFragment",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsLightsDirty")],t.prototype,"maxSimultaneousLights",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"invertNormalMapX",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"invertNormalMapY",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"twoSidedLighting",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useAlphaFresnel",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useLinearAlphaFresnel",void 0),i.c([Object(n.l)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"environmentBRDFTexture",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"forceNormalForward",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"enableSpecularAntiAliasing",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useHorizonOcclusion",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsTexturesDirty")],t.prototype,"useRadianceOcclusion",void 0),i.c([Object(n.c)(),Object(n.b)("_markAllSubMeshesAsMiscDirty")],t.prototype,"unlit",void 0),t}(a.a);u.a.RegisteredTypes["BABYLON.PBRMaterial"]=l},58:function(e,t,r){"use strict";r.d(t,"a",function(){return h});var i=r(1),n=r(2),o=r(7),s=r(5),a=r(98),u=r(0),l=r(21),c=r(4),h=function(){function e(t){this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this.getAlphaFromRGB=!1,this.level=1,this.coordinatesIndex=0,this._coordinatesMode=c.a.TEXTURE_EXPLICIT_MODE,this.wrapU=c.a.TEXTURE_WRAP_ADDRESSMODE,this.wrapV=c.a.TEXTURE_WRAP_ADDRESSMODE,this.wrapR=c.a.TEXTURE_WRAP_ADDRESSMODE,this.anisotropicFilteringLevel=e.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this.gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this.animations=new Array,this.onDisposeObservable=new o.c,this.delayLoadState=c.a.DELAYLOADSTATE_NONE,this._cachedSize=u.Size.Zero(),this._scene=t||l.a.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this)),this._uid=null}return Object.defineProperty(e.prototype,"hasAlpha",{get:function(){return this._hasAlpha},set:function(e){this._hasAlpha!==e&&(this._hasAlpha=e,this._scene&&this._scene.markAllMaterialsAsDirty(c.a.MATERIAL_TextureDirtyFlag|c.a.MATERIAL_MiscDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coordinatesMode",{get:function(){return this._coordinatesMode},set:function(e){this._coordinatesMode!==e&&(this._coordinatesMode=e,this._scene&&this._scene.markAllMaterialsAsDirty(c.a.MATERIAL_TextureDirtyFlag))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCube",{get:function(){return!!this._texture&&this._texture.isCube},set:function(e){this._texture&&(this._texture.isCube=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is3D",{get:function(){return!!this._texture&&this._texture.is3D},set:function(e){this._texture&&(this._texture.is3D=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRGBD",{get:function(){return null!=this._texture&&this._texture._isRGBD},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noMipmap",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lodGenerationOffset",{get:function(){return this._texture?this._texture._lodGenerationOffset:0},set:function(e){this._texture&&(this._texture._lodGenerationOffset=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lodGenerationScale",{get:function(){return this._texture?this._texture._lodGenerationScale:0},set:function(e){this._texture&&(this._texture._lodGenerationScale=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid||(this._uid=s.h.RandomId()),this._uid},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this.name},e.prototype.getClassName=function(){return"BaseTexture"},Object.defineProperty(e.prototype,"onDispose",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBlocking",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.getScene=function(){return this._scene},e.prototype.getTextureMatrix=function(){return u.Matrix.IdentityReadOnly},e.prototype.getReflectionTextureMatrix=function(){return u.Matrix.IdentityReadOnly},e.prototype.getInternalTexture=function(){return this._texture},e.prototype.isReadyOrNotBlocking=function(){return!this.isBlocking||this.isReady()},e.prototype.isReady=function(){return this.delayLoadState===c.a.DELAYLOADSTATE_NOTLOADED?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady},e.prototype.getSize=function(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize},e.prototype.getBaseSize=function(){return this.isReady()&&this._texture?this._texture._size?new u.Size(this._texture._size,this._texture._size):new u.Size(this._texture.baseWidth,this._texture.baseHeight):u.Size.Zero()},e.prototype.updateSamplingMode=function(e){if(this._texture){var t=this.getScene();t&&t.getEngine().updateTextureSamplingMode(e,this._texture)}},e.prototype.scale=function(e){},Object.defineProperty(e.prototype,"canRescale",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype._getFromCache=function(e,t,r){if(!this._scene)return null;for(var i=this._scene.getEngine().getLoadedTexturesCache(),n=0;n<i.length;n++){var o=i[n];if(o.url===e&&o.generateMipMaps===!t&&(!r||r===o.samplingMode))return o.incrementReferences(),o}return null},e.prototype._rebuild=function(){},e.prototype.delayLoad=function(){},e.prototype.clone=function(){return null},Object.defineProperty(e.prototype,"textureType",{get:function(){return this._texture&&void 0!==this._texture.type?this._texture.type:c.a.TEXTURETYPE_UNSIGNED_INT},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureFormat",{get:function(){return this._texture&&void 0!==this._texture.format?this._texture.format:c.a.TEXTUREFORMAT_RGBA},enumerable:!0,configurable:!0}),e.prototype.readPixels=function(e,t,r){if(void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=null),!this._texture)return null;var i=this.getSize(),n=i.width,o=i.height,s=this.getScene();if(!s)return null;var a=s.getEngine();return 0!=t&&(n/=Math.pow(2,t),o/=Math.pow(2,t),n=Math.round(n),o=Math.round(o)),this._texture.isCube?a._readTexturePixels(this._texture,n,o,e,t,r):a._readTexturePixels(this._texture,n,o,-1,t,r)},e.prototype.releaseInternalTexture=function(){this._texture&&(this._texture.dispose(),this._texture=null)},Object.defineProperty(e.prototype,"sphericalPolynomial",{get:function(){return this._texture&&a.a&&this.isReady()?(this._texture._sphericalPolynomial||(this._texture._sphericalPolynomial=a.a.ConvertCubeMapTextureToSphericalPolynomial(this)),this._texture._sphericalPolynomial):null},set:function(e){this._texture&&(this._texture._sphericalPolynomial=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_lodTextureHigh",{get:function(){return this._texture?this._texture._lodTextureHigh:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_lodTextureMid",{get:function(){return this._texture?this._texture._lodTextureMid:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_lodTextureLow",{get:function(){return this._texture?this._texture._lodTextureLow:null},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){if(this._scene){this._scene.stopAnimation(this),this._scene._removePendingData(this);var e=this._scene.textures.indexOf(this);e>=0&&this._scene.textures.splice(e,1),this._scene.onTextureRemovedObservable.notifyObservers(this),void 0!==this._texture&&(this.releaseInternalTexture(),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear())}},e.prototype.serialize=function(){if(!this.name)return null;var e=n.a.Serialize(this);return n.a.AppendSerializedAnimations(this,e),e},e.WhenAllReady=function(e,t){var r=e.length;if(0!==r)for(var i,n,o=function(){if((i=e[s]).isReady())0==--r&&t();else{n=i.onLoadObservable;var o=function(){n.removeCallback(o),0==--r&&t()};n.add(o)}},s=0;s<e.length;s++)o();else t()},e.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,i.c([Object(n.c)()],e.prototype,"uniqueId",void 0),i.c([Object(n.c)()],e.prototype,"name",void 0),i.c([Object(n.c)()],e.prototype,"metadata",void 0),i.c([Object(n.c)("hasAlpha")],e.prototype,"_hasAlpha",void 0),i.c([Object(n.c)()],e.prototype,"getAlphaFromRGB",void 0),i.c([Object(n.c)()],e.prototype,"level",void 0),i.c([Object(n.c)()],e.prototype,"coordinatesIndex",void 0),i.c([Object(n.c)("coordinatesMode")],e.prototype,"_coordinatesMode",void 0),i.c([Object(n.c)()],e.prototype,"wrapU",void 0),i.c([Object(n.c)()],e.prototype,"wrapV",void 0),i.c([Object(n.c)()],e.prototype,"wrapR",void 0),i.c([Object(n.c)()],e.prototype,"anisotropicFilteringLevel",void 0),i.c([Object(n.c)()],e.prototype,"isCube",null),i.c([Object(n.c)()],e.prototype,"is3D",null),i.c([Object(n.c)()],e.prototype,"gammaSpace",void 0),i.c([Object(n.c)()],e.prototype,"invertZ",void 0),i.c([Object(n.c)()],e.prototype,"lodLevelInAlpha",void 0),i.c([Object(n.c)()],e.prototype,"lodGenerationOffset",null),i.c([Object(n.c)()],e.prototype,"lodGenerationScale",null),i.c([Object(n.c)()],e.prototype,"isRenderTarget",void 0),e}()},6:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var i=r(1),n=r(2),o=r(7),s=r(5),a=r(0),u=r(58),l=r(4),c=function(e){function t(r,i,n,a,u,c,h,f,p,d){void 0===n&&(n=!1),void 0===a&&(a=!0),void 0===u&&(u=t.TRILINEAR_SAMPLINGMODE),void 0===c&&(c=null),void 0===h&&(h=null),void 0===f&&(f=null),void 0===p&&(p=!1);var _=e.call(this,i)||this;if(_.uOffset=0,_.vOffset=0,_.uScale=1,_.vScale=1,_.uAng=0,_.vAng=0,_.wAng=0,_.uRotationCenter=.5,_.vRotationCenter=.5,_.wRotationCenter=.5,_._initialSamplingMode=t.BILINEAR_SAMPLINGMODE,_.onLoadObservable=new o.c,_._isBlocking=!0,_.name=r||"",_.url=r,_._noMipmap=n,_._invertY=a,_._initialSamplingMode=u,_._buffer=f,_._deleteBuffer=p,d&&(_._format=d),!(i=_.getScene()))return _;i.getEngine().onBeforeTextureInitObservable.notifyObservers(_);var g=function(){_._texture&&_._texture._invertVScale&&(_.vScale=-1),_.onLoadObservable.hasObservers()&&_.onLoadObservable.notifyObservers(_),c&&c(),!_.isBlocking&&i&&i.resetCachedMaterial()};return _.url?(_._texture=_._getFromCache(_.url,n,u),_._texture?_._texture.isReady?s.h.SetImmediate(function(){return g()}):_._texture.onLoadedObservable.add(g):i.useDelayedTextureLoading?(_.delayLoadState=l.a.DELAYLOADSTATE_NOTLOADED,_._delayedOnLoad=g,_._delayedOnError=h):(_._texture=i.getEngine().createTexture(_.url,n,a,i,u,g,h,_._buffer,void 0,_._format),p&&delete _._buffer),_):(_._delayedOnLoad=g,_._delayedOnError=h,_)}return i.d(t,e),Object.defineProperty(t.prototype,"noMipmap",{get:function(){return this._noMipmap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBlocking",{get:function(){return this._isBlocking},set:function(e){this._isBlocking=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"samplingMode",{get:function(){return this._texture?this._texture.samplingMode:this._initialSamplingMode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"invertY",{get:function(){return this._invertY},enumerable:!0,configurable:!0}),t.prototype.updateURL=function(e,t,r){void 0===t&&(t=null),this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(l.a.MATERIAL_TextureDirtyFlag)),this.url=e,this._buffer=t,this.delayLoadState=l.a.DELAYLOADSTATE_NOTLOADED,r&&(this._delayedOnLoad=r),this.delayLoad()},t.prototype.delayLoad=function(){if(this.delayLoadState===l.a.DELAYLOADSTATE_NOTLOADED){var e=this.getScene();e&&(this.delayLoadState=l.a.DELAYLOADSTATE_LOADED,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode),this._texture?this._delayedOnLoad&&(this._texture.isReady?s.h.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=e.getEngine().createTexture(this.url,this._noMipmap,this._invertY,e,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format),this._deleteBuffer&&delete this._buffer),this._delayedOnLoad=null,this._delayedOnError=null)}},t.prototype._prepareRowForTextureGeneration=function(e,t,r,i){e*=this.uScale,t*=this.vScale,e-=this.uRotationCenter*this.uScale,t-=this.vRotationCenter*this.vScale,r-=this.wRotationCenter,a.Vector3.TransformCoordinatesFromFloatsToRef(e,t,r,this._rowGenerationMatrix,i),i.x+=this.uRotationCenter*this.uScale+this.uOffset,i.y+=this.vRotationCenter*this.vScale+this.vOffset,i.z+=this.wRotationCenter},t.prototype.getTextureMatrix=function(){var e=this;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedTextureMatrix||(this._cachedTextureMatrix=a.Matrix.Zero(),this._rowGenerationMatrix=new a.Matrix,this._t0=a.Vector3.Zero(),this._t1=a.Vector3.Zero(),this._t2=a.Vector3.Zero()),a.Matrix.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),a.Matrix.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix);var t=this.getScene();return t?(t.markAllMaterialsAsDirty(l.a.MATERIAL_TextureDirtyFlag,function(t){return t.hasTexture(e)}),this._cachedTextureMatrix):this._cachedTextureMatrix},t.prototype.getReflectionTextureMatrix=function(){var e=this,r=this.getScene();if(!r)return this._cachedTextureMatrix;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale===this._cachedUScale&&this.vScale===this._cachedVScale&&this.coordinatesMode===this._cachedCoordinatesMode){if(this.coordinatesMode!==t.PROJECTION_MODE)return this._cachedTextureMatrix;if(this._cachedProjectionMatrixId===r.getProjectionMatrix().updateFlag)return this._cachedTextureMatrix}switch(this._cachedTextureMatrix||(this._cachedTextureMatrix=a.Matrix.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=a.Matrix.Zero()),this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale,this._cachedVScale=this.vScale,this._cachedCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case t.PLANAR_MODE:a.Matrix.IdentityToRef(this._cachedTextureMatrix),this._cachedTextureMatrix[0]=this.uScale,this._cachedTextureMatrix[5]=this.vScale,this._cachedTextureMatrix[12]=this.uOffset,this._cachedTextureMatrix[13]=this.vOffset;break;case t.PROJECTION_MODE:a.Matrix.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);var i=r.getProjectionMatrix();this._cachedProjectionMatrixId=i.updateFlag,i.multiplyToRef(this._projectionModeMatrix,this._cachedTextureMatrix);break;default:a.Matrix.IdentityToRef(this._cachedTextureMatrix)}return r.markAllMaterialsAsDirty(l.a.MATERIAL_TextureDirtyFlag,function(t){return-1!==t.getActiveTextures().indexOf(e)}),this._cachedTextureMatrix},t.prototype.clone=function(){var e=this;return n.a.Clone(function(){return new t(e._texture?e._texture.url:null,e.getScene(),e._noMipmap,e._invertY,e.samplingMode)},this)},t.prototype.serialize=function(){var t=e.prototype.serialize.call(this);return"string"==typeof this._buffer&&"data:"===this._buffer.substr(0,5)&&(t.base64String=this._buffer,t.name=t.name.replace("data:","")),t.invertY=this._invertY,t.samplingMode=this.samplingMode,t},t.prototype.getClassName=function(){return"Texture"},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null},t.Parse=function(e,r,i){if(e.customType){var o=s.h.Instantiate(e.customType).Parse(e,r,i);return e.samplingMode&&o.updateSamplingMode&&o._samplingMode&&o._samplingMode!==e.samplingMode&&o.updateSamplingMode(e.samplingMode),o}if(e.isCube&&!e.isRenderTarget)return t._CubeTextureParser(e,r,i);if(!e.name&&!e.isRenderTarget)return null;var u=n.a.Parse(function(){var n,o=!0;if(e.noMipmap&&(o=!1),e.mirrorPlane){var s=t._CreateMirror(e.name,e.renderTargetSize,r,o);return s._waitingRenderList=e.renderList,s.mirrorPlane=a.Plane.FromArray(e.mirrorPlane),s}if(e.isRenderTarget){var u=null;if(e.isCube){if(r.reflectionProbes)for(var l=0;l<r.reflectionProbes.length;l++){var c=r.reflectionProbes[l];if(c.name===e.name)return c.cubeTexture}}else(u=t._CreateRenderTargetTexture(e.name,e.renderTargetSize,r,o))._waitingRenderList=e.renderList;return u}if(e.base64String)n=t.CreateFromBase64String(e.base64String,e.name,r,!o);else{var h=i+e.name;t.UseSerializedUrlIfAny&&e.url&&(h=e.url),n=new t(h,r,!o,e.invertY)}return n},e,r);if(e.samplingMode){var l=e.samplingMode;u&&u.samplingMode!==l&&u.updateSamplingMode(l)}if(u&&e.animations)for(var c=0;c<e.animations.length;c++){var h=e.animations[c];u.animations.push(t._AnimationParser(h))}return u},t.CreateFromBase64String=function(e,r,i,n,o,s,a,u,c){return void 0===s&&(s=t.TRILINEAR_SAMPLINGMODE),void 0===a&&(a=null),void 0===u&&(u=null),void 0===c&&(c=l.a.TEXTUREFORMAT_RGBA),new t("data:"+r,i,n,o,s,a,u,e,!1,c)},t.LoadFromDataString=function(e,r,i,n,o,s,a,u,c,h){return void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===s&&(s=!0),void 0===a&&(a=t.TRILINEAR_SAMPLINGMODE),void 0===u&&(u=null),void 0===c&&(c=null),void 0===h&&(h=l.a.TEXTUREFORMAT_RGBA),"data:"!==e.substr(0,5)&&(e="data:"+e),new t(e,i,o,s,a,u,c,r,n,h)},t._AnimationParser=function(e){throw"Animation needs to be imported before being deserialized."},t._CubeTextureParser=function(e,t,r){throw"CubeTexture needs to be imported before being deserialized."},t._CreateMirror=function(e,t,r,i){throw"MirrorTexture needs to be imported before being deserialized."},t._CreateRenderTargetTexture=function(e,t,r,i){throw"RenderTargetTexture needs to be imported before being deserialized."},t.NEAREST_SAMPLINGMODE=l.a.TEXTURE_NEAREST_SAMPLINGMODE,t.NEAREST_NEAREST_MIPLINEAR=l.a.TEXTURE_NEAREST_NEAREST_MIPLINEAR,t.BILINEAR_SAMPLINGMODE=l.a.TEXTURE_BILINEAR_SAMPLINGMODE,t.LINEAR_LINEAR_MIPNEAREST=l.a.TEXTURE_LINEAR_LINEAR_MIPNEAREST,t.TRILINEAR_SAMPLINGMODE=l.a.TEXTURE_TRILINEAR_SAMPLINGMODE,t.LINEAR_LINEAR_MIPLINEAR=l.a.TEXTURE_LINEAR_LINEAR_MIPLINEAR,t.NEAREST_NEAREST_MIPNEAREST=l.a.TEXTURE_NEAREST_NEAREST_MIPNEAREST,t.NEAREST_LINEAR_MIPNEAREST=l.a.TEXTURE_NEAREST_LINEAR_MIPNEAREST,t.NEAREST_LINEAR_MIPLINEAR=l.a.TEXTURE_NEAREST_LINEAR_MIPLINEAR,t.NEAREST_LINEAR=l.a.TEXTURE_NEAREST_LINEAR,t.NEAREST_NEAREST=l.a.TEXTURE_NEAREST_NEAREST,t.LINEAR_NEAREST_MIPNEAREST=l.a.TEXTURE_LINEAR_NEAREST_MIPNEAREST,t.LINEAR_NEAREST_MIPLINEAR=l.a.TEXTURE_LINEAR_NEAREST_MIPLINEAR,t.LINEAR_LINEAR=l.a.TEXTURE_LINEAR_LINEAR,t.LINEAR_NEAREST=l.a.TEXTURE_LINEAR_NEAREST,t.EXPLICIT_MODE=l.a.TEXTURE_EXPLICIT_MODE,t.SPHERICAL_MODE=l.a.TEXTURE_SPHERICAL_MODE,t.PLANAR_MODE=l.a.TEXTURE_PLANAR_MODE,t.CUBIC_MODE=l.a.TEXTURE_CUBIC_MODE,t.PROJECTION_MODE=l.a.TEXTURE_PROJECTION_MODE,t.SKYBOX_MODE=l.a.TEXTURE_SKYBOX_MODE,t.INVCUBIC_MODE=l.a.TEXTURE_INVCUBIC_MODE,t.EQUIRECTANGULAR_MODE=l.a.TEXTURE_EQUIRECTANGULAR_MODE,t.FIXED_EQUIRECTANGULAR_MODE=l.a.TEXTURE_FIXED_EQUIRECTANGULAR_MODE,t.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=l.a.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE,t.CLAMP_ADDRESSMODE=l.a.TEXTURE_CLAMP_ADDRESSMODE,t.WRAP_ADDRESSMODE=l.a.TEXTURE_WRAP_ADDRESSMODE,t.MIRROR_ADDRESSMODE=l.a.TEXTURE_MIRROR_ADDRESSMODE,t.UseSerializedUrlIfAny=!1,i.c([Object(n.c)()],t.prototype,"url",void 0),i.c([Object(n.c)()],t.prototype,"uOffset",void 0),i.c([Object(n.c)()],t.prototype,"vOffset",void 0),i.c([Object(n.c)()],t.prototype,"uScale",void 0),i.c([Object(n.c)()],t.prototype,"vScale",void 0),i.c([Object(n.c)()],t.prototype,"uAng",void 0),i.c([Object(n.c)()],t.prototype,"vAng",void 0),i.c([Object(n.c)()],t.prototype,"wAng",void 0),i.c([Object(n.c)()],t.prototype,"uRotationCenter",void 0),i.c([Object(n.c)()],t.prototype,"vRotationCenter",void 0),i.c([Object(n.c)()],t.prototype,"wRotationCenter",void 0),i.c([Object(n.c)()],t.prototype,"isBlocking",null),t}(u.a);n.a._TextureParser=c.Parse},60:function(e,t,r){"use strict";r.d(t,"a",function(){return b});var i=r(1),n=r(2),o=r(9),s=r(36),a=r(101),u=r(19),l=r(0),c=r(3),h=r(40),f=r(8),p=r(76),d=r(90),_=r(17),g=r(6),m=r(20),T=r(4),E=(r(320),r(329),function(e){function t(){var t=e.call(this)||this;return t.PBR=!0,t.MAINUV1=!1,t.MAINUV2=!1,t.UV1=!1,t.UV2=!1,t.ALBEDO=!1,t.ALBEDODIRECTUV=0,t.VERTEXCOLOR=!1,t.AMBIENT=!1,t.AMBIENTDIRECTUV=0,t.AMBIENTINGRAYSCALE=!1,t.OPACITY=!1,t.VERTEXALPHA=!1,t.OPACITYDIRECTUV=0,t.OPACITYRGB=!1,t.ALPHATEST=!1,t.DEPTHPREPASS=!1,t.ALPHABLEND=!1,t.ALPHAFROMALBEDO=!1,t.ALPHATESTVALUE="0.5",t.SPECULAROVERALPHA=!1,t.RADIANCEOVERALPHA=!1,t.ALPHAFRESNEL=!1,t.LINEARALPHAFRESNEL=!1,t.PREMULTIPLYALPHA=!1,t.EMISSIVE=!1,t.EMISSIVEDIRECTUV=0,t.REFLECTIVITY=!1,t.REFLECTIVITYDIRECTUV=0,t.SPECULARTERM=!1,t.MICROSURFACEFROMREFLECTIVITYMAP=!1,t.MICROSURFACEAUTOMATIC=!1,t.LODBASEDMICROSFURACE=!1,t.MICROSURFACEMAP=!1,t.MICROSURFACEMAPDIRECTUV=0,t.METALLICWORKFLOW=!1,t.ROUGHNESSSTOREINMETALMAPALPHA=!1,t.ROUGHNESSSTOREINMETALMAPGREEN=!1,t.METALLNESSSTOREINMETALMAPBLUE=!1,t.AOSTOREINMETALMAPRED=!1,t.ENVIRONMENTBRDF=!1,t.NORMAL=!1,t.TANGENT=!1,t.BUMP=!1,t.BUMPDIRECTUV=0,t.OBJECTSPACE_NORMALMAP=!1,t.PARALLAX=!1,t.PARALLAXOCCLUSION=!1,t.NORMALXYSCALE=!0,t.LIGHTMAP=!1,t.LIGHTMAPDIRECTUV=0,t.USELIGHTMAPASSHADOWMAP=!1,t.GAMMALIGHTMAP=!1,t.REFLECTION=!1,t.REFLECTIONMAP_3D=!1,t.REFLECTIONMAP_SPHERICAL=!1,t.REFLECTIONMAP_PLANAR=!1,t.REFLECTIONMAP_CUBIC=!1,t.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,t.REFLECTIONMAP_PROJECTION=!1,t.REFLECTIONMAP_SKYBOX=!1,t.REFLECTIONMAP_SKYBOX_TRANSFORMED=!1,t.REFLECTIONMAP_EXPLICIT=!1,t.REFLECTIONMAP_EQUIRECTANGULAR=!1,t.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,t.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,t.INVERTCUBICMAP=!1,t.USESPHERICALFROMREFLECTIONMAP=!1,t.USESPHERICALINVERTEX=!1,t.REFLECTIONMAP_OPPOSITEZ=!1,t.LODINREFLECTIONALPHA=!1,t.GAMMAREFLECTION=!1,t.RGBDREFLECTION=!1,t.RADIANCEOCCLUSION=!1,t.HORIZONOCCLUSION=!1,t.REFRACTION=!1,t.REFRACTIONMAP_3D=!1,t.REFRACTIONMAP_OPPOSITEZ=!1,t.LODINREFRACTIONALPHA=!1,t.GAMMAREFRACTION=!1,t.RGBDREFRACTION=!1,t.LINKREFRACTIONTOTRANSPARENCY=!1,t.INSTANCES=!1,t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,t.BONETEXTURE=!1,t.NONUNIFORMSCALING=!1,t.MORPHTARGETS=!1,t.MORPHTARGETS_NORMAL=!1,t.MORPHTARGETS_TANGENT=!1,t.NUM_MORPH_INFLUENCERS=0,t.IMAGEPROCESSING=!1,t.VIGNETTE=!1,t.VIGNETTEBLENDMODEMULTIPLY=!1,t.VIGNETTEBLENDMODEOPAQUE=!1,t.TONEMAPPING=!1,t.TONEMAPPING_ACES=!1,t.CONTRAST=!1,t.COLORCURVES=!1,t.COLORGRADING=!1,t.COLORGRADING3D=!1,t.SAMPLER3DGREENDEPTH=!1,t.SAMPLER3DBGRMAP=!1,t.IMAGEPROCESSINGPOSTPROCESS=!1,t.EXPOSURE=!1,t.USEPHYSICALLIGHTFALLOFF=!1,t.USEGLTFLIGHTFALLOFF=!1,t.TWOSIDEDLIGHTING=!1,t.SHADOWFLOAT=!1,t.CLIPPLANE=!1,t.CLIPPLANE2=!1,t.CLIPPLANE3=!1,t.CLIPPLANE4=!1,t.POINTSIZE=!1,t.FOG=!1,t.LOGARITHMICDEPTH=!1,t.FORCENORMALFORWARD=!1,t.SPECULARAA=!1,t.UNLIT=!1,t.rebuild(),t}return i.d(t,e),t.prototype.reset=function(){e.prototype.reset.call(this),this.ALPHATESTVALUE="0.5",this.PBR=!0},t}(p.a)),b=function(e){function t(r,i){var n=e.call(this,r,i)||this;return n._directIntensity=1,n._emissiveIntensity=1,n._environmentIntensity=1,n._specularIntensity=1,n._lightingInfos=new l.Vector4(n._directIntensity,n._emissiveIntensity,n._environmentIntensity,n._specularIntensity),n._disableBumpMap=!1,n._ambientTextureStrength=1,n._ambientTextureImpactOnAnalyticalLights=t.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,n._ambientColor=new l.Color3(0,0,0),n._albedoColor=new l.Color3(1,1,1),n._reflectivityColor=new l.Color3(1,1,1),n._reflectionColor=new l.Color3(1,1,1),n._emissiveColor=new l.Color3(0,0,0),n._microSurface=.9,n._indexOfRefraction=.66,n._invertRefractionY=!1,n._linkRefractionWithTransparency=!1,n._useLightmapAsShadowmap=!1,n._useHorizonOcclusion=!0,n._useRadianceOcclusion=!0,n._useAlphaFromAlbedoTexture=!1,n._useSpecularOverAlpha=!0,n._useMicroSurfaceFromReflectivityMapAlpha=!1,n._useRoughnessFromMetallicTextureAlpha=!0,n._useRoughnessFromMetallicTextureGreen=!1,n._useMetallnessFromMetallicTextureBlue=!1,n._useAmbientOcclusionFromMetallicTextureRed=!1,n._useAmbientInGrayScale=!1,n._useAutoMicroSurfaceFromReflectivityMap=!1,n._lightFalloff=t.LIGHTFALLOFF_PHYSICAL,n._useRadianceOverAlpha=!0,n._useObjectSpaceNormalMap=!1,n._useParallax=!1,n._useParallaxOcclusion=!1,n._parallaxScaleBias=.05,n._disableLighting=!1,n._maxSimultaneousLights=4,n._invertNormalMapX=!1,n._invertNormalMapY=!1,n._twoSidedLighting=!1,n._alphaCutOff=.4,n._forceAlphaTest=!1,n._useAlphaFresnel=!1,n._useLinearAlphaFresnel=!1,n._transparencyMode=null,n._environmentBRDFTexture=null,n._forceIrradianceInFragment=!1,n._forceNormalForward=!1,n._enableSpecularAntiAliasing=!1,n._renderTargets=new s.a(16),n._globalAmbientColor=new l.Color3(0,0,0),n._unlit=!1,n._attachImageProcessingConfiguration(null),n.getRenderTargetTextures=function(){return n._renderTargets.reset(),m.a.ReflectionTextureEnabled&&n._reflectionTexture&&n._reflectionTexture.isRenderTarget&&n._renderTargets.push(n._reflectionTexture),m.a.RefractionTextureEnabled&&n._refractionTexture&&n._refractionTexture.isRenderTarget&&n._renderTargets.push(n._refractionTexture),n._renderTargets},n._environmentBRDFTexture=a.a.GetEnvironmentBRDFTexture(i),n}return i.d(t,e),t.prototype._attachImageProcessingConfiguration=function(e){var t=this;e!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),this._imageProcessingConfiguration=e||this.getScene().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add(function(){t._markAllSubMeshesAsImageProcessingDirty()})))},Object.defineProperty(t.prototype,"hasRenderTargetTextures",{get:function(){return!!(m.a.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget)||!!(m.a.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget)},enumerable:!0,configurable:!0}),t.prototype.getClassName=function(){return"PBRBaseMaterial"},Object.defineProperty(t.prototype,"useLogarithmicDepth",{get:function(){return this._useLogarithmicDepth},set:function(e){this._useLogarithmicDepth=e&&this.getScene().getEngine().getCaps().fragmentDepthSupported},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transparencyMode",{get:function(){return this._transparencyMode},set:function(e){this._transparencyMode!==e&&(this._transparencyMode=e,this._forceAlphaTest=e===t.PBRMATERIAL_ALPHATESTANDBLEND,this._markAllSubMeshesAsTexturesAndMiscDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_disableAlphaBlending",{get:function(){return this._linkRefractionWithTransparency||this._transparencyMode===t.PBRMATERIAL_OPAQUE||this._transparencyMode===t.PBRMATERIAL_ALPHATEST},enumerable:!0,configurable:!0}),t.prototype.needAlphaBlending=function(){return!this._disableAlphaBlending&&(this.alpha<1||null!=this._opacityTexture||this._shouldUseAlphaFromAlbedoTexture())},t.prototype.needAlphaBlendingForMesh=function(t){return!this._disableAlphaBlending&&e.prototype.needAlphaBlendingForMesh.call(this,t)},t.prototype.needAlphaTesting=function(){return!!this._forceAlphaTest||!this._linkRefractionWithTransparency&&(null!=this._albedoTexture&&this._albedoTexture.hasAlpha&&(null==this._transparencyMode||this._transparencyMode===t.PBRMATERIAL_ALPHATEST))},t.prototype._shouldUseAlphaFromAlbedoTexture=function(){return null!=this._albedoTexture&&this._albedoTexture.hasAlpha&&this._useAlphaFromAlbedoTexture&&this._transparencyMode!==t.PBRMATERIAL_OPAQUE},t.prototype.getAlphaTestTexture=function(){return this._albedoTexture},t.prototype.isReadyForSubMesh=function(e,t,r){if(t.effect&&this.isFrozen&&this._wasPreviouslyReady)return!0;t._materialDefines||(t._materialDefines=new E);var i=t._materialDefines;if(!this.checkReadyOnEveryCall&&t.effect&&i._renderId===this.getScene().getRenderId())return!0;var n=this.getScene(),s=n.getEngine();if(i._areTexturesDirty&&n.texturesEnabled){if(this._albedoTexture&&m.a.DiffuseTextureEnabled&&!this._albedoTexture.isReadyOrNotBlocking())return!1;if(this._ambientTexture&&m.a.AmbientTextureEnabled&&!this._ambientTexture.isReadyOrNotBlocking())return!1;if(this._opacityTexture&&m.a.OpacityTextureEnabled&&!this._opacityTexture.isReadyOrNotBlocking())return!1;var a=this._getReflectionTexture();if(a&&m.a.ReflectionTextureEnabled&&!a.isReadyOrNotBlocking())return!1;if(this._lightmapTexture&&m.a.LightmapTextureEnabled&&!this._lightmapTexture.isReadyOrNotBlocking())return!1;if(this._emissiveTexture&&m.a.EmissiveTextureEnabled&&!this._emissiveTexture.isReadyOrNotBlocking())return!1;if(m.a.SpecularTextureEnabled){if(this._metallicTexture){if(!this._metallicTexture.isReadyOrNotBlocking())return!1}else if(this._reflectivityTexture&&!this._reflectivityTexture.isReadyOrNotBlocking())return!1;if(this._microSurfaceTexture&&!this._microSurfaceTexture.isReadyOrNotBlocking())return!1}if(s.getCaps().standardDerivatives&&this._bumpTexture&&m.a.BumpTextureEnabled&&!this._disableBumpMap&&!this._bumpTexture.isReady())return!1;var u=this._getRefractionTexture();if(u&&m.a.RefractionTextureEnabled&&!u.isReadyOrNotBlocking())return!1;if(this._environmentBRDFTexture&&m.a.ReflectionTextureEnabled&&!this._environmentBRDFTexture.isReady())return!1}if(i._areImageProcessingDirty&&this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.isReady())return!1;s.getCaps().standardDerivatives||e.isVerticesDataPresent(c.b.NormalKind)||(e.createNormals(!0),o.a.Warn("PBRMaterial: Normals have been created for the mesh: "+e.name));var l=t.effect,h=this._prepareEffect(e,i,this.onCompiled,this.onError,r);return h&&(this.allowShaderHotSwapping&&l&&!h.isReady()?(h=l,i.markAsUnprocessed()):(n.resetCachedMaterial(),t.setEffect(h,i),this.buildUniformLayout())),!(!t.effect||!t.effect.isReady())&&(i._renderId=n.getRenderId(),this._wasPreviouslyReady=!0,!0)},t.prototype.isMetallicWorkflow=function(){return!(null==this._metallic&&null==this._roughness&&!this._metallicTexture)},t.prototype._prepareEffect=function(e,t,r,i,n,o){if(void 0===r&&(r=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),this._prepareDefines(e,t,n,o),!t.isDirty)return null;t.markAsProcessed();var s=this.getScene().getEngine(),a=new f.c,u=0;t.USESPHERICALINVERTEX&&a.addFallback(u++,"USESPHERICALINVERTEX"),t.FOG&&a.addFallback(u,"FOG"),t.SPECULARAA&&a.addFallback(u,"SPECULARAA"),t.POINTSIZE&&a.addFallback(u,"POINTSIZE"),t.LOGARITHMICDEPTH&&a.addFallback(u,"LOGARITHMICDEPTH"),t.PARALLAX&&a.addFallback(u,"PARALLAX"),t.PARALLAXOCCLUSION&&a.addFallback(u++,"PARALLAXOCCLUSION"),t.ENVIRONMENTBRDF&&a.addFallback(u++,"ENVIRONMENTBRDF"),t.TANGENT&&a.addFallback(u++,"TANGENT"),t.BUMP&&a.addFallback(u++,"BUMP"),u=_.a.HandleFallbacksForShadows(t,a,this._maxSimultaneousLights,u++),t.SPECULARTERM&&a.addFallback(u++,"SPECULARTERM"),t.USESPHERICALFROMREFLECTIONMAP&&a.addFallback(u++,"USESPHERICALFROMREFLECTIONMAP"),t.LIGHTMAP&&a.addFallback(u++,"LIGHTMAP"),t.NORMAL&&a.addFallback(u++,"NORMAL"),t.AMBIENT&&a.addFallback(u++,"AMBIENT"),t.EMISSIVE&&a.addFallback(u++,"EMISSIVE"),t.VERTEXCOLOR&&a.addFallback(u++,"VERTEXCOLOR"),t.NUM_BONE_INFLUENCERS>0&&a.addCPUSkinningFallback(u++,e),t.MORPHTARGETS&&a.addFallback(u++,"MORPHTARGETS");var l=[c.b.PositionKind];t.NORMAL&&l.push(c.b.NormalKind),t.TANGENT&&l.push(c.b.TangentKind),t.UV1&&l.push(c.b.UVKind),t.UV2&&l.push(c.b.UV2Kind),t.VERTEXCOLOR&&l.push(c.b.ColorKind),_.a.PrepareAttributesForBones(l,e,t,a),_.a.PrepareAttributesForInstances(l,t),_.a.PrepareAttributesForMorphTargets(l,e,t);var p=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vAlbedoColor","vReflectivityColor","vEmissiveColor","vReflectionColor","vFogInfos","vFogColor","pointSize","vAlbedoInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vReflectionPosition","vReflectionSize","vEmissiveInfos","vReflectivityInfos","vMicroSurfaceSamplerInfos","vBumpInfos","vLightmapInfos","vRefractionInfos","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","albedoMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","reflectivityMatrix","normalMatrix","microSurfaceSamplerMatrix","bumpMatrix","lightmapMatrix","refractionMatrix","vLightingIntensity","logarithmicDepthConstant","vSphericalX","vSphericalY","vSphericalZ","vSphericalXX","vSphericalYY","vSphericalZZ","vSphericalXY","vSphericalYZ","vSphericalZX","vReflectionMicrosurfaceInfos","vRefractionMicrosurfaceInfos","vTangentSpaceParams","boneTextureWidth"],d=["albedoSampler","reflectivitySampler","ambientSampler","emissiveSampler","bumpSampler","lightmapSampler","opacitySampler","refractionSampler","refractionSamplerLow","refractionSamplerHigh","reflectionSampler","reflectionSamplerLow","reflectionSamplerHigh","microSurfaceSampler","environmentBrdfSampler","boneSampler"],g=["Material","Scene"];h.a&&(h.a.PrepareUniforms(p,t),h.a.PrepareSamplers(d,t)),_.a.PrepareUniformsAndSamplersList({uniformsNames:p,uniformBuffersNames:g,samplers:d,defines:t,maxSimultaneousLights:this._maxSimultaneousLights});var m=t.toString();return s.createEffect("pbr",{attributes:l,uniformsNames:p,uniformBuffersNames:g,samplers:d,defines:m,fallbacks:a,onCompiled:r,onError:i,indexParameters:{maxSimultaneousLights:this._maxSimultaneousLights,maxSimultaneousMorphTargets:t.NUM_MORPH_INFLUENCERS}},s)},t.prototype._prepareDefines=function(e,r,i,n){void 0===i&&(i=null),void 0===n&&(n=null);var o=this.getScene(),s=o.getEngine();if(_.a.PrepareDefinesForLights(o,e,r,!0,this._maxSimultaneousLights,this._disableLighting),r._needNormals=!0,r.METALLICWORKFLOW=this.isMetallicWorkflow(),r._areTexturesDirty){if(r._needUVs=!1,o.texturesEnabled){o.getEngine().getCaps().textureLOD&&(r.LODBASEDMICROSFURACE=!0),this._albedoTexture&&m.a.DiffuseTextureEnabled?_.a.PrepareDefinesForMergedUV(this._albedoTexture,r,"ALBEDO"):r.ALBEDO=!1,this._ambientTexture&&m.a.AmbientTextureEnabled?(_.a.PrepareDefinesForMergedUV(this._ambientTexture,r,"AMBIENT"),r.AMBIENTINGRAYSCALE=this._useAmbientInGrayScale):r.AMBIENT=!1,this._opacityTexture&&m.a.OpacityTextureEnabled?(_.a.PrepareDefinesForMergedUV(this._opacityTexture,r,"OPACITY"),r.OPACITYRGB=this._opacityTexture.getAlphaFromRGB):r.OPACITY=!1;var a=this._getReflectionTexture();if(a&&m.a.ReflectionTextureEnabled){switch(r.REFLECTION=!0,r.GAMMAREFLECTION=a.gammaSpace,r.RGBDREFLECTION=a.isRGBD,r.REFLECTIONMAP_OPPOSITEZ=this.getScene().useRightHandedSystem?!a.invertZ:a.invertZ,r.LODINREFLECTIONALPHA=a.lodLevelInAlpha,a.coordinatesMode===g.a.INVCUBIC_MODE&&(r.INVERTCUBICMAP=!0),r.REFLECTIONMAP_3D=a.isCube,r.REFLECTIONMAP_CUBIC=!1,r.REFLECTIONMAP_EXPLICIT=!1,r.REFLECTIONMAP_PLANAR=!1,r.REFLECTIONMAP_PROJECTION=!1,r.REFLECTIONMAP_SKYBOX=!1,r.REFLECTIONMAP_SPHERICAL=!1,r.REFLECTIONMAP_EQUIRECTANGULAR=!1,r.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,r.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,r.REFLECTIONMAP_SKYBOX_TRANSFORMED=!1,a.coordinatesMode){case g.a.EXPLICIT_MODE:r.REFLECTIONMAP_EXPLICIT=!0;break;case g.a.PLANAR_MODE:r.REFLECTIONMAP_PLANAR=!0;break;case g.a.PROJECTION_MODE:r.REFLECTIONMAP_PROJECTION=!0;break;case g.a.SKYBOX_MODE:r.REFLECTIONMAP_SKYBOX=!0;break;case g.a.SPHERICAL_MODE:r.REFLECTIONMAP_SPHERICAL=!0;break;case g.a.EQUIRECTANGULAR_MODE:r.REFLECTIONMAP_EQUIRECTANGULAR=!0;break;case g.a.FIXED_EQUIRECTANGULAR_MODE:r.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!0;break;case g.a.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:r.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!0;break;case g.a.CUBIC_MODE:case g.a.INVCUBIC_MODE:default:r.REFLECTIONMAP_CUBIC=!0,r.USE_LOCAL_REFLECTIONMAP_CUBIC=!!a.boundingBoxSize}a.coordinatesMode!==g.a.SKYBOX_MODE?a.sphericalPolynomial&&(r.USESPHERICALFROMREFLECTIONMAP=!0,this._forceIrradianceInFragment||o.getEngine().getCaps().maxVaryingVectors<=8?r.USESPHERICALINVERTEX=!1:r.USESPHERICALINVERTEX=!0):r.REFLECTIONMAP_SKYBOX_TRANSFORMED=!a.getReflectionTextureMatrix().isIdentity()}else r.REFLECTION=!1,r.REFLECTIONMAP_3D=!1,r.REFLECTIONMAP_SPHERICAL=!1,r.REFLECTIONMAP_PLANAR=!1,r.REFLECTIONMAP_CUBIC=!1,r.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,r.REFLECTIONMAP_PROJECTION=!1,r.REFLECTIONMAP_SKYBOX=!1,r.REFLECTIONMAP_SKYBOX_TRANSFORMED=!1,r.REFLECTIONMAP_EXPLICIT=!1,r.REFLECTIONMAP_EQUIRECTANGULAR=!1,r.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,r.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,r.INVERTCUBICMAP=!1,r.USESPHERICALFROMREFLECTIONMAP=!1,r.USESPHERICALINVERTEX=!1,r.REFLECTIONMAP_OPPOSITEZ=!1,r.LODINREFLECTIONALPHA=!1,r.GAMMAREFLECTION=!1,r.RGBDREFLECTION=!1;this._lightmapTexture&&m.a.LightmapTextureEnabled?(_.a.PrepareDefinesForMergedUV(this._lightmapTexture,r,"LIGHTMAP"),r.USELIGHTMAPASSHADOWMAP=this._useLightmapAsShadowmap,r.GAMMALIGHTMAP=this._lightmapTexture.gammaSpace):r.LIGHTMAP=!1,this._emissiveTexture&&m.a.EmissiveTextureEnabled?_.a.PrepareDefinesForMergedUV(this._emissiveTexture,r,"EMISSIVE"):r.EMISSIVE=!1,m.a.SpecularTextureEnabled?(this._metallicTexture?(_.a.PrepareDefinesForMergedUV(this._metallicTexture,r,"REFLECTIVITY"),r.ROUGHNESSSTOREINMETALMAPALPHA=this._useRoughnessFromMetallicTextureAlpha,r.ROUGHNESSSTOREINMETALMAPGREEN=!this._useRoughnessFromMetallicTextureAlpha&&this._useRoughnessFromMetallicTextureGreen,r.METALLNESSSTOREINMETALMAPBLUE=this._useMetallnessFromMetallicTextureBlue,r.AOSTOREINMETALMAPRED=this._useAmbientOcclusionFromMetallicTextureRed):this._reflectivityTexture?(_.a.PrepareDefinesForMergedUV(this._reflectivityTexture,r,"REFLECTIVITY"),r.MICROSURFACEFROMREFLECTIVITYMAP=this._useMicroSurfaceFromReflectivityMapAlpha,r.MICROSURFACEAUTOMATIC=this._useAutoMicroSurfaceFromReflectivityMap):r.REFLECTIVITY=!1,this._microSurfaceTexture?_.a.PrepareDefinesForMergedUV(this._microSurfaceTexture,r,"MICROSURFACEMAP"):r.MICROSURFACEMAP=!1):(r.REFLECTIVITY=!1,r.MICROSURFACEMAP=!1),o.getEngine().getCaps().standardDerivatives&&this._bumpTexture&&m.a.BumpTextureEnabled&&!this._disableBumpMap?(_.a.PrepareDefinesForMergedUV(this._bumpTexture,r,"BUMP"),this._useParallax&&this._albedoTexture&&m.a.DiffuseTextureEnabled?(r.PARALLAX=!0,r.PARALLAXOCCLUSION=!!this._useParallaxOcclusion):r.PARALLAX=!1,r.OBJECTSPACE_NORMALMAP=this._useObjectSpaceNormalMap):r.BUMP=!1;var u=this._getRefractionTexture();u&&m.a.RefractionTextureEnabled?(r.REFRACTION=!0,r.REFRACTIONMAP_3D=u.isCube,r.GAMMAREFRACTION=u.gammaSpace,r.RGBDREFRACTION=u.isRGBD,r.REFRACTIONMAP_OPPOSITEZ=u.invertZ,r.LODINREFRACTIONALPHA=u.lodLevelInAlpha,this._linkRefractionWithTransparency&&(r.LINKREFRACTIONTOTRANSPARENCY=!0)):r.REFRACTION=!1,this._environmentBRDFTexture&&m.a.ReflectionTextureEnabled?r.ENVIRONMENTBRDF=!0:r.ENVIRONMENTBRDF=!1,this._shouldUseAlphaFromAlbedoTexture()?r.ALPHAFROMALBEDO=!0:r.ALPHAFROMALBEDO=!1}r.SPECULAROVERALPHA=this._useSpecularOverAlpha,this._lightFalloff===t.LIGHTFALLOFF_STANDARD?(r.USEPHYSICALLIGHTFALLOFF=!1,r.USEGLTFLIGHTFALLOFF=!1):this._lightFalloff===t.LIGHTFALLOFF_GLTF?(r.USEPHYSICALLIGHTFALLOFF=!1,r.USEGLTFLIGHTFALLOFF=!0):(r.USEPHYSICALLIGHTFALLOFF=!0,r.USEGLTFLIGHTFALLOFF=!1),r.RADIANCEOVERALPHA=this._useRadianceOverAlpha,!this.backFaceCulling&&this._twoSidedLighting?r.TWOSIDEDLIGHTING=!0:r.TWOSIDEDLIGHTING=!1,r.ALPHATESTVALUE=this._alphaCutOff+(this._alphaCutOff%1==0?".":""),r.PREMULTIPLYALPHA=this.alphaMode===T.a.ALPHA_PREMULTIPLIED||this.alphaMode===T.a.ALPHA_PREMULTIPLIED_PORTERDUFF,r.ALPHABLEND=this.needAlphaBlendingForMesh(e),r.ALPHAFRESNEL=this._useAlphaFresnel||this._useLinearAlphaFresnel,r.LINEARALPHAFRESNEL=this._useLinearAlphaFresnel,r.SPECULARAA=o.getEngine().getCaps().standardDerivatives&&this._enableSpecularAntiAliasing}r._areImageProcessingDirty&&this._imageProcessingConfiguration&&this._imageProcessingConfiguration.prepareDefines(r),r.FORCENORMALFORWARD=this._forceNormalForward,r.RADIANCEOCCLUSION=this._useRadianceOcclusion,r.HORIZONOCCLUSION=this._useHorizonOcclusion,r._areMiscDirty&&(_.a.PrepareDefinesForMisc(e,o,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e)||this._forceAlphaTest,r),r.UNLIT=this._unlit||(this.pointsCloud||this.wireframe)&&!e.isVerticesDataPresent(c.b.NormalKind)),_.a.PrepareDefinesForFrameBoundValues(o,s,r,!!i,n),_.a.PrepareDefinesForAttributes(e,r,!0,!0,!0,this._transparencyMode!==t.PBRMATERIAL_OPAQUE)},t.prototype.forceCompilation=function(e,t,r){var n=this,o=i.a({clipPlane:!1},r),s=new E,a=this._prepareEffect(e,s,void 0,void 0,void 0,o.clipPlane);a.isReady()?t&&t(this):a.onCompileObservable.add(function(){t&&t(n)})},t.prototype.buildUniformLayout=function(){this._uniformBuffer.addUniform("vAlbedoInfos",2),this._uniformBuffer.addUniform("vAmbientInfos",4),this._uniformBuffer.addUniform("vOpacityInfos",2),this._uniformBuffer.addUniform("vEmissiveInfos",2),this._uniformBuffer.addUniform("vLightmapInfos",2),this._uniformBuffer.addUniform("vReflectivityInfos",3),this._uniformBuffer.addUniform("vMicroSurfaceSamplerInfos",2),this._uniformBuffer.addUniform("vRefractionInfos",4),this._uniformBuffer.addUniform("vReflectionInfos",2),this._uniformBuffer.addUniform("vReflectionPosition",3),this._uniformBuffer.addUniform("vReflectionSize",3),this._uniformBuffer.addUniform("vBumpInfos",3),this._uniformBuffer.addUniform("albedoMatrix",16),this._uniformBuffer.addUniform("ambientMatrix",16),this._uniformBuffer.addUniform("opacityMatrix",16),this._uniformBuffer.addUniform("emissiveMatrix",16),this._uniformBuffer.addUniform("lightmapMatrix",16),this._uniformBuffer.addUniform("reflectivityMatrix",16),this._uniformBuffer.addUniform("microSurfaceSamplerMatrix",16),this._uniformBuffer.addUniform("bumpMatrix",16),this._uniformBuffer.addUniform("vTangentSpaceParams",2),this._uniformBuffer.addUniform("refractionMatrix",16),this._uniformBuffer.addUniform("reflectionMatrix",16),this._uniformBuffer.addUniform("vReflectionColor",3),this._uniformBuffer.addUniform("vAlbedoColor",4),this._uniformBuffer.addUniform("vLightingIntensity",4),this._uniformBuffer.addUniform("vRefractionMicrosurfaceInfos",3),this._uniformBuffer.addUniform("vReflectionMicrosurfaceInfos",3),this._uniformBuffer.addUniform("vReflectivityColor",4),this._uniformBuffer.addUniform("vEmissiveColor",3),this._uniformBuffer.addUniform("pointSize",1),this._uniformBuffer.create()},t.prototype.unbind=function(){this._reflectionTexture&&this._reflectionTexture.isRenderTarget&&this._uniformBuffer.setTexture("reflectionSampler",null),this._refractionTexture&&this._refractionTexture.isRenderTarget&&this._uniformBuffer.setTexture("refractionSampler",null),e.prototype.unbind.call(this)},t.prototype.bindForSubMesh=function(e,r,i){var n=this.getScene(),o=i._materialDefines;if(o){var s=i.effect;if(s){this._activeEffect=s,this.bindOnlyWorldMatrix(e),o.OBJECTSPACE_NORMALMAP&&(e.toNormalMatrix(this._normalMatrix),this.bindOnlyNormalMatrix(this._normalMatrix));var a=this._mustRebind(n,s,r.visibility);_.a.BindBonesParameters(r,this._activeEffect);var c=null;if(a){this._uniformBuffer.bindToEffect(s,"Material"),this.bindViewProjection(s),c=this._getReflectionTexture();var h=this._getRefractionTexture();if(!this._uniformBuffer.useUbo||!this.isFrozen||!this._uniformBuffer.isSync){if(n.texturesEnabled){if(this._albedoTexture&&m.a.DiffuseTextureEnabled&&(this._uniformBuffer.updateFloat2("vAlbedoInfos",this._albedoTexture.coordinatesIndex,this._albedoTexture.level),_.a.BindTextureMatrix(this._albedoTexture,this._uniformBuffer,"albedo")),this._ambientTexture&&m.a.AmbientTextureEnabled&&(this._uniformBuffer.updateFloat4("vAmbientInfos",this._ambientTexture.coordinatesIndex,this._ambientTexture.level,this._ambientTextureStrength,this._ambientTextureImpactOnAnalyticalLights),_.a.BindTextureMatrix(this._ambientTexture,this._uniformBuffer,"ambient")),this._opacityTexture&&m.a.OpacityTextureEnabled&&(this._uniformBuffer.updateFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,this._opacityTexture.level),_.a.BindTextureMatrix(this._opacityTexture,this._uniformBuffer,"opacity")),c&&m.a.ReflectionTextureEnabled){if(this._uniformBuffer.updateMatrix("reflectionMatrix",c.getReflectionTextureMatrix()),this._uniformBuffer.updateFloat2("vReflectionInfos",c.level,0),c.boundingBoxSize){var f=c;this._uniformBuffer.updateVector3("vReflectionPosition",f.boundingBoxPosition),this._uniformBuffer.updateVector3("vReflectionSize",f.boundingBoxSize)}var p=c.sphericalPolynomial;o.USESPHERICALFROMREFLECTIONMAP&&p&&(this._activeEffect.setFloat3("vSphericalX",p.x.x,p.x.y,p.x.z),this._activeEffect.setFloat3("vSphericalY",p.y.x,p.y.y,p.y.z),this._activeEffect.setFloat3("vSphericalZ",p.z.x,p.z.y,p.z.z),this._activeEffect.setFloat3("vSphericalXX_ZZ",p.xx.x-p.zz.x,p.xx.y-p.zz.y,p.xx.z-p.zz.z),this._activeEffect.setFloat3("vSphericalYY_ZZ",p.yy.x-p.zz.x,p.yy.y-p.zz.y,p.yy.z-p.zz.z),this._activeEffect.setFloat3("vSphericalZZ",p.zz.x,p.zz.y,p.zz.z),this._activeEffect.setFloat3("vSphericalXY",p.xy.x,p.xy.y,p.xy.z),this._activeEffect.setFloat3("vSphericalYZ",p.yz.x,p.yz.y,p.yz.z),this._activeEffect.setFloat3("vSphericalZX",p.zx.x,p.zx.y,p.zx.z)),this._uniformBuffer.updateFloat3("vReflectionMicrosurfaceInfos",c.getSize().width,c.lodGenerationScale,c.lodGenerationOffset)}if(this._emissiveTexture&&m.a.EmissiveTextureEnabled&&(this._uniformBuffer.updateFloat2("vEmissiveInfos",this._emissiveTexture.coordinatesIndex,this._emissiveTexture.level),_.a.BindTextureMatrix(this._emissiveTexture,this._uniformBuffer,"emissive")),this._lightmapTexture&&m.a.LightmapTextureEnabled&&(this._uniformBuffer.updateFloat2("vLightmapInfos",this._lightmapTexture.coordinatesIndex,this._lightmapTexture.level),_.a.BindTextureMatrix(this._lightmapTexture,this._uniformBuffer,"lightmap")),m.a.SpecularTextureEnabled&&(this._metallicTexture?(this._uniformBuffer.updateFloat3("vReflectivityInfos",this._metallicTexture.coordinatesIndex,this._metallicTexture.level,this._ambientTextureStrength),_.a.BindTextureMatrix(this._metallicTexture,this._uniformBuffer,"reflectivity")):this._reflectivityTexture&&(this._uniformBuffer.updateFloat3("vReflectivityInfos",this._reflectivityTexture.coordinatesIndex,this._reflectivityTexture.level,1),_.a.BindTextureMatrix(this._reflectivityTexture,this._uniformBuffer,"reflectivity")),this._microSurfaceTexture&&(this._uniformBuffer.updateFloat2("vMicroSurfaceSamplerInfos",this._microSurfaceTexture.coordinatesIndex,this._microSurfaceTexture.level),_.a.BindTextureMatrix(this._microSurfaceTexture,this._uniformBuffer,"microSurfaceSampler"))),this._bumpTexture&&n.getEngine().getCaps().standardDerivatives&&m.a.BumpTextureEnabled&&!this._disableBumpMap&&(this._uniformBuffer.updateFloat3("vBumpInfos",this._bumpTexture.coordinatesIndex,this._bumpTexture.level,this._parallaxScaleBias),_.a.BindTextureMatrix(this._bumpTexture,this._uniformBuffer,"bump"),n._mirroredCameraPosition?this._uniformBuffer.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?1:-1,this._invertNormalMapY?1:-1):this._uniformBuffer.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?-1:1,this._invertNormalMapY?-1:1)),h&&m.a.RefractionTextureEnabled){this._uniformBuffer.updateMatrix("refractionMatrix",h.getReflectionTextureMatrix());var d=1;h.isCube||h.depth&&(d=h.depth),this._uniformBuffer.updateFloat4("vRefractionInfos",h.level,this._indexOfRefraction,d,this._invertRefractionY?-1:1),this._uniformBuffer.updateFloat3("vRefractionMicrosurfaceInfos",h.getSize().width,h.lodGenerationScale,h.lodGenerationOffset)}}this.pointsCloud&&this._uniformBuffer.updateFloat("pointSize",this.pointSize),o.METALLICWORKFLOW?(l.Tmp.Color3[0].r=void 0===this._metallic||null===this._metallic?1:this._metallic,l.Tmp.Color3[0].g=void 0===this._roughness||null===this._roughness?1:this._roughness,this._uniformBuffer.updateColor4("vReflectivityColor",l.Tmp.Color3[0],0)):this._uniformBuffer.updateColor4("vReflectivityColor",this._reflectivityColor,this._microSurface),this._uniformBuffer.updateColor3("vEmissiveColor",m.a.EmissiveTextureEnabled?this._emissiveColor:l.Color3.BlackReadOnly),this._uniformBuffer.updateColor3("vReflectionColor",this._reflectionColor),this._uniformBuffer.updateColor4("vAlbedoColor",this._albedoColor,this.alpha*r.visibility),this._lightingInfos.x=this._directIntensity,this._lightingInfos.y=this._emissiveIntensity,this._lightingInfos.z=this._environmentIntensity,this._lightingInfos.w=this._specularIntensity,this._uniformBuffer.updateVector4("vLightingIntensity",this._lightingInfos)}n.texturesEnabled&&(this._albedoTexture&&m.a.DiffuseTextureEnabled&&this._uniformBuffer.setTexture("albedoSampler",this._albedoTexture),this._ambientTexture&&m.a.AmbientTextureEnabled&&this._uniformBuffer.setTexture("ambientSampler",this._ambientTexture),this._opacityTexture&&m.a.OpacityTextureEnabled&&this._uniformBuffer.setTexture("opacitySampler",this._opacityTexture),c&&m.a.ReflectionTextureEnabled&&(o.LODBASEDMICROSFURACE?this._uniformBuffer.setTexture("reflectionSampler",c):(this._uniformBuffer.setTexture("reflectionSampler",c._lodTextureMid||c),this._uniformBuffer.setTexture("reflectionSamplerLow",c._lodTextureLow||c),this._uniformBuffer.setTexture("reflectionSamplerHigh",c._lodTextureHigh||c))),o.ENVIRONMENTBRDF&&this._uniformBuffer.setTexture("environmentBrdfSampler",this._environmentBRDFTexture),h&&m.a.RefractionTextureEnabled&&(o.LODBASEDMICROSFURACE?this._uniformBuffer.setTexture("refractionSampler",h):(this._uniformBuffer.setTexture("refractionSampler",h._lodTextureMid||h),this._uniformBuffer.setTexture("refractionSamplerLow",h._lodTextureLow||h),this._uniformBuffer.setTexture("refractionSamplerHigh",h._lodTextureHigh||h))),this._emissiveTexture&&m.a.EmissiveTextureEnabled&&this._uniformBuffer.setTexture("emissiveSampler",this._emissiveTexture),this._lightmapTexture&&m.a.LightmapTextureEnabled&&this._uniformBuffer.setTexture("lightmapSampler",this._lightmapTexture),m.a.SpecularTextureEnabled&&(this._metallicTexture?this._uniformBuffer.setTexture("reflectivitySampler",this._metallicTexture):this._reflectivityTexture&&this._uniformBuffer.setTexture("reflectivitySampler",this._reflectivityTexture),this._microSurfaceTexture&&this._uniformBuffer.setTexture("microSurfaceSampler",this._microSurfaceTexture)),this._bumpTexture&&n.getEngine().getCaps().standardDerivatives&&m.a.BumpTextureEnabled&&!this._disableBumpMap&&this._uniformBuffer.setTexture("bumpSampler",this._bumpTexture)),_.a.BindClipPlane(this._activeEffect,n),n.ambientColor.multiplyToRef(this._ambientColor,this._globalAmbientColor);var g=n._forcedViewPosition?n._forcedViewPosition:n._mirroredCameraPosition?n._mirroredCameraPosition:n.activeCamera.globalPosition,T=n.useRightHandedSystem===(null!=n._mirroredCameraPosition);s.setFloat4("vEyePosition",g.x,g.y,g.z,T?-1:1),s.setColor3("vAmbientColor",this._globalAmbientColor)}!a&&this.isFrozen||(n.lightsEnabled&&!this._disableLighting&&_.a.BindLights(n,r,this._activeEffect,o,this._maxSimultaneousLights,this._lightFalloff!==t.LIGHTFALLOFF_STANDARD),(n.fogEnabled&&r.applyFog&&n.fogMode!==u.Scene.FOGMODE_NONE||c)&&this.bindView(s),_.a.BindFogParameters(n,r,this._activeEffect,!0),o.NUM_MORPH_INFLUENCERS&&_.a.BindMorphTargetParameters(r,this._activeEffect),this._imageProcessingConfiguration.bind(this._activeEffect),_.a.BindLogDepth(o,this._activeEffect,n)),this._uniformBuffer.update(),this._afterBind(r,this._activeEffect)}}},t.prototype.getAnimatables=function(){var e=[];return this._albedoTexture&&this._albedoTexture.animations&&this._albedoTexture.animations.length>0&&e.push(this._albedoTexture),this._ambientTexture&&this._ambientTexture.animations&&this._ambientTexture.animations.length>0&&e.push(this._ambientTexture),this._opacityTexture&&this._opacityTexture.animations&&this._opacityTexture.animations.length>0&&e.push(this._opacityTexture),this._reflectionTexture&&this._reflectionTexture.animations&&this._reflectionTexture.animations.length>0&&e.push(this._reflectionTexture),this._emissiveTexture&&this._emissiveTexture.animations&&this._emissiveTexture.animations.length>0&&e.push(this._emissiveTexture),this._metallicTexture&&this._metallicTexture.animations&&this._metallicTexture.animations.length>0?e.push(this._metallicTexture):this._reflectivityTexture&&this._reflectivityTexture.animations&&this._reflectivityTexture.animations.length>0&&e.push(this._reflectivityTexture),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&e.push(this._bumpTexture),this._lightmapTexture&&this._lightmapTexture.animations&&this._lightmapTexture.animations.length>0&&e.push(this._lightmapTexture),this._refractionTexture&&this._refractionTexture.animations&&this._refractionTexture.animations.length>0&&e.push(this._refractionTexture),e},t.prototype._getReflectionTexture=function(){return this._reflectionTexture?this._reflectionTexture:this.getScene().environmentTexture},t.prototype._getRefractionTexture=function(){return this._refractionTexture?this._refractionTexture:this._linkRefractionWithTransparency?this.getScene().environmentTexture:null},t.prototype.dispose=function(t,r){r&&(this._albedoTexture&&this._albedoTexture.dispose(),this._ambientTexture&&this._ambientTexture.dispose(),this._opacityTexture&&this._opacityTexture.dispose(),this._reflectionTexture&&this._reflectionTexture.dispose(),this._environmentBRDFTexture&&this.getScene()._environmentBRDFTexture!==this._environmentBRDFTexture&&this._environmentBRDFTexture.dispose(),this._emissiveTexture&&this._emissiveTexture.dispose(),this._metallicTexture&&this._metallicTexture.dispose(),this._reflectivityTexture&&this._reflectivityTexture.dispose(),this._bumpTexture&&this._bumpTexture.dispose(),this._lightmapTexture&&this._lightmapTexture.dispose(),this._refractionTexture&&this._refractionTexture.dispose()),this._renderTargets.dispose(),this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),e.prototype.dispose.call(this,t,r)},t.PBRMATERIAL_OPAQUE=0,t.PBRMATERIAL_ALPHATEST=1,t.PBRMATERIAL_ALPHABLEND=2,t.PBRMATERIAL_ALPHATESTANDBLEND=3,t.DEFAULT_AO_ON_ANALYTICAL_LIGHTS=1,t.LIGHTFALLOFF_PHYSICAL=0,t.LIGHTFALLOFF_GLTF=1,t.LIGHTFALLOFF_STANDARD=2,i.c([Object(n.i)()],t.prototype,"_imageProcessingConfiguration",void 0),i.c([Object(n.c)()],t.prototype,"useLogarithmicDepth",null),i.c([Object(n.c)()],t.prototype,"transparencyMode",null),t}(d.a)},66:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var i=r(4),n=function(){function e(){}return Object.defineProperty(e,"ForceFullSceneLoadingForIncremental",{get:function(){return e._ForceFullSceneLoadingForIncremental},set:function(t){e._ForceFullSceneLoadingForIncremental=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ShowLoadingScreen",{get:function(){return e._ShowLoadingScreen},set:function(t){e._ShowLoadingScreen=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loggingLevel",{get:function(){return e._loggingLevel},set:function(t){e._loggingLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CleanBoneMatrixWeights",{get:function(){return e._CleanBoneMatrixWeights},set:function(t){e._CleanBoneMatrixWeights=t},enumerable:!0,configurable:!0}),e._ForceFullSceneLoadingForIncremental=!1,e._ShowLoadingScreen=!0,e._CleanBoneMatrixWeights=!1,e._loggingLevel=i.a.SCENELOADER_NO_LOGGING,e}()},72:function(e,t,r){"use strict";r.d(t,"a",function(){return s});var i=r(1),n=r(6),o=r(4),s=function(e){function t(t,r,i,s,a,u,l,c,h){void 0===u&&(u=!0),void 0===l&&(l=!1),void 0===c&&(c=o.a.TEXTURE_TRILINEAR_SAMPLINGMODE),void 0===h&&(h=o.a.TEXTURETYPE_UNSIGNED_INT);var f=e.call(this,null,a,!u,l)||this;return f.format=s,f._engine=a.getEngine(),f._texture=a.getEngine().createRawTexture(t,r,i,s,u,l,c,null,h),f.wrapU=n.a.CLAMP_ADDRESSMODE,f.wrapV=n.a.CLAMP_ADDRESSMODE,f}return i.d(t,e),t.prototype.update=function(e){this._engine.updateRawTexture(this._texture,e,this._texture.format,this._texture.invertY,void 0,this._texture.type)},t.CreateLuminanceTexture=function(e,r,i,n,s,a,u){return void 0===s&&(s=!0),void 0===a&&(a=!1),void 0===u&&(u=o.a.TEXTURE_TRILINEAR_SAMPLINGMODE),new t(e,r,i,o.a.TEXTUREFORMAT_LUMINANCE,n,s,a,u)},t.CreateLuminanceAlphaTexture=function(e,r,i,n,s,a,u){return void 0===s&&(s=!0),void 0===a&&(a=!1),void 0===u&&(u=o.a.TEXTURE_TRILINEAR_SAMPLINGMODE),new t(e,r,i,o.a.TEXTUREFORMAT_LUMINANCE_ALPHA,n,s,a,u)},t.CreateAlphaTexture=function(e,r,i,n,s,a,u){return void 0===s&&(s=!0),void 0===a&&(a=!1),void 0===u&&(u=o.a.TEXTURE_TRILINEAR_SAMPLINGMODE),new t(e,r,i,o.a.TEXTUREFORMAT_ALPHA,n,s,a,u)},t.CreateRGBTexture=function(e,r,i,n,s,a,u,l){return void 0===s&&(s=!0),void 0===a&&(a=!1),void 0===u&&(u=o.a.TEXTURE_TRILINEAR_SAMPLINGMODE),void 0===l&&(l=o.a.TEXTURETYPE_UNSIGNED_INT),new t(e,r,i,o.a.TEXTUREFORMAT_RGB,n,s,a,u,l)},t.CreateRGBATexture=function(e,r,i,n,s,a,u,l){return void 0===s&&(s=!0),void 0===a&&(a=!1),void 0===u&&(u=o.a.TEXTURE_TRILINEAR_SAMPLINGMODE),void 0===l&&(l=o.a.TEXTURETYPE_UNSIGNED_INT),new t(e,r,i,o.a.TEXTUREFORMAT_RGBA,n,s,a,u,l)},t.CreateRTexture=function(e,r,i,s,a,u,l,c){return void 0===a&&(a=!0),void 0===u&&(u=!1),void 0===l&&(l=n.a.TRILINEAR_SAMPLINGMODE),void 0===c&&(c=o.a.TEXTURETYPE_FLOAT),new t(e,r,i,o.a.TEXTUREFORMAT_R,s,a,u,l,c)},t}(n.a)},76:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var i=function(){function e(){this._isDirty=!0,this._areLightsDirty=!0,this._areAttributesDirty=!0,this._areTexturesDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._areImageProcessingDirty=!0,this._normals=!1,this._uvs=!1,this._needNormals=!1,this._needUVs=!1}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isDirty},enumerable:!0,configurable:!0}),e.prototype.markAsProcessed=function(){this._isDirty=!1,this._areAttributesDirty=!1,this._areTexturesDirty=!1,this._areFresnelDirty=!1,this._areLightsDirty=!1,this._areMiscDirty=!1,this._areImageProcessingDirty=!1},e.prototype.markAsUnprocessed=function(){this._isDirty=!0},e.prototype.markAllAsDirty=function(){this._areTexturesDirty=!0,this._areAttributesDirty=!0,this._areLightsDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._areImageProcessingDirty=!0,this._isDirty=!0},e.prototype.markAsImageProcessingDirty=function(){this._areImageProcessingDirty=!0,this._isDirty=!0},e.prototype.markAsLightDirty=function(){this._areLightsDirty=!0,this._isDirty=!0},e.prototype.markAsAttributesDirty=function(){this._areAttributesDirty=!0,this._isDirty=!0},e.prototype.markAsTexturesDirty=function(){this._areTexturesDirty=!0,this._isDirty=!0},e.prototype.markAsFresnelDirty=function(){this._areFresnelDirty=!0,this._isDirty=!0},e.prototype.markAsMiscDirty=function(){this._areMiscDirty=!0,this._isDirty=!0},e.prototype.rebuild=function(){this._keys&&delete this._keys,this._keys=[];for(var e=0,t=Object.keys(this);e<t.length;e++){var r=t[e];"_"!==r[0]&&this._keys.push(r)}},e.prototype.isEqual=function(e){if(this._keys.length!==e._keys.length)return!1;for(var t=0;t<this._keys.length;t++){var r=this._keys[t];if(this[r]!==e[r])return!1}return!0},e.prototype.cloneTo=function(e){this._keys.length!==e._keys.length&&(e._keys=this._keys.slice(0));for(var t=0;t<this._keys.length;t++){var r=this._keys[t];e[r]=this[r]}},e.prototype.reset=function(){for(var e=0;e<this._keys.length;e++){var t=this._keys[e];switch(typeof this[t]){case"number":this[t]=0;break;case"string":this[t]="";break;default:this[t]=!1}}},e.prototype.toString=function(){for(var e="",t=0;t<this._keys.length;t++){var r=this._keys[t],i=this[r];switch(typeof i){case"number":case"string":e+="#define "+r+" "+i+"\n";break;default:i&&(e+="#define "+r+"\n")}}return e},e}()},77:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var i=r(1),n=r(9),o=r(6),s=r(4),a=function(e){function t(t,r,i,n,a,u){void 0===i&&(i=null),void 0===a&&(a=s.a.TEXTURE_TRILINEAR_SAMPLINGMODE),void 0===u&&(u=s.a.TEXTUREFORMAT_RGBA);var l=e.call(this,null,i,!n,void 0,a,void 0,void 0,void 0,void 0,u)||this;l.name=t,l._engine=l.getScene().getEngine(),l.wrapU=o.a.CLAMP_ADDRESSMODE,l.wrapV=o.a.CLAMP_ADDRESSMODE,l._generateMipMaps=n,r.getContext?(l._canvas=r,l._texture=l._engine.createDynamicTexture(r.width,r.height,n,a)):(l._canvas=document.createElement("canvas"),r.width||0===r.width?l._texture=l._engine.createDynamicTexture(r.width,r.height,n,a):l._texture=l._engine.createDynamicTexture(r,r,n,a));var c=l.getSize();return l._canvas.width=c.width,l._canvas.height=c.height,l._context=l._canvas.getContext("2d"),l}return i.d(t,e),t.prototype.getClassName=function(){return"DynamicTexture"},Object.defineProperty(t.prototype,"canRescale",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype._recreate=function(e){this._canvas.width=e.width,this._canvas.height=e.height,this.releaseInternalTexture(),this._texture=this._engine.createDynamicTexture(e.width,e.height,this._generateMipMaps,this.samplingMode)},t.prototype.scale=function(e){var t=this.getSize();t.width*=e,t.height*=e,this._recreate(t)},t.prototype.scaleTo=function(e,t){var r=this.getSize();r.width=e,r.height=t,this._recreate(r)},t.prototype.getContext=function(){return this._context},t.prototype.clear=function(){var e=this.getSize();this._context.fillRect(0,0,e.width,e.height)},t.prototype.update=function(e,t){void 0===t&&(t=!1),this._engine.updateDynamicTexture(this._texture,this._canvas,void 0===e||e,t,this._format||void 0)},t.prototype.drawText=function(e,t,r,i,n,o,s,a){void 0===a&&(a=!0);var u=this.getSize();if(o&&(this._context.fillStyle=o,this._context.fillRect(0,0,u.width,u.height)),this._context.font=i,null==t){var l=this._context.measureText(e);t=(u.width-l.width)/2}if(null==r){var c=parseInt(i.replace(/\D/g,""));r=u.height/2+c/3.65}this._context.fillStyle=n,this._context.fillText(e,t,r),a&&this.update(s)},t.prototype.clone=function(){var e=this.getScene();if(!e)return this;var r=this.getSize(),i=new t(this.name,r,e,this._generateMipMaps);return i.hasAlpha=this.hasAlpha,i.level=this.level,i.wrapU=this.wrapU,i.wrapV=this.wrapV,i},t.prototype.serialize=function(){var t=this.getScene();t&&!t.isReady()&&n.a.Warn("The scene must be ready before serializing the dynamic texture");var r=e.prototype.serialize.call(this);return r.base64String=this._canvas.toDataURL(),r.invertY=this._invertY,r.samplingMode=this.samplingMode,r},t.prototype._rebuild=function(){this.update()},t}(o.a)},78:function(e,t,r){"use strict";r.d(t,"a",function(){return f});var i=r(1),n=r(2),o=r(0),s=r(3),a=r(6),u=r(17),l=r(8),c=r(14),h=r(26),f=function(e){function t(t,r,n,s){void 0===s&&(s={});var a=e.call(this,t,r)||this;return a._textures={},a._textureArrays={},a._floats={},a._ints={},a._floatsArrays={},a._colors3={},a._colors3Arrays={},a._colors4={},a._vectors2={},a._vectors3={},a._vectors4={},a._matrices={},a._matrices3x3={},a._matrices2x2={},a._vectors2Arrays={},a._vectors3Arrays={},a._cachedWorldViewMatrix=new o.Matrix,a._shaderPath=n,a._options=i.a({needAlphaBlending:!1,needAlphaTesting:!1,attributes:["position","normal","uv"],uniforms:["worldViewProjection"],uniformBuffers:[],samplers:[],defines:[]},s),a}return i.d(t,e),t.prototype.getClassName=function(){return"ShaderMaterial"},t.prototype.needAlphaBlending=function(){return this.alpha<1||this._options.needAlphaBlending},t.prototype.needAlphaTesting=function(){return this._options.needAlphaTesting},t.prototype._checkUniform=function(e){-1===this._options.uniforms.indexOf(e)&&this._options.uniforms.push(e)},t.prototype.setTexture=function(e,t){return-1===this._options.samplers.indexOf(e)&&this._options.samplers.push(e),this._textures[e]=t,this},t.prototype.setTextureArray=function(e,t){return-1===this._options.samplers.indexOf(e)&&this._options.samplers.push(e),this._checkUniform(e),this._textureArrays[e]=t,this},t.prototype.setFloat=function(e,t){return this._checkUniform(e),this._floats[e]=t,this},t.prototype.setInt=function(e,t){return this._checkUniform(e),this._ints[e]=t,this},t.prototype.setFloats=function(e,t){return this._checkUniform(e),this._floatsArrays[e]=t,this},t.prototype.setColor3=function(e,t){return this._checkUniform(e),this._colors3[e]=t,this},t.prototype.setColor3Array=function(e,t){return this._checkUniform(e),this._colors3Arrays[e]=t.reduce(function(e,t){return t.toArray(e,e.length),e},[]),this},t.prototype.setColor4=function(e,t){return this._checkUniform(e),this._colors4[e]=t,this},t.prototype.setVector2=function(e,t){return this._checkUniform(e),this._vectors2[e]=t,this},t.prototype.setVector3=function(e,t){return this._checkUniform(e),this._vectors3[e]=t,this},t.prototype.setVector4=function(e,t){return this._checkUniform(e),this._vectors4[e]=t,this},t.prototype.setMatrix=function(e,t){return this._checkUniform(e),this._matrices[e]=t,this},t.prototype.setMatrix3x3=function(e,t){return this._checkUniform(e),this._matrices3x3[e]=t,this},t.prototype.setMatrix2x2=function(e,t){return this._checkUniform(e),this._matrices2x2[e]=t,this},t.prototype.setArray2=function(e,t){return this._checkUniform(e),this._vectors2Arrays[e]=t,this},t.prototype.setArray3=function(e,t){return this._checkUniform(e),this._vectors3Arrays[e]=t,this},t.prototype._checkCache=function(e,t){return!e||(this._effect&&this._effect.defines.indexOf("#define INSTANCES"),!1)},t.prototype.isReady=function(e,t){var r=this.getScene(),i=r.getEngine();if(!this.checkReadyOnEveryCall&&this._renderId===r.getRenderId()&&this._checkCache(e,t))return!0;for(var n=[],o=[],a=new l.c,c=0;c<this._options.defines.length;c++)n.push(this._options.defines[c]);for(c=0;c<this._options.attributes.length;c++)o.push(this._options.attributes[c]);if(e&&e.isVerticesDataPresent(s.b.ColorKind)&&(o.push(s.b.ColorKind),n.push("#define VERTEXCOLOR")),t&&(n.push("#define INSTANCES"),u.a.PrepareAttributesForInstances(o,n)),e&&e.useBones&&e.computeBonesUsingShaders&&e.skeleton){o.push(s.b.MatricesIndicesKind),o.push(s.b.MatricesWeightsKind),e.numBoneInfluencers>4&&(o.push(s.b.MatricesIndicesExtraKind),o.push(s.b.MatricesWeightsExtraKind));var h=e.skeleton;n.push("#define NUM_BONE_INFLUENCERS "+e.numBoneInfluencers),a.addCPUSkinningFallback(0,e),h.isUsingTextureForMatrices?(n.push("#define BONETEXTURE"),-1===this._options.uniforms.indexOf("boneTextureWidth")&&this._options.uniforms.push("boneTextureWidth"),-1===this._options.samplers.indexOf("boneSampler")&&this._options.samplers.push("boneSampler")):(n.push("#define BonesPerMesh "+(h.bones.length+1)),-1===this._options.uniforms.indexOf("mBones")&&this._options.uniforms.push("mBones"))}else n.push("#define NUM_BONE_INFLUENCERS 0");for(var f in this._textures)if(!this._textures[f].isReady())return!1;e&&this._shouldTurnAlphaTestOn(e)&&n.push("#define ALPHATEST");var p=this._effect,d=n.join("\n");return this._effect=i.createEffect(this._shaderPath,{attributes:o,uniformsNames:this._options.uniforms,uniformBuffersNames:this._options.uniformBuffers,samplers:this._options.samplers,defines:d,fallbacks:a,onCompiled:this.onCompiled,onError:this.onError},i),!!this._effect.isReady()&&(p!==this._effect&&r.resetCachedMaterial(),this._renderId=r.getRenderId(),!0)},t.prototype.bindOnlyWorldMatrix=function(e){var t=this.getScene();this._effect&&(-1!==this._options.uniforms.indexOf("world")&&this._effect.setMatrix("world",e),-1!==this._options.uniforms.indexOf("worldView")&&(e.multiplyToRef(t.getViewMatrix(),this._cachedWorldViewMatrix),this._effect.setMatrix("worldView",this._cachedWorldViewMatrix)),-1!==this._options.uniforms.indexOf("worldViewProjection")&&this._effect.setMatrix("worldViewProjection",e.multiply(t.getTransformMatrix())))},t.prototype.bind=function(e,t){if(this.bindOnlyWorldMatrix(e),this._effect&&this.getScene().getCachedMaterial()!==this){var r;for(r in-1!==this._options.uniforms.indexOf("view")&&this._effect.setMatrix("view",this.getScene().getViewMatrix()),-1!==this._options.uniforms.indexOf("projection")&&this._effect.setMatrix("projection",this.getScene().getProjectionMatrix()),-1!==this._options.uniforms.indexOf("viewProjection")&&this._effect.setMatrix("viewProjection",this.getScene().getTransformMatrix()),u.a.BindBonesParameters(t,this._effect),this._textures)this._effect.setTexture(r,this._textures[r]);for(r in this._textureArrays)this._effect.setTextureArray(r,this._textureArrays[r]);for(r in this._ints)this._effect.setInt(r,this._ints[r]);for(r in this._floats)this._effect.setFloat(r,this._floats[r]);for(r in this._floatsArrays)this._effect.setArray(r,this._floatsArrays[r]);for(r in this._colors3)this._effect.setColor3(r,this._colors3[r]);for(r in this._colors3Arrays)this._effect.setArray3(r,this._colors3Arrays[r]);for(r in this._colors4){var i=this._colors4[r];this._effect.setFloat4(r,i.r,i.g,i.b,i.a)}for(r in this._vectors2)this._effect.setVector2(r,this._vectors2[r]);for(r in this._vectors3)this._effect.setVector3(r,this._vectors3[r]);for(r in this._vectors4)this._effect.setVector4(r,this._vectors4[r]);for(r in this._matrices)this._effect.setMatrix(r,this._matrices[r]);for(r in this._matrices3x3)this._effect.setMatrix3x3(r,this._matrices3x3[r]);for(r in this._matrices2x2)this._effect.setMatrix2x2(r,this._matrices2x2[r]);for(r in this._vectors2Arrays)this._effect.setArray2(r,this._vectors2Arrays[r]);for(r in this._vectors3Arrays)this._effect.setArray3(r,this._vectors3Arrays[r])}this._afterBind(t)},t.prototype.getActiveTextures=function(){var t=e.prototype.getActiveTextures.call(this);for(var r in this._textures)t.push(this._textures[r]);for(var r in this._textureArrays)for(var i=this._textureArrays[r],n=0;n<i.length;n++)t.push(i[n]);return t},t.prototype.hasTexture=function(t){if(e.prototype.hasTexture.call(this,t))return!0;for(var r in this._textures)if(this._textures[r]===t)return!0;for(var r in this._textureArrays)for(var i=this._textureArrays[r],n=0;n<i.length;n++)if(i[n]===t)return!0;return!1},t.prototype.clone=function(e){return new t(e,this.getScene(),this._shaderPath,this._options)},t.prototype.dispose=function(t,r,i){if(r){var n;for(n in this._textures)this._textures[n].dispose();for(n in this._textureArrays)for(var o=this._textureArrays[n],s=0;s<o.length;s++)o[s].dispose()}this._textures={},e.prototype.dispose.call(this,t,r,i)},t.prototype.serialize=function(){var e,t=n.a.Serialize(this);for(e in t.customType="ShaderMaterial",t.options=this._options,t.shaderPath=this._shaderPath,t.textures={},this._textures)t.textures[e]=this._textures[e].serialize();for(e in t.textureArrays={},this._textureArrays){t.textureArrays[e]=[];for(var r=this._textureArrays[e],i=0;i<r.length;i++)t.textureArrays[e].push(r[i].serialize())}for(e in t.floats={},this._floats)t.floats[e]=this._floats[e];for(e in t.FloatArrays={},this._floatsArrays)t.FloatArrays[e]=this._floatsArrays[e];for(e in t.colors3={},this._colors3)t.colors3[e]=this._colors3[e].asArray();for(e in t.colors3Arrays={},this._colors3Arrays)t.colors3Arrays[e]=this._colors3Arrays[e];for(e in t.colors4={},this._colors4)t.colors4[e]=this._colors4[e].asArray();for(e in t.vectors2={},this._vectors2)t.vectors2[e]=this._vectors2[e].asArray();for(e in t.vectors3={},this._vectors3)t.vectors3[e]=this._vectors3[e].asArray();for(e in t.vectors4={},this._vectors4)t.vectors4[e]=this._vectors4[e].asArray();for(e in t.matrices={},this._matrices)t.matrices[e]=this._matrices[e].asArray();for(e in t.matrices3x3={},this._matrices3x3)t.matrices3x3[e]=this._matrices3x3[e];for(e in t.matrices2x2={},this._matrices2x2)t.matrices2x2[e]=this._matrices2x2[e];for(e in t.vectors2Arrays={},this._vectors2Arrays)t.vectors2Arrays[e]=this._vectors2Arrays[e];for(e in t.vectors3Arrays={},this._vectors3Arrays)t.vectors3Arrays[e]=this._vectors3Arrays[e];return t},t.Parse=function(e,r,i){var s,u=n.a.Parse(function(){return new t(e.name,r,e.shaderPath,e.options)},e,r,i);for(s in e.textures)u.setTexture(s,a.a.Parse(e.textures[s],r,i));for(s in e.textureArrays){for(var l=e.textureArrays[s],c=new Array,h=0;h<l.length;h++)c.push(a.a.Parse(l[h],r,i));u.setTextureArray(s,c)}for(s in e.floats)u.setFloat(s,e.floats[s]);for(s in e.floatsArrays)u.setFloats(s,e.floatsArrays[s]);for(s in e.colors3)u.setColor3(s,o.Color3.FromArray(e.colors3[s]));for(s in e.colors3Arrays){var f=e.colors3Arrays[s].reduce(function(e,t,r){return r%3==0?e.push([t]):e[e.length-1].push(t),e},[]).map(function(e){return o.Color3.FromArray(e)});u.setColor3Array(s,f)}for(s in e.colors4)u.setColor4(s,o.Color4.FromArray(e.colors4[s]));for(s in e.vectors2)u.setVector2(s,o.Vector2.FromArray(e.vectors2[s]));for(s in e.vectors3)u.setVector3(s,o.Vector3.FromArray(e.vectors3[s]));for(s in e.vectors4)u.setVector4(s,o.Vector4.FromArray(e.vectors4[s]));for(s in e.matrices)u.setMatrix(s,o.Matrix.FromArray(e.matrices[s]));for(s in e.matrices3x3)u.setMatrix3x3(s,e.matrices3x3[s]);for(s in e.matrices2x2)u.setMatrix2x2(s,e.matrices2x2[s]);for(s in e.vectors2Arrays)u.setArray2(s,e.vectors2Arrays[s]);for(s in e.vectors3Arrays)u.setArray3(s,e.vectors3Arrays[s]);return u},t}(c.a);h.a.RegisteredTypes["BABYLON.ShaderMaterial"]=f},8:function(e,t,r){"use strict";r.d(t,"c",function(){return a}),r.d(t,"b",function(){return u}),r.d(t,"a",function(){return l});var i=r(7),n=r(4),o=r(51),s=r(9),a=function(){function e(){this._defines={},this._currentRank=32,this._maxRank=-1}return e.prototype.unBindMesh=function(){this._mesh=null},e.prototype.addFallback=function(e,t){this._defines[e]||(e<this._currentRank&&(this._currentRank=e),e>this._maxRank&&(this._maxRank=e),this._defines[e]=new Array),this._defines[e].push(t)},e.prototype.addCPUSkinningFallback=function(e,t){this._mesh=t,e<this._currentRank&&(this._currentRank=e),e>this._maxRank&&(this._maxRank=e)},Object.defineProperty(e.prototype,"isMoreFallbacks",{get:function(){return this._currentRank<=this._maxRank},enumerable:!0,configurable:!0}),e.prototype.reduce=function(e,t){if(this._mesh&&this._mesh.computeBonesUsingShaders&&this._mesh.numBoneInfluencers>0&&this._mesh.material){this._mesh.computeBonesUsingShaders=!1,e=e.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),t._bonesComputationForcedToCPU=!0;for(var r=this._mesh.getScene(),i=0;i<r.meshes.length;i++){var n=r.meshes[i];if(n.material&&(n.computeBonesUsingShaders&&0!==n.numBoneInfluencers))if(n.material.getEffect()===t)n.computeBonesUsingShaders=!1;else if(n.subMeshes)for(var o=0,s=n.subMeshes;o<s.length;o++){if(s[o].effect===t){n.computeBonesUsingShaders=!1;break}}}}else{var a=this._defines[this._currentRank];if(a)for(i=0;i<a.length;i++)e=e.replace("#define "+a[i],"");this._currentRank++}return e},e}(),u=function(){return function(){}}(),l=function(){function e(t,r,n,o,s,a,u,l,c,h){void 0===o&&(o=null),void 0===a&&(a=null),void 0===u&&(u=null),void 0===l&&(l=null),void 0===c&&(c=null);var f,p,d=this;if(this.uniqueId=0,this.onCompileObservable=new i.c,this.onErrorObservable=new i.c,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._isReady=!1,this._compilationError="",this.name=t,r.attributes){var _=r;if(this._engine=n,this._attributesNames=_.attributes,this._uniformsNames=_.uniformsNames.concat(_.samplers),this._samplers=_.samplers.slice(),this.defines=_.defines,this.onError=_.onError,this.onCompiled=_.onCompiled,this._fallbacks=_.fallbacks,this._indexParameters=_.indexParameters,this._transformFeedbackVaryings=_.transformFeedbackVaryings,_.uniformBuffersNames)for(var g=0;g<_.uniformBuffersNames.length;g++)this._uniformBuffersNames[_.uniformBuffersNames[g]]=g}else this._engine=s,this.defines=a,this._uniformsNames=n.concat(o),this._samplers=o?o.slice():[],this._attributesNames=r,this.onError=c,this.onCompiled=l,this._indexParameters=h,this._fallbacks=u;this.uniqueId=e._uniqueIdSeed++,t.vertexElement?(f=document.getElementById(t.vertexElement))||(f=t.vertexElement):f=t.vertex||t,t.fragmentElement?(p=document.getElementById(t.fragmentElement))||(p=t.fragmentElement):p=t.fragment||t,this._loadVertexShader(f,function(e){d._processIncludes(e,function(e){d._processShaderConversion(e,!1,function(e){d._loadFragmentShader(p,function(r){d._processIncludes(r,function(r){d._processShaderConversion(r,!0,function(r){if(t){var i=t.vertexElement||t.vertex||t,n=t.fragmentElement||t.fragment||t;d._vertexSourceCode="#define SHADER_NAME vertex:"+i+"\n"+e,d._fragmentSourceCode="#define SHADER_NAME fragment:"+n+"\n"+r}else d._vertexSourceCode=e,d._fragmentSourceCode=r;d._prepareEffect()})})})})})})}return Object.defineProperty(e.prototype,"onBindObservable",{get:function(){return this._onBindObservable||(this._onBindObservable=new i.c),this._onBindObservable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),e.prototype.isReady=function(){return!this._isReady&&this._program&&this._program.isParallelCompiled?this._engine._isProgramCompiled(this._program):this._isReady},e.prototype.getEngine=function(){return this._engine},e.prototype.getProgram=function(){return this._program},e.prototype.getAttributesNames=function(){return this._attributesNames},e.prototype.getAttributeLocation=function(e){return this._attributes[e]},e.prototype.getAttributeLocationByName=function(e){var t=this._attributesNames.indexOf(e);return this._attributes[t]},e.prototype.getAttributesCount=function(){return this._attributes.length},e.prototype.getUniformIndex=function(e){return this._uniformsNames.indexOf(e)},e.prototype.getUniform=function(e){return this._uniforms[this._uniformsNames.indexOf(e)]},e.prototype.getSamplers=function(){return this._samplers},e.prototype.getCompilationError=function(){return this._compilationError},e.prototype.executeWhenCompiled=function(e){var t=this;this.isReady()?e(this):(this.onCompileObservable.add(function(t){e(t)}),this._program&&!this._program.isParallelCompiled||setTimeout(function(){t._checkIsReady()},16))},e.prototype._checkIsReady=function(){var e=this;this.isReady()||setTimeout(function(){e._checkIsReady()},16)},e.prototype._loadVertexShader=function(t,r){var i;if(o.a.IsWindowObjectExist()&&t instanceof HTMLElement)return void r(o.a.GetDOMTextContent(t));"base64:"!==t.substr(0,7)?e.ShadersStore[t+"VertexShader"]?r(e.ShadersStore[t+"VertexShader"]):(i="."===t[0]||"/"===t[0]||t.indexOf("http")>-1?t:e.ShadersRepository+t,this._engine._loadFile(i+".vertex.fx",r)):r(window.atob(t.substr(7)))},e.prototype._loadFragmentShader=function(t,r){var i;if(o.a.IsWindowObjectExist()&&t instanceof HTMLElement)return void r(o.a.GetDOMTextContent(t));"base64:"!==t.substr(0,7)?e.ShadersStore[t+"PixelShader"]?r(e.ShadersStore[t+"PixelShader"]):e.ShadersStore[t+"FragmentShader"]?r(e.ShadersStore[t+"FragmentShader"]):(i="."===t[0]||"/"===t[0]||t.indexOf("http")>-1?t:e.ShadersRepository+t,this._engine._loadFile(i+".fragment.fx",r)):r(window.atob(t.substr(7)))},e.prototype._dumpShadersSource=function(e,t,r){var i=(this._engine.webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"")+(r?r+"\n":"");t=i+t;var n=2,o=/\n/gm,a="\n1\t"+(e=i+e).replace(o,function(){return"\n"+n+++"\t"});n=2;var u="\n1\t"+t.replace(o,function(){return"\n"+n+++"\t"});this.name.vertexElement?(s.a.Error("Vertex shader: "+this.name.vertexElement+a),s.a.Error("Fragment shader: "+this.name.fragmentElement+u)):this.name.vertex?(s.a.Error("Vertex shader: "+this.name.vertex+a),s.a.Error("Fragment shader: "+this.name.fragment+u)):(s.a.Error("Vertex shader: "+this.name+a),s.a.Error("Fragment shader: "+this.name+u))},e.prototype._processShaderConversion=function(e,t,r){var i=this._processPrecision(e);if(1!=this._engine.webGLVersion)if(-1===i.indexOf("#version 3")){var n=-1!==i.search(/#extension.+GL_EXT_draw_buffers.+require/),o=i.replace(/#extension.+(GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,"");o=(o=(o=(o=o.replace(/varying(?![\n\r])\s/g,t?"in ":"out ")).replace(/attribute[ \t]/g,"in ")).replace(/[ \t]attribute/g," in")).replace(/texture2D\s*\(/g,"texture("),t&&(o=(o=(o=(o=(o=(o=(o=o.replace(/texture2DLodEXT\s*\(/g,"textureLod(")).replace(/textureCubeLodEXT\s*\(/g,"textureLod(")).replace(/textureCube\s*\(/g,"texture(")).replace(/gl_FragDepthEXT/g,"gl_FragDepth")).replace(/gl_FragColor/g,"glFragColor")).replace(/gl_FragData/g,"glFragData")).replace(/void\s+?main\s*\(/g,(n?"":"out vec4 glFragColor;\n")+"void main(")),r(o)}else r(i.replace("#version 300 es",""));else r(i)},e.prototype._processIncludes=function(t,r){for(var i=this,n=/#include<(.+)>(\((.*)\))*(\[(.*)\])*/g,o=n.exec(t),s=new String(t);null!=o;){var a=o[1];if(-1!==a.indexOf("__decl__")&&(a=a.replace(/__decl__/,""),this._engine.supportsUniformBuffers&&(a=(a=a.replace(/Vertex/,"Ubo")).replace(/Fragment/,"Ubo")),a+="Declaration"),!e.IncludesShadersStore[a]){var u=e.ShadersRepository+"ShadersInclude/"+a+".fx";return void this._engine._loadFile(u,function(t){e.IncludesShadersStore[a]=t,i._processIncludes(s,r)})}var l=e.IncludesShadersStore[a];if(o[2])for(var c=o[3].split(","),h=0;h<c.length;h+=2){var f=new RegExp(c[h],"g"),p=c[h+1];l=l.replace(f,p)}if(o[4]){var d=o[5];if(-1!==d.indexOf("..")){var _=d.split(".."),g=parseInt(_[0]),m=parseInt(_[1]),T=l.slice(0);l="",isNaN(m)&&(m=this._indexParameters[_[1]]);for(var E=g;E<m;E++)this._engine.supportsUniformBuffers||(T=T.replace(/light\{X\}.(\w*)/g,function(e,t){return t+"{X}"})),l+=T.replace(/\{X\}/g,E.toString())+"\n"}else this._engine.supportsUniformBuffers||(l=l.replace(/light\{X\}.(\w*)/g,function(e,t){return t+"{X}"})),l=l.replace(/\{X\}/g,d)}s=s.replace(o[0],l),o=n.exec(t)}r(s)},e.prototype._processPrecision=function(e){return-1===e.indexOf("precision highp float")?e=this._engine.getCaps().highPrecisionShaderSupported?"precision highp float;\n"+e:"precision mediump float;\n"+e:this._engine.getCaps().highPrecisionShaderSupported||(e=e.replace("precision highp float","precision mediump float")),e},e.prototype._rebuildProgram=function(e,t,r,i){var o=this;this._isReady=!1,this._vertexSourceCodeOverride=e,this._fragmentSourceCodeOverride=t,this.onError=function(e,t){i&&i(t)},this.onCompiled=function(){for(var e=o.getEngine().scenes,t=0;t<e.length;t++)e[t].markAllMaterialsAsDirty(n.a.MATERIAL_TextureDirtyFlag);r&&r(o._program)},this._fallbacks=null,this._prepareEffect()},e.prototype.getSpecificUniformLocations=function(e){return this._engine.getUniforms(this._program,e)},e.prototype._prepareEffect=function(){var e=this,t=this._attributesNames,r=this.defines,i=this._fallbacks;this._valueCache={};var n=this._program;try{var o=this._engine;this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._program=o.createRawShaderProgram(this._vertexSourceCodeOverride,this._fragmentSourceCodeOverride,void 0,this._transformFeedbackVaryings):this._program=o.createShaderProgram(this._vertexSourceCode,this._fragmentSourceCode,r,void 0,this._transformFeedbackVaryings),this._program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this),o._executeWhenProgramIsCompiled(this._program,function(){if(o.supportsUniformBuffers)for(var r in e._uniformBuffersNames)e.bindUniformBlock(r,e._uniformBuffersNames[r]);var i;for(e._uniforms=o.getUniforms(e._program,e._uniformsNames),e._attributes=o.getAttributes(e._program,t),i=0;i<e._samplers.length;i++){null==e.getUniform(e._samplers[i])&&(e._samplers.splice(i,1),i--)}o.bindSamplers(e),e._compilationError="",e._isReady=!0,e.onCompiled&&e.onCompiled(e),e.onCompileObservable.notifyObservers(e),e.onCompileObservable.clear(),e._fallbacks&&e._fallbacks.unBindMesh(),n&&e.getEngine()._deleteProgram(n)}),this._program.isParallelCompiled&&this._checkIsReady()}catch(e){this._compilationError=e.message,s.a.Error("Unable to compile effect:"),s.a.Error("Uniforms: "+this._uniformsNames.map(function(e){return" "+e})),s.a.Error("Attributes: "+t.map(function(e){return" "+e})),s.a.Error("Error: "+this._compilationError),n&&(this._program=n,this._isReady=!0,this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this)),i&&i.isMoreFallbacks?(s.a.Error("Trying next fallback."),this.defines=i.reduce(this.defines,this),this._prepareEffect()):(this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())}},Object.defineProperty(e.prototype,"isSupported",{get:function(){return""===this._compilationError},enumerable:!0,configurable:!0}),e.prototype._bindTexture=function(e,t){this._engine._bindTexture(this._samplers.indexOf(e),t)},e.prototype.setTexture=function(e,t){this._engine.setTexture(this._samplers.indexOf(e),this.getUniform(e),t)},e.prototype.setDepthStencilTexture=function(e,t){this._engine.setDepthStencilTexture(this._samplers.indexOf(e),this.getUniform(e),t)},e.prototype.setTextureArray=function(e,t){if(-1===this._samplers.indexOf(e+"Ex"))for(var r=this._samplers.indexOf(e),i=1;i<t.length;i++)this._samplers.splice(r+i,0,e+"Ex");this._engine.setTextureArray(this._samplers.indexOf(e),this.getUniform(e),t)},e.prototype.setTextureFromPostProcess=function(e,t){this._engine.setTextureFromPostProcess(this._samplers.indexOf(e),t)},e.prototype.setTextureFromPostProcessOutput=function(e,t){this._engine.setTextureFromPostProcessOutput(this._samplers.indexOf(e),t)},e.prototype._cacheMatrix=function(e,t){var r=this._valueCache[e],i=t.updateFlag;return(void 0===r||r!==i)&&(this._valueCache[e]=i,!0)},e.prototype._cacheFloat2=function(e,t,r){var i=this._valueCache[e];if(!i)return i=[t,r],this._valueCache[e]=i,!0;var n=!1;return i[0]!==t&&(i[0]=t,n=!0),i[1]!==r&&(i[1]=r,n=!0),n},e.prototype._cacheFloat3=function(e,t,r,i){var n=this._valueCache[e];if(!n)return n=[t,r,i],this._valueCache[e]=n,!0;var o=!1;return n[0]!==t&&(n[0]=t,o=!0),n[1]!==r&&(n[1]=r,o=!0),n[2]!==i&&(n[2]=i,o=!0),o},e.prototype._cacheFloat4=function(e,t,r,i,n){var o=this._valueCache[e];if(!o)return o=[t,r,i,n],this._valueCache[e]=o,!0;var s=!1;return o[0]!==t&&(o[0]=t,s=!0),o[1]!==r&&(o[1]=r,s=!0),o[2]!==i&&(o[2]=i,s=!0),o[3]!==n&&(o[3]=n,s=!0),s},e.prototype.bindUniformBuffer=function(t,r){var i=this._uniformBuffersNames[r];void 0!==i&&e._baseCache[i]!==t&&(e._baseCache[i]=t,this._engine.bindUniformBufferBase(t,i))},e.prototype.bindUniformBlock=function(e,t){this._engine.bindUniformBlock(this._program,e,t)},e.prototype.setInt=function(e,t){var r=this._valueCache[e];return void 0!==r&&r===t?this:(this._valueCache[e]=t,this._engine.setInt(this.getUniform(e),t),this)},e.prototype.setIntArray=function(e,t){return this._valueCache[e]=null,this._engine.setIntArray(this.getUniform(e),t),this},e.prototype.setIntArray2=function(e,t){return this._valueCache[e]=null,this._engine.setIntArray2(this.getUniform(e),t),this},e.prototype.setIntArray3=function(e,t){return this._valueCache[e]=null,this._engine.setIntArray3(this.getUniform(e),t),this},e.prototype.setIntArray4=function(e,t){return this._valueCache[e]=null,this._engine.setIntArray4(this.getUniform(e),t),this},e.prototype.setFloatArray=function(e,t){return this._valueCache[e]=null,this._engine.setFloatArray(this.getUniform(e),t),this},e.prototype.setFloatArray2=function(e,t){return this._valueCache[e]=null,this._engine.setFloatArray2(this.getUniform(e),t),this},e.prototype.setFloatArray3=function(e,t){return this._valueCache[e]=null,this._engine.setFloatArray3(this.getUniform(e),t),this},e.prototype.setFloatArray4=function(e,t){return this._valueCache[e]=null,this._engine.setFloatArray4(this.getUniform(e),t),this},e.prototype.setArray=function(e,t){return this._valueCache[e]=null,this._engine.setArray(this.getUniform(e),t),this},e.prototype.setArray2=function(e,t){return this._valueCache[e]=null,this._engine.setArray2(this.getUniform(e),t),this},e.prototype.setArray3=function(e,t){return this._valueCache[e]=null,this._engine.setArray3(this.getUniform(e),t),this},e.prototype.setArray4=function(e,t){return this._valueCache[e]=null,this._engine.setArray4(this.getUniform(e),t),this},e.prototype.setMatrices=function(e,t){return t?(this._valueCache[e]=null,this._engine.setMatrices(this.getUniform(e),t),this):this},e.prototype.setMatrix=function(e,t){return this._cacheMatrix(e,t)&&this._engine.setMatrix(this.getUniform(e),t),this},e.prototype.setMatrix3x3=function(e,t){return this._valueCache[e]=null,this._engine.setMatrix3x3(this.getUniform(e),t),this},e.prototype.setMatrix2x2=function(e,t){return this._valueCache[e]=null,this._engine.setMatrix2x2(this.getUniform(e),t),this},e.prototype.setFloat=function(e,t){var r=this._valueCache[e];return void 0!==r&&r===t?this:(this._valueCache[e]=t,this._engine.setFloat(this.getUniform(e),t),this)},e.prototype.setBool=function(e,t){var r=this._valueCache[e];return void 0!==r&&r===t?this:(this._valueCache[e]=t,this._engine.setBool(this.getUniform(e),t?1:0),this)},e.prototype.setVector2=function(e,t){return this._cacheFloat2(e,t.x,t.y)&&this._engine.setFloat2(this.getUniform(e),t.x,t.y),this},e.prototype.setFloat2=function(e,t,r){return this._cacheFloat2(e,t,r)&&this._engine.setFloat2(this.getUniform(e),t,r),this},e.prototype.setVector3=function(e,t){return this._cacheFloat3(e,t.x,t.y,t.z)&&this._engine.setFloat3(this.getUniform(e),t.x,t.y,t.z),this},e.prototype.setFloat3=function(e,t,r,i){return this._cacheFloat3(e,t,r,i)&&this._engine.setFloat3(this.getUniform(e),t,r,i),this},e.prototype.setVector4=function(e,t){return this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&this._engine.setFloat4(this.getUniform(e),t.x,t.y,t.z,t.w),this},e.prototype.setFloat4=function(e,t,r,i,n){return this._cacheFloat4(e,t,r,i,n)&&this._engine.setFloat4(this.getUniform(e),t,r,i,n),this},e.prototype.setColor3=function(e,t){return this._cacheFloat3(e,t.r,t.g,t.b)&&this._engine.setColor3(this.getUniform(e),t),this},e.prototype.setColor4=function(e,t,r){return this._cacheFloat4(e,t.r,t.g,t.b,r)&&this._engine.setColor4(this.getUniform(e),t,r),this},e.prototype.setDirectColor4=function(e,t){return this._cacheFloat4(e,t.r,t.g,t.b,t.a)&&this._engine.setDirectColor4(this.getUniform(e),t),this},e.RegisterShader=function(t,r,i){r&&(e.ShadersStore[t+"PixelShader"]=r),i&&(e.ShadersStore[t+"VertexShader"]=i)},e.ResetCache=function(){e._baseCache={}},e.ShadersRepository="src/Shaders/",e._uniqueIdSeed=0,e._baseCache={},e.ShadersStore={},e.IncludesShadersStore={},e}()},83:function(e,t,r){"use strict";r.d(t,"a",function(){return h});var i=r(1),n=r(2),o=r(5),s=r(0),a=r(58),u=r(6),l=r(16),c=r(4),h=function(e){function t(t,r,i,n,a,l,h,f,p,d,_,g,m){void 0===i&&(i=null),void 0===n&&(n=!1),void 0===a&&(a=null),void 0===l&&(l=null),void 0===h&&(h=null),void 0===f&&(f=c.a.TEXTUREFORMAT_RGBA),void 0===p&&(p=!1),void 0===d&&(d=null),void 0===_&&(_=!1),void 0===g&&(g=.8),void 0===m&&(m=0);var T=e.call(this,r)||this;if(T.boundingBoxPosition=s.Vector3.Zero(),T._rotationY=0,T._prefiltered=!1,T.name=t,T.url=t,T._noMipmap=n,T.hasAlpha=!1,T._format=f,T.isCube=!0,T._textureMatrix=s.Matrix.Identity(),T._createPolynomials=_,T.coordinatesMode=u.a.CUBIC_MODE,!t&&!a)return T;var E=t.lastIndexOf("."),b=d||(E>-1?t.substring(E).toLowerCase():""),A=".dds"===b,v=".env"===b;if(v?(T.gammaSpace=!1,T._prefiltered=!1):(T._prefiltered=p,p&&(T.gammaSpace=!1)),T._texture=T._getFromCache(t,n),!a&&(v||A||i||(i=["_px.jpg","_py.jpg","_pz.jpg","_nx.jpg","_ny.jpg","_nz.jpg"]),a=[],i))for(var y=0;y<i.length;y++)a.push(t+i[y]);return T._files=a,T._texture?l&&(T._texture.isReady?o.h.SetImmediate(function(){return l()}):T._texture.onLoadedObservable.add(l)):r.useDelayedTextureLoading?T.delayLoadState=c.a.DELAYLOADSTATE_NOTLOADED:T._texture=p?r.getEngine().createPrefilteredCubeTexture(t,r,g,m,l,h,f,d,T._createPolynomials):r.getEngine().createCubeTexture(t,r,a,n,l,h,T._format,d,!1,g,m),T}return i.d(t,e),Object.defineProperty(t.prototype,"boundingBoxSize",{get:function(){return this._boundingBoxSize},set:function(e){if(!this._boundingBoxSize||!this._boundingBoxSize.equals(e)){this._boundingBoxSize=e;var t=this.getScene();t&&t.markAllMaterialsAsDirty(c.a.MATERIAL_TextureDirtyFlag)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotationY",{get:function(){return this._rotationY},set:function(e){this._rotationY=e,this.setReflectionTextureMatrix(s.Matrix.RotationY(this._rotationY))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"noMipmap",{get:function(){return this._noMipmap},enumerable:!0,configurable:!0}),t.CreateFromImages=function(e,r,i){var n="";return e.forEach(function(e){return n+=e}),new t(n,r,null,i,e)},t.CreateFromPrefilteredData=function(e,r,i,n){return void 0===i&&(i=null),void 0===n&&(n=!0),new t(e,r,null,!1,null,null,null,void 0,!0,i,n)},t.prototype.getClassName=function(){return"CubeTexture"},t.prototype.updateURL=function(e,t,r){this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(c.a.MATERIAL_TextureDirtyFlag)),this.url=e,this.delayLoadState=c.a.DELAYLOADSTATE_NOTLOADED,this._prefiltered=!1,r&&(this._delayedOnLoad=r),this.delayLoad(t)},t.prototype.delayLoad=function(e){if(this.delayLoadState===c.a.DELAYLOADSTATE_NOTLOADED){var t=this.getScene();t&&(this.delayLoadState=c.a.DELAYLOADSTATE_LOADED,this._texture=this._getFromCache(this.url,this._noMipmap),this._texture||(this._prefiltered?this._texture=t.getEngine().createPrefilteredCubeTexture(this.url,t,this.lodGenerationScale,this.lodGenerationOffset,this._delayedOnLoad,void 0,this._format,void 0,this._createPolynomials):this._texture=t.getEngine().createCubeTexture(this.url,t,this._files,this._noMipmap,this._delayedOnLoad,void 0,this._format,e)))}},t.prototype.getReflectionTextureMatrix=function(){return this._textureMatrix},t.prototype.setReflectionTextureMatrix=function(e){var t=this;e.updateFlag!==this._textureMatrix.updateFlag&&(e.isIdentity()!==this._textureMatrix.isIdentity()&&this.getScene().markAllMaterialsAsDirty(c.a.MATERIAL_TextureDirtyFlag,function(e){return-1!==e.getActiveTextures().indexOf(t)}),this._textureMatrix=e)},t.Parse=function(e,r,i){var o=n.a.Parse(function(){var n=!1;return e.prefiltered&&(n=e.prefiltered),new t(i+e.name,r,e.extensions,!1,null,null,null,void 0,n)},e,r);if(e.boundingBoxPosition&&(o.boundingBoxPosition=s.Vector3.FromArray(e.boundingBoxPosition)),e.boundingBoxSize&&(o.boundingBoxSize=s.Vector3.FromArray(e.boundingBoxSize)),e.animations)for(var a=0;a<e.animations.length;a++){var u=e.animations[a];o.animations.push(l.a.Parse(u))}return o},t.prototype.clone=function(){var e=this,r=this.getScene(),i=0,o=n.a.Clone(function(){if(!r)return e;var n=new t(e.url,r,e._extensions,e._noMipmap,e._files);return i=n.uniqueId,n},this);return o.uniqueId=i,o},i.c([Object(n.c)("rotationY")],t.prototype,"rotationY",null),t}(a.a);u.a._CubeTextureParser=h.Parse},84:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var i=r(1),n=r(14),o=r(27),s=r(26),a=function(e){function t(t,r){var i=e.call(this,t,r,!0)||this;return r.multiMaterials.push(i),i.subMaterials=new Array,i._storeEffectOnSubMeshes=!0,i}return i.d(t,e),Object.defineProperty(t.prototype,"subMaterials",{get:function(){return this._subMaterials},set:function(e){this._subMaterials=e,this._hookArray(e)},enumerable:!0,configurable:!0}),t.prototype.getChildren=function(){return this.subMaterials},t.prototype._hookArray=function(e){var t=this,r=e.push;e.push=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var o=r.apply(e,i);return t._markAllSubMeshesAsTexturesDirty(),o};var i=e.splice;e.splice=function(r,n){var o=i.apply(e,[r,n]);return t._markAllSubMeshesAsTexturesDirty(),o}},t.prototype.getSubMaterial=function(e){return e<0||e>=this.subMaterials.length?this.getScene().defaultMaterial:this.subMaterials[e]},t.prototype.getActiveTextures=function(){var t;return(t=e.prototype.getActiveTextures.call(this)).concat.apply(t,this.subMaterials.map(function(e){return e?e.getActiveTextures():[]}))},t.prototype.getClassName=function(){return"MultiMaterial"},t.prototype.isReadyForSubMesh=function(e,t,r){for(var i=0;i<this.subMaterials.length;i++){var n=this.subMaterials[i];if(n){if(n._storeEffectOnSubMeshes){if(!n.isReadyForSubMesh(e,t,r))return!1;continue}if(!n.isReady(e))return!1}}return!0},t.prototype.clone=function(e,r){for(var i=new t(e,this.getScene()),n=0;n<this.subMaterials.length;n++){var o=null,s=this.subMaterials[n];o=r&&s?s.clone(e+"-"+s.name):this.subMaterials[n],i.subMaterials.push(o)}return i},t.prototype.serialize=function(){var e={};e.name=this.name,e.id=this.id,o.a&&(e.tags=o.a.GetTags(this)),e.materials=[];for(var t=0;t<this.subMaterials.length;t++){var r=this.subMaterials[t];r?e.materials.push(r.id):e.materials.push(null)}return e},t.prototype.dispose=function(t,r,i){var n=this.getScene();if(n){if(i)for(var o=0;o<this.subMaterials.length;o++){var s=this.subMaterials[o];s&&s.dispose(t,r)}(o=n.multiMaterials.indexOf(this))>=0&&n.multiMaterials.splice(o,1),e.prototype.dispose.call(this,t,r)}},t.ParseMultiMaterial=function(e,r){var i=new t(e.name,r);i.id=e.id,o.a&&o.a.AddTagsTo(i,e.tags);for(var n=0;n<e.materials.length;n++){var s=e.materials[n];s?i.subMaterials.push(r.getMaterialByID(s)):i.subMaterials.push(null)}return i},t}(n.a);s.a.RegisteredTypes["BABYLON.MultiMaterial"]=a},90:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var i=r(1),n=r(0),o=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i._normalMatrix=new n.Matrix,i.allowShaderHotSwapping=!0,i._storeEffectOnSubMeshes=!0,i}return i.d(t,e),t.prototype.getEffect=function(){return this._activeEffect},t.prototype.isReady=function(e,t){return!!e&&(!e.subMeshes||0===e.subMeshes.length||this.isReadyForSubMesh(e,e.subMeshes[0],t))},t.prototype.bindOnlyWorldMatrix=function(e){this._activeEffect.setMatrix("world",e)},t.prototype.bindOnlyNormalMatrix=function(e){this._activeEffect.setMatrix("normalMatrix",e)},t.prototype.bind=function(e,t){t&&this.bindForSubMesh(e,t,t.subMeshes[0])},t.prototype._afterBind=function(t,r){void 0===r&&(r=null),e.prototype._afterBind.call(this,t),this.getScene()._cachedEffect=r},t.prototype._mustRebind=function(e,t,r){return void 0===r&&(r=1),e.isCachedMaterialInvalid(this,t,r)},t}(r(14).a)},91:function(e,t,r){"use strict";r.d(t,"a",function(){return f});var i=r(1),n=r(2),o=r(7),s=r(3),a=r(15),u=r(14),l=r(6),c=r(39),h=r(204),f=(r(287),function(e){function t(t,r,i,n,u,l,c){void 0===u&&(u=null),void 0===l&&(l=!0),void 0===c&&(c=!1);var f=e.call(this,null,n,!l)||this;f.isCube=c,f.isEnabled=!0,f.autoClear=!0,f.onGeneratedObservable=new o.c,f._textures={},f._currentRefreshId=-1,f._refreshRate=1,f._vertexBuffers={},f._uniforms=new Array,f._samplers=new Array,f._floats={},f._ints={},f._floatsArrays={},f._colors3={},f._colors4={},f._vectors2={},f._vectors3={},f._matrices={},f._fallbackTextureUsed=!1,f._cachedDefines="",f._contentUpdateId=-1;var p=(n=f.getScene())._getComponent(a.a.NAME_PROCEDURALTEXTURE);p||(p=new h.a(n),n._addComponent(p)),n.proceduralTextures.push(f),f._engine=n.getEngine(),f.name=t,f.isRenderTarget=!0,f._size=r,f._generateMipMaps=l,f.setFragment(i),f._fallbackTexture=u,c?(f._texture=f._engine.createRenderTargetCubeTexture(r,{generateMipMaps:l,generateDepthBuffer:!1,generateStencilBuffer:!1}),f.setFloat("face",0)):f._texture=f._engine.createRenderTargetTexture(r,{generateMipMaps:l,generateDepthBuffer:!1,generateStencilBuffer:!1});var d=[];return d.push(1,1),d.push(-1,1),d.push(-1,-1),d.push(1,-1),f._vertexBuffers[s.b.PositionKind]=new s.b(f._engine,d,s.b.PositionKind,!1,!1,2),f._createIndexBuffer(),f}return i.d(t,e),t.prototype.getEffect=function(){return this._effect},t.prototype.getContent=function(){return this._contentData&&this._currentRefreshId==this._contentUpdateId?this._contentData:(this._contentData=this.readPixels(0,0,this._contentData),this._contentUpdateId=this._currentRefreshId,this._contentData)},t.prototype._createIndexBuffer=function(){var e=this._engine,t=[];t.push(0),t.push(1),t.push(2),t.push(0),t.push(2),t.push(3),this._indexBuffer=e.createIndexBuffer(t)},t.prototype._rebuild=function(){var e=this._vertexBuffers[s.b.PositionKind];e&&e._rebuild(),this._createIndexBuffer(),this.refreshRate===c.a.REFRESHRATE_RENDER_ONCE&&(this.refreshRate=c.a.REFRESHRATE_RENDER_ONCE)},t.prototype.reset=function(){void 0!==this._effect&&this._engine._releaseEffect(this._effect)},t.prototype._getDefines=function(){return""},t.prototype.isReady=function(){var e,t=this,r=this._engine;if(!this._fragment)return!1;if(this._fallbackTextureUsed)return!0;var i=this._getDefines();return!(!this._effect||i!==this._cachedDefines||!this._effect.isReady())||(e=void 0!==this._fragment.fragmentElement?{vertex:"procedural",fragmentElement:this._fragment.fragmentElement}:{vertex:"procedural",fragment:this._fragment},this._cachedDefines=i,this._effect=r.createEffect(e,[s.b.PositionKind],this._uniforms,this._samplers,i,void 0,void 0,function(){t.releaseInternalTexture(),t._fallbackTexture&&(t._texture=t._fallbackTexture._texture,t._texture&&t._texture.incrementReferences()),t._fallbackTextureUsed=!0}),this._effect.isReady())},t.prototype.resetRefreshCounter=function(){this._currentRefreshId=-1},t.prototype.setFragment=function(e){this._fragment=e},Object.defineProperty(t.prototype,"refreshRate",{get:function(){return this._refreshRate},set:function(e){this._refreshRate=e,this.resetRefreshCounter()},enumerable:!0,configurable:!0}),t.prototype._shouldRender=function(){return this.isEnabled&&this.isReady()&&this._texture?!this._fallbackTextureUsed&&(-1===this._currentRefreshId?(this._currentRefreshId=1,!0):this.refreshRate===this._currentRefreshId?(this._currentRefreshId=1,!0):(this._currentRefreshId++,!1)):(this._texture&&(this._texture.isReady=!1),!1)},t.prototype.getRenderSize=function(){return this._size},t.prototype.resize=function(e,t){this._fallbackTextureUsed||(this.releaseInternalTexture(),this._texture=this._engine.createRenderTargetTexture(e,t),this._size=e,this._generateMipMaps=t)},t.prototype._checkUniform=function(e){-1===this._uniforms.indexOf(e)&&this._uniforms.push(e)},t.prototype.setTexture=function(e,t){return-1===this._samplers.indexOf(e)&&this._samplers.push(e),this._textures[e]=t,this},t.prototype.setFloat=function(e,t){return this._checkUniform(e),this._floats[e]=t,this},t.prototype.setInt=function(e,t){return this._checkUniform(e),this._ints[e]=t,this},t.prototype.setFloats=function(e,t){return this._checkUniform(e),this._floatsArrays[e]=t,this},t.prototype.setColor3=function(e,t){return this._checkUniform(e),this._colors3[e]=t,this},t.prototype.setColor4=function(e,t){return this._checkUniform(e),this._colors4[e]=t,this},t.prototype.setVector2=function(e,t){return this._checkUniform(e),this._vectors2[e]=t,this},t.prototype.setVector3=function(e,t){return this._checkUniform(e),this._vectors3[e]=t,this},t.prototype.setMatrix=function(e,t){return this._checkUniform(e),this._matrices[e]=t,this},t.prototype.render=function(e){var t=this.getScene();if(t){var r=this._engine;for(var i in r.enableEffect(this._effect),r.setState(!1),this._textures)this._effect.setTexture(i,this._textures[i]);for(i in this._ints)this._effect.setInt(i,this._ints[i]);for(i in this._floats)this._effect.setFloat(i,this._floats[i]);for(i in this._floatsArrays)this._effect.setArray(i,this._floatsArrays[i]);for(i in this._colors3)this._effect.setColor3(i,this._colors3[i]);for(i in this._colors4){var n=this._colors4[i];this._effect.setFloat4(i,n.r,n.g,n.b,n.a)}for(i in this._vectors2)this._effect.setVector2(i,this._vectors2[i]);for(i in this._vectors3)this._effect.setVector3(i,this._vectors3[i]);for(i in this._matrices)this._effect.setMatrix(i,this._matrices[i]);if(this._texture){if(this.isCube)for(var o=0;o<6;o++)r.bindFramebuffer(this._texture,o,void 0,void 0,!0),r.bindBuffers(this._vertexBuffers,this._indexBuffer,this._effect),this._effect.setFloat("face",o),this.autoClear&&r.clear(t.clearColor,!0,!1,!1),r.drawElementsType(u.a.TriangleFillMode,0,6),5===o&&r.generateMipMapsForCubemap(this._texture);else r.bindFramebuffer(this._texture,0,void 0,void 0,!0),r.bindBuffers(this._vertexBuffers,this._indexBuffer,this._effect),this.autoClear&&r.clear(t.clearColor,!0,!1,!1),r.drawElementsType(u.a.TriangleFillMode,0,6);r.unBindFramebuffer(this._texture,this.isCube),this.onGenerated&&this.onGenerated(),this.onGeneratedObservable.notifyObservers(this)}}},t.prototype.clone=function(){var e=this.getSize(),r=new t(this.name,e.width,this._fragment,this.getScene(),this._fallbackTexture,this._generateMipMaps);return r.hasAlpha=this.hasAlpha,r.level=this.level,r.coordinatesMode=this.coordinatesMode,r},t.prototype.dispose=function(){var t=this.getScene();if(t){var r=t.proceduralTextures.indexOf(this);r>=0&&t.proceduralTextures.splice(r,1);var i=this._vertexBuffers[s.b.PositionKind];i&&(i.dispose(),this._vertexBuffers[s.b.PositionKind]=null),this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer)&&(this._indexBuffer=null),e.prototype.dispose.call(this)}},i.c([Object(n.c)()],t.prototype,"isEnabled",void 0),i.c([Object(n.c)()],t.prototype,"autoClear",void 0),i.c([Object(n.c)()],t.prototype,"_generateMipMaps",void 0),i.c([Object(n.c)()],t.prototype,"_size",void 0),i.c([Object(n.c)()],t.prototype,"refreshRate",null),t}(l.a))},99:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var i=r(9),n=function(){function e(e,t,r){this._engine=e,this._noUBO=!e.supportsUniformBuffers,this._dynamic=r,this._data=t||[],this._uniformLocations={},this._uniformSizes={},this._uniformLocationPointer=0,this._needSync=!1,this._noUBO?(this.updateMatrix3x3=this._updateMatrix3x3ForEffect,this.updateMatrix2x2=this._updateMatrix2x2ForEffect,this.updateFloat=this._updateFloatForEffect,this.updateFloat2=this._updateFloat2ForEffect,this.updateFloat3=this._updateFloat3ForEffect,this.updateFloat4=this._updateFloat4ForEffect,this.updateMatrix=this._updateMatrixForEffect,this.updateVector3=this._updateVector3ForEffect,this.updateVector4=this._updateVector4ForEffect,this.updateColor3=this._updateColor3ForEffect,this.updateColor4=this._updateColor4ForEffect):(this._engine._uniformBuffers.push(this),this.updateMatrix3x3=this._updateMatrix3x3ForUniform,this.updateMatrix2x2=this._updateMatrix2x2ForUniform,this.updateFloat=this._updateFloatForUniform,this.updateFloat2=this._updateFloat2ForUniform,this.updateFloat3=this._updateFloat3ForUniform,this.updateFloat4=this._updateFloat4ForUniform,this.updateMatrix=this._updateMatrixForUniform,this.updateVector3=this._updateVector3ForUniform,this.updateVector4=this._updateVector4ForUniform,this.updateColor3=this._updateColor3ForUniform,this.updateColor4=this._updateColor4ForUniform)}return Object.defineProperty(e.prototype,"useUbo",{get:function(){return!this._noUBO},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSync",{get:function(){return!this._needSync},enumerable:!0,configurable:!0}),e.prototype.isDynamic=function(){return void 0!==this._dynamic},e.prototype.getData=function(){return this._bufferData},e.prototype.getBuffer=function(){return this._buffer},e.prototype._fillAlignment=function(e){var t;if(t=e<=2?e:4,this._uniformLocationPointer%t!=0){var r=this._uniformLocationPointer;this._uniformLocationPointer+=t-this._uniformLocationPointer%t;for(var i=this._uniformLocationPointer-r,n=0;n<i;n++)this._data.push(0)}},e.prototype.addUniform=function(e,t){if(!this._noUBO&&void 0===this._uniformLocations[e]){var r;if(t instanceof Array)t=(r=t).length;else{t=t,r=[];for(var i=0;i<t;i++)r.push(0)}this._fillAlignment(t),this._uniformSizes[e]=t,this._uniformLocations[e]=this._uniformLocationPointer,this._uniformLocationPointer+=t;for(i=0;i<t;i++)this._data.push(r[i]);this._needSync=!0}},e.prototype.addMatrix=function(e,t){this.addUniform(e,Array.prototype.slice.call(t.toArray()))},e.prototype.addFloat2=function(e,t,r){var i=[t,r];this.addUniform(e,i)},e.prototype.addFloat3=function(e,t,r,i){var n=[t,r,i];this.addUniform(e,n)},e.prototype.addColor3=function(e,t){var r=new Array;t.toArray(r),this.addUniform(e,r)},e.prototype.addColor4=function(e,t,r){var i=new Array;t.toArray(i),i.push(r),this.addUniform(e,i)},e.prototype.addVector3=function(e,t){var r=new Array;t.toArray(r),this.addUniform(e,r)},e.prototype.addMatrix3x3=function(e){this.addUniform(e,12)},e.prototype.addMatrix2x2=function(e){this.addUniform(e,8)},e.prototype.create=function(){this._noUBO||this._buffer||(this._fillAlignment(4),this._bufferData=new Float32Array(this._data),this._rebuild(),this._needSync=!0)},e.prototype._rebuild=function(){this._noUBO||(this._dynamic?this._buffer=this._engine.createDynamicUniformBuffer(this._bufferData):this._buffer=this._engine.createUniformBuffer(this._bufferData))},e.prototype.update=function(){this._buffer?(this._dynamic||this._needSync)&&(this._engine.updateUniformBuffer(this._buffer,this._bufferData),this._needSync=!1):this.create()},e.prototype.updateUniform=function(e,t,r){var n=this._uniformLocations[e];if(void 0===n){if(this._buffer)return void i.a.Error("Cannot add an uniform after UBO has been created.");this.addUniform(e,r),n=this._uniformLocations[e]}if(this._buffer||this.create(),this._dynamic)for(s=0;s<r;s++)this._bufferData[n+s]=t[s];else{for(var o=!1,s=0;s<r;s++)this._bufferData[n+s]!==t[s]&&(o=!0,this._bufferData[n+s]=t[s]);this._needSync=this._needSync||o}},e.prototype._updateMatrix3x3ForUniform=function(t,r){for(var i=0;i<3;i++)e._tempBuffer[4*i]=r[3*i],e._tempBuffer[4*i+1]=r[3*i+1],e._tempBuffer[4*i+2]=r[3*i+2],e._tempBuffer[4*i+3]=0;this.updateUniform(t,e._tempBuffer,12)},e.prototype._updateMatrix3x3ForEffect=function(e,t){this._currentEffect.setMatrix3x3(e,t)},e.prototype._updateMatrix2x2ForEffect=function(e,t){this._currentEffect.setMatrix2x2(e,t)},e.prototype._updateMatrix2x2ForUniform=function(t,r){for(var i=0;i<2;i++)e._tempBuffer[4*i]=r[2*i],e._tempBuffer[4*i+1]=r[2*i+1],e._tempBuffer[4*i+2]=0,e._tempBuffer[4*i+3]=0;this.updateUniform(t,e._tempBuffer,8)},e.prototype._updateFloatForEffect=function(e,t){this._currentEffect.setFloat(e,t)},e.prototype._updateFloatForUniform=function(t,r){e._tempBuffer[0]=r,this.updateUniform(t,e._tempBuffer,1)},e.prototype._updateFloat2ForEffect=function(e,t,r,i){void 0===i&&(i=""),this._currentEffect.setFloat2(e+i,t,r)},e.prototype._updateFloat2ForUniform=function(t,r,i){e._tempBuffer[0]=r,e._tempBuffer[1]=i,this.updateUniform(t,e._tempBuffer,2)},e.prototype._updateFloat3ForEffect=function(e,t,r,i,n){void 0===n&&(n=""),this._currentEffect.setFloat3(e+n,t,r,i)},e.prototype._updateFloat3ForUniform=function(t,r,i,n){e._tempBuffer[0]=r,e._tempBuffer[1]=i,e._tempBuffer[2]=n,this.updateUniform(t,e._tempBuffer,3)},e.prototype._updateFloat4ForEffect=function(e,t,r,i,n,o){void 0===o&&(o=""),this._currentEffect.setFloat4(e+o,t,r,i,n)},e.prototype._updateFloat4ForUniform=function(t,r,i,n,o){e._tempBuffer[0]=r,e._tempBuffer[1]=i,e._tempBuffer[2]=n,e._tempBuffer[3]=o,this.updateUniform(t,e._tempBuffer,4)},e.prototype._updateMatrixForEffect=function(e,t){this._currentEffect.setMatrix(e,t)},e.prototype._updateMatrixForUniform=function(e,t){this.updateUniform(e,t.toArray(),16)},e.prototype._updateVector3ForEffect=function(e,t){this._currentEffect.setVector3(e,t)},e.prototype._updateVector3ForUniform=function(t,r){r.toArray(e._tempBuffer),this.updateUniform(t,e._tempBuffer,3)},e.prototype._updateVector4ForEffect=function(e,t){this._currentEffect.setVector4(e,t)},e.prototype._updateVector4ForUniform=function(t,r){r.toArray(e._tempBuffer),this.updateUniform(t,e._tempBuffer,4)},e.prototype._updateColor3ForEffect=function(e,t,r){void 0===r&&(r=""),this._currentEffect.setColor3(e+r,t)},e.prototype._updateColor3ForUniform=function(t,r){r.toArray(e._tempBuffer),this.updateUniform(t,e._tempBuffer,3)},e.prototype._updateColor4ForEffect=function(e,t,r,i){void 0===i&&(i=""),this._currentEffect.setColor4(e+i,t,r)},e.prototype._updateColor4ForUniform=function(t,r,i){r.toArray(e._tempBuffer),e._tempBuffer[3]=i,this.updateUniform(t,e._tempBuffer,4)},e.prototype.setTexture=function(e,t){this._currentEffect.setTexture(e,t)},e.prototype.updateUniformDirectly=function(e,t){this.updateUniform(e,t,t.length),this.update()},e.prototype.bindToEffect=function(e,t){this._currentEffect=e,!this._noUBO&&this._buffer&&e.bindUniformBuffer(this._buffer,t)},e.prototype.dispose=function(){if(!this._noUBO){var e=this._engine._uniformBuffers,t=e.indexOf(this);-1!==t&&(e[t]=e[e.length-1],e.pop()),this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)}},e._MAX_UNIFORM_SIZE=256,e._tempBuffer=new Float32Array(e._MAX_UNIFORM_SIZE),e}()}}]);