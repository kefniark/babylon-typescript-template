(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{103:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var i=n(5),r=n(7),o=n(0),a=n(11),s=n(9),u=function(){function t(e,n,u,c,h){void 0===c&&(c=null);var l=this;if(this.autoplay=!1,this.loop=!1,this.useCustomAttenuation=!1,this.isPlaying=!1,this.isPaused=!1,this.spatialSound=!1,this.refDistance=1,this.rolloffFactor=1,this.maxDistance=100,this.distanceModel="linear",this.onEndedObservable=new r.c,this._panningModel="equalpower",this._playbackRate=1,this._streaming=!1,this._startTime=0,this._startOffset=0,this._position=o.Vector3.Zero(),this._positionInEmitterSpace=!1,this._localDirection=new o.Vector3(1,0,0),this._volume=1,this._isReadyToPlay=!1,this._isDirectional=!1,this._coneInnerAngle=360,this._coneOuterAngle=360,this._coneOuterGain=0,this._isOutputConnected=!1,this._urlType="Unknown",this.name=e,this._scene=u,t._SceneComponentInitialization(u),this._readyToPlayCallback=c,this._customAttenuationFunction=function(t,e,n,i,r){return e<n?t*(1-e/n):0},h&&(this.autoplay=h.autoplay||!1,this.loop=h.loop||!1,void 0!==h.volume&&(this._volume=h.volume),this.spatialSound=h.spatialSound||!1,this.maxDistance=h.maxDistance||100,this.useCustomAttenuation=h.useCustomAttenuation||!1,this.rolloffFactor=h.rolloffFactor||1,this.refDistance=h.refDistance||1,this.distanceModel=h.distanceModel||"linear",this._playbackRate=h.playbackRate||1,this._streaming=h.streaming||!1),a.Engine.audioEngine.canUseWebAudio&&a.Engine.audioEngine.audioContext){this._soundGain=a.Engine.audioEngine.audioContext.createGain(),this._soundGain.gain.value=this._volume,this._inputAudioNode=this._soundGain,this._outputAudioNode=this._soundGain,this.spatialSound&&this._createSpatialParameters(),this._scene.mainSoundTrack.AddSound(this);var d=!0;if(n)try{"string"==typeof n?this._urlType="String":n instanceof ArrayBuffer?this._urlType="ArrayBuffer":n instanceof MediaStream?this._urlType="MediaStream":Array.isArray(n)&&(this._urlType="Array");var p=[],_=!1;switch(this._urlType){case"MediaStream":this._streaming=!0,this._isReadyToPlay=!0,this._streamingSource=a.Engine.audioEngine.audioContext.createMediaElementSource(n),this.autoplay&&this.play(),this._readyToPlayCallback&&this._readyToPlayCallback();break;case"ArrayBuffer":n.byteLength>0&&(_=!0,this._soundLoaded(n));break;case"String":p.push(n);case"Array":0===p.length&&(p=n);for(var g=0;g<p.length;g++){var f=p[g];if(-1!==f.indexOf(".mp3",f.length-4)&&a.Engine.audioEngine.isMP3supported&&(_=!0),-1!==f.indexOf(".ogg",f.length-4)&&a.Engine.audioEngine.isOGGsupported&&(_=!0),-1!==f.indexOf(".wav",f.length-4)&&(_=!0),-1!==f.indexOf("blob:")&&(_=!0),_){this._streaming?(this._htmlAudioElement=new Audio(f),this._htmlAudioElement.controls=!1,this._htmlAudioElement.loop=this.loop,i.h.SetCorsBehavior(f,this._htmlAudioElement),this._htmlAudioElement.preload="auto",this._htmlAudioElement.addEventListener("canplaythrough",function(){l._isReadyToPlay=!0,l.autoplay&&l.play(),l._readyToPlayCallback&&l._readyToPlayCallback()}),document.body.appendChild(this._htmlAudioElement),this._htmlAudioElement.load()):this._scene._loadFile(f,function(t){l._soundLoaded(t)},void 0,!0,!0,function(t){t&&s.a.Error("XHR "+t.status+" error on: "+f+"."),s.a.Error("Sound creation aborted."),l._scene.mainSoundTrack.RemoveSound(l)});break}}break;default:d=!1}d?_||(this._isReadyToPlay=!0,this._readyToPlayCallback&&window.setTimeout(function(){l._readyToPlayCallback&&l._readyToPlayCallback()},1e3)):s.a.Error("Parameter must be a URL to the sound, an Array of URLs (.mp3 & .ogg) or an ArrayBuffer of the sound.")}catch(t){s.a.Error("Unexpected error. Sound creation aborted."),this._scene.mainSoundTrack.RemoveSound(this)}}else this._scene.mainSoundTrack.AddSound(this),a.Engine.audioEngine.WarnedWebAudioUnsupported||(s.a.Error("Web Audio is not supported by your browser."),a.Engine.audioEngine.WarnedWebAudioUnsupported=!0),this._readyToPlayCallback&&window.setTimeout(function(){l._readyToPlayCallback&&l._readyToPlayCallback()},1e3)}return t.prototype.dispose=function(){a.Engine.audioEngine.canUseWebAudio&&(this.isPlaying&&this.stop(),this._isReadyToPlay=!1,-1===this.soundTrackId?this._scene.mainSoundTrack.RemoveSound(this):this._scene.soundTracks&&this._scene.soundTracks[this.soundTrackId].RemoveSound(this),this._soundGain&&(this._soundGain.disconnect(),this._soundGain=null),this._soundPanner&&(this._soundPanner.disconnect(),this._soundPanner=null),this._soundSource&&(this._soundSource.disconnect(),this._soundSource=null),this._audioBuffer=null,this._htmlAudioElement&&(this._htmlAudioElement.pause(),this._htmlAudioElement.src="",document.body.removeChild(this._htmlAudioElement)),this._streamingSource&&this._streamingSource.disconnect(),this._connectedTransformNode&&this._registerFunc&&(this._connectedTransformNode.unregisterAfterWorldMatrixUpdate(this._registerFunc),this._connectedTransformNode=null))},t.prototype.isReady=function(){return this._isReadyToPlay},t.prototype._soundLoaded=function(t){var e=this;a.Engine.audioEngine.audioContext&&a.Engine.audioEngine.audioContext.decodeAudioData(t,function(t){e._audioBuffer=t,e._isReadyToPlay=!0,e.autoplay&&e.play(),e._readyToPlayCallback&&e._readyToPlayCallback()},function(t){s.a.Error("Error while decoding audio data for: "+e.name+" / Error: "+t)})},t.prototype.setAudioBuffer=function(t){a.Engine.audioEngine.canUseWebAudio&&(this._audioBuffer=t,this._isReadyToPlay=!0)},t.prototype.updateOptions=function(t){t&&(this.loop=t.loop||this.loop,this.maxDistance=t.maxDistance||this.maxDistance,this.useCustomAttenuation=t.useCustomAttenuation||this.useCustomAttenuation,this.rolloffFactor=t.rolloffFactor||this.rolloffFactor,this.refDistance=t.refDistance||this.refDistance,this.distanceModel=t.distanceModel||this.distanceModel,this._playbackRate=t.playbackRate||this._playbackRate,this._updateSpatialParameters(),this.isPlaying&&(this._streaming&&this._htmlAudioElement?this._htmlAudioElement.playbackRate=this._playbackRate:this._soundSource&&(this._soundSource.playbackRate.value=this._playbackRate)))},t.prototype._createSpatialParameters=function(){a.Engine.audioEngine.canUseWebAudio&&a.Engine.audioEngine.audioContext&&(this._scene.headphone&&(this._panningModel="HRTF"),this._soundPanner=a.Engine.audioEngine.audioContext.createPanner(),this._updateSpatialParameters(),this._soundPanner.connect(this._outputAudioNode),this._inputAudioNode=this._soundPanner)},t.prototype._updateSpatialParameters=function(){this.spatialSound&&this._soundPanner&&(this.useCustomAttenuation?(this._soundPanner.distanceModel="linear",this._soundPanner.maxDistance=Number.MAX_VALUE,this._soundPanner.refDistance=1,this._soundPanner.rolloffFactor=1,this._soundPanner.panningModel=this._panningModel):(this._soundPanner.distanceModel=this.distanceModel,this._soundPanner.maxDistance=this.maxDistance,this._soundPanner.refDistance=this.refDistance,this._soundPanner.rolloffFactor=this.rolloffFactor,this._soundPanner.panningModel=this._panningModel))},t.prototype.switchPanningModelToHRTF=function(){this._panningModel="HRTF",this._switchPanningModel()},t.prototype.switchPanningModelToEqualPower=function(){this._panningModel="equalpower",this._switchPanningModel()},t.prototype._switchPanningModel=function(){a.Engine.audioEngine.canUseWebAudio&&this.spatialSound&&this._soundPanner&&(this._soundPanner.panningModel=this._panningModel)},t.prototype.connectToSoundTrackAudioNode=function(t){a.Engine.audioEngine.canUseWebAudio&&(this._isOutputConnected&&this._outputAudioNode.disconnect(),this._outputAudioNode.connect(t),this._isOutputConnected=!0)},t.prototype.setDirectionalCone=function(t,e,n){e<t?s.a.Error("setDirectionalCone(): outer angle of the cone must be superior or equal to the inner angle."):(this._coneInnerAngle=t,this._coneOuterAngle=e,this._coneOuterGain=n,this._isDirectional=!0,this.isPlaying&&this.loop&&(this.stop(),this.play()))},Object.defineProperty(t.prototype,"directionalConeInnerAngle",{get:function(){return this._coneInnerAngle},set:function(t){if(t!=this._coneInnerAngle){if(this._coneOuterAngle<t)return void s.a.Error("directionalConeInnerAngle: outer angle of the cone must be superior or equal to the inner angle.");this._coneInnerAngle=t,a.Engine.audioEngine.canUseWebAudio&&this.spatialSound&&this._soundPanner&&(this._soundPanner.coneInnerAngle=this._coneInnerAngle)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"directionalConeOuterAngle",{get:function(){return this._coneOuterAngle},set:function(t){if(t!=this._coneOuterAngle){if(t<this._coneInnerAngle)return void s.a.Error("directionalConeOuterAngle: outer angle of the cone must be superior or equal to the inner angle.");this._coneOuterAngle=t,a.Engine.audioEngine.canUseWebAudio&&this.spatialSound&&this._soundPanner&&(this._soundPanner.coneOuterAngle=this._coneOuterAngle)}},enumerable:!0,configurable:!0}),t.prototype.setPosition=function(t){this._position=t,a.Engine.audioEngine.canUseWebAudio&&this.spatialSound&&this._soundPanner&&!isNaN(this._position.x)&&!isNaN(this._position.y)&&!isNaN(this._position.z)&&this._soundPanner.setPosition(this._position.x,this._position.y,this._position.z)},t.prototype.setLocalDirectionToMesh=function(t){this._localDirection=t,a.Engine.audioEngine.canUseWebAudio&&this._connectedTransformNode&&this.isPlaying&&this._updateDirection()},t.prototype._updateDirection=function(){if(this._connectedTransformNode&&this._soundPanner){var t=this._connectedTransformNode.getWorldMatrix(),e=o.Vector3.TransformNormal(this._localDirection,t);e.normalize(),this._soundPanner.setOrientation(e.x,e.y,e.z)}},t.prototype.updateDistanceFromListener=function(){if(a.Engine.audioEngine.canUseWebAudio&&this._connectedTransformNode&&this.useCustomAttenuation&&this._soundGain&&this._scene.activeCamera){var t=this._connectedTransformNode.getDistanceToCamera(this._scene.activeCamera);this._soundGain.gain.value=this._customAttenuationFunction(this._volume,t,this.maxDistance,this.refDistance,this.rolloffFactor)}},t.prototype.setAttenuationFunction=function(t){this._customAttenuationFunction=t},t.prototype.play=function(t,e){var n=this;if(this._isReadyToPlay&&this._scene.audioEnabled&&a.Engine.audioEngine.audioContext)try{this._startOffset<0&&(t=-this._startOffset,this._startOffset=0);var i=t?a.Engine.audioEngine.audioContext.currentTime+t:a.Engine.audioEngine.audioContext.currentTime;if(this._soundSource&&this._streamingSource||this.spatialSound&&this._soundPanner&&(isNaN(this._position.x)||isNaN(this._position.y)||isNaN(this._position.z)||this._soundPanner.setPosition(this._position.x,this._position.y,this._position.z),this._isDirectional&&(this._soundPanner.coneInnerAngle=this._coneInnerAngle,this._soundPanner.coneOuterAngle=this._coneOuterAngle,this._soundPanner.coneOuterGain=this._coneOuterGain,this._connectedTransformNode?this._updateDirection():this._soundPanner.setOrientation(this._localDirection.x,this._localDirection.y,this._localDirection.z))),this._streaming){if(this._streamingSource||(this._streamingSource=a.Engine.audioEngine.audioContext.createMediaElementSource(this._htmlAudioElement),this._htmlAudioElement.onended=function(){n._onended()},this._htmlAudioElement.playbackRate=this._playbackRate),this._streamingSource.disconnect(),this._streamingSource.connect(this._inputAudioNode),this._htmlAudioElement){var r=function(){if(a.Engine.audioEngine.unlocked){var t=n._htmlAudioElement.play();void 0!==t&&t.catch(function(t){a.Engine.audioEngine.lock(),a.Engine.audioEngine.onAudioUnlockedObservable.addOnce(function(){r()})})}else a.Engine.audioEngine.onAudioUnlockedObservable.addOnce(function(){r()})};r()}}else this._soundSource=a.Engine.audioEngine.audioContext.createBufferSource(),this._soundSource.buffer=this._audioBuffer,this._soundSource.connect(this._inputAudioNode),this._soundSource.loop=this.loop,this._soundSource.playbackRate.value=this._playbackRate,this._soundSource.onended=function(){n._onended()},this._soundSource.buffer&&this._soundSource.start(i,this.isPaused?this._startOffset%this._soundSource.buffer.duration:e||0);this._startTime=i,this.isPlaying=!0,this.isPaused=!1}catch(t){s.a.Error("Error while trying to play audio: "+this.name+", "+t.message)}},t.prototype._onended=function(){this.isPlaying=!1,this.onended&&this.onended(),this.onEndedObservable.notifyObservers(this)},t.prototype.stop=function(t){if(this.isPlaying){if(this._streaming)this._htmlAudioElement?(this._htmlAudioElement.pause(),this._htmlAudioElement.currentTime>0&&(this._htmlAudioElement.currentTime=0)):this._streamingSource.disconnect();else if(a.Engine.audioEngine.audioContext&&this._soundSource){var e=t?a.Engine.audioEngine.audioContext.currentTime+t:a.Engine.audioEngine.audioContext.currentTime;this._soundSource.stop(e),this._soundSource.onended=function(){},this.isPaused||(this._startOffset=0)}this.isPlaying=!1}},t.prototype.pause=function(){this.isPlaying&&(this.isPaused=!0,this._streaming?this._htmlAudioElement?this._htmlAudioElement.pause():this._streamingSource.disconnect():a.Engine.audioEngine.audioContext&&(this.stop(0),this._startOffset+=a.Engine.audioEngine.audioContext.currentTime-this._startTime))},t.prototype.setVolume=function(t,e){a.Engine.audioEngine.canUseWebAudio&&this._soundGain&&(e&&a.Engine.audioEngine.audioContext?(this._soundGain.gain.cancelScheduledValues(a.Engine.audioEngine.audioContext.currentTime),this._soundGain.gain.setValueAtTime(this._soundGain.gain.value,a.Engine.audioEngine.audioContext.currentTime),this._soundGain.gain.linearRampToValueAtTime(t,a.Engine.audioEngine.audioContext.currentTime+e)):this._soundGain.gain.value=t),this._volume=t},t.prototype.setPlaybackRate=function(t){this._playbackRate=t,this.isPlaying&&(this._streaming&&this._htmlAudioElement?this._htmlAudioElement.playbackRate=this._playbackRate:this._soundSource&&(this._soundSource.playbackRate.value=this._playbackRate))},t.prototype.getVolume=function(){return this._volume},t.prototype.attachToMesh=function(t){var e=this;this._connectedTransformNode&&this._registerFunc&&(this._connectedTransformNode.unregisterAfterWorldMatrixUpdate(this._registerFunc),this._registerFunc=null),this._connectedTransformNode=t,this.spatialSound||(this.spatialSound=!0,this._createSpatialParameters(),this.isPlaying&&this.loop&&(this.stop(),this.play())),this._onRegisterAfterWorldMatrixUpdate(this._connectedTransformNode),this._registerFunc=function(t){return e._onRegisterAfterWorldMatrixUpdate(t)},this._connectedTransformNode.registerAfterWorldMatrixUpdate(this._registerFunc)},t.prototype.detachFromMesh=function(){this._connectedTransformNode&&this._registerFunc&&(this._connectedTransformNode.unregisterAfterWorldMatrixUpdate(this._registerFunc),this._registerFunc=null,this._connectedTransformNode=null)},t.prototype._onRegisterAfterWorldMatrixUpdate=function(t){if(t.getBoundingInfo){var e=t;if(this._positionInEmitterSpace)e.worldMatrixFromCache.invertToRef(o.Tmp.Matrix[0]),this.setPosition(o.Tmp.Matrix[0].getTranslation());else{var n=e.getBoundingInfo();this.setPosition(n.boundingSphere.centerWorld)}a.Engine.audioEngine.canUseWebAudio&&this._isDirectional&&this.isPlaying&&this._updateDirection()}},t.prototype.clone=function(){var e=this;if(this._streaming)return null;var n=function(){e._isReadyToPlay?(r._audioBuffer=e.getAudioBuffer(),r._isReadyToPlay=!0,r.autoplay&&r.play()):window.setTimeout(n,300)},i={autoplay:this.autoplay,loop:this.loop,volume:this._volume,spatialSound:this.spatialSound,maxDistance:this.maxDistance,useCustomAttenuation:this.useCustomAttenuation,rolloffFactor:this.rolloffFactor,refDistance:this.refDistance,distanceModel:this.distanceModel},r=new t(this.name+"_cloned",new ArrayBuffer(0),this._scene,null,i);return this.useCustomAttenuation&&r.setAttenuationFunction(this._customAttenuationFunction),r.setPosition(this._position),r.setPlaybackRate(this._playbackRate),n(),r},t.prototype.getAudioBuffer=function(){return this._audioBuffer},t.prototype.serialize=function(){var t={name:this.name,url:this.name,autoplay:this.autoplay,loop:this.loop,volume:this._volume,spatialSound:this.spatialSound,maxDistance:this.maxDistance,rolloffFactor:this.rolloffFactor,refDistance:this.refDistance,distanceModel:this.distanceModel,playbackRate:this._playbackRate,panningModel:this._panningModel,soundTrackId:this.soundTrackId};return this.spatialSound&&(this._connectedTransformNode&&(t.connectedMeshId=this._connectedTransformNode.id),t.position=this._position.asArray(),t.refDistance=this.refDistance,t.distanceModel=this.distanceModel,t.isDirectional=this._isDirectional,t.localDirectionToMesh=this._localDirection.asArray(),t.coneInnerAngle=this._coneInnerAngle,t.coneOuterAngle=this._coneOuterAngle,t.coneOuterGain=this._coneOuterGain),t},t.Parse=function(e,n,i,r){var a,s=e.name;a=e.url?i+e.url:i+s;var u,c={autoplay:e.autoplay,loop:e.loop,volume:e.volume,spatialSound:e.spatialSound,maxDistance:e.maxDistance,rolloffFactor:e.rolloffFactor,refDistance:e.refDistance,distanceModel:e.distanceModel,playbackRate:e.playbackRate};if(r){var h=function(){r._isReadyToPlay?(u._audioBuffer=r.getAudioBuffer(),u._isReadyToPlay=!0,u.autoplay&&u.play()):window.setTimeout(h,300)};u=new t(s,new ArrayBuffer(0),n,null,c),h()}else u=new t(s,a,n,function(){n._removePendingData(u)},c),n._addPendingData(u);if(e.position){var l=o.Vector3.FromArray(e.position);u.setPosition(l)}if(e.isDirectional&&(u.setDirectionalCone(e.coneInnerAngle||360,e.coneOuterAngle||360,e.coneOuterGain||0),e.localDirectionToMesh)){var d=o.Vector3.FromArray(e.localDirectionToMesh);u.setLocalDirectionToMesh(d)}if(e.connectedMeshId){var p=n.getMeshByID(e.connectedMeshId);p&&u.attachToMesh(p)}return u},t._SceneComponentInitialization=function(t){throw"Import AudioSceneComponent before creating sound."},t}()},126:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"a",function(){return s});var i=n(16),r=n(7),o=n(21),a=function(){return function(){}}(),s=function(){function t(t,e){void 0===e&&(e=null),this.name=t,this._targetedAnimations=new Array,this._animatables=new Array,this._from=Number.MAX_VALUE,this._to=-Number.MAX_VALUE,this._speedRatio=1,this.onAnimationEndObservable=new r.c,this.onAnimationLoopObservable=new r.c,this.onAnimationGroupEndObservable=new r.c,this.onAnimationGroupPauseObservable=new r.c,this.onAnimationGroupPlayObservable=new r.c,this._scene=e||o.a.LastCreatedScene,this.uniqueId=this._scene.getUniqueId(),this._scene.animationGroups.push(this)}return Object.defineProperty(t.prototype,"from",{get:function(){return this._from},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this._to},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isStarted",{get:function(){return this._isStarted},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlaying",{get:function(){return this._isStarted&&!this._isPaused},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speedRatio",{get:function(){return this._speedRatio},set:function(t){if(this._speedRatio!==t){this._speedRatio=t;for(var e=0;e<this._animatables.length;e++){this._animatables[e].speedRatio=this._speedRatio}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targetedAnimations",{get:function(){return this._targetedAnimations},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animatables",{get:function(){return this._animatables},enumerable:!0,configurable:!0}),t.prototype.addTargetedAnimation=function(t,e){var n={animation:t,target:e},i=t.getKeys();return this._from>i[0].frame&&(this._from=i[0].frame),this._to<i[i.length-1].frame&&(this._to=i[i.length-1].frame),this._targetedAnimations.push(n),n},t.prototype.normalize=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),null==t&&(t=this._from),null==e&&(e=this._to);for(var n=0;n<this._targetedAnimations.length;n++){var i=this._targetedAnimations[n].animation.getKeys(),r=i[0],o=i[i.length-1];if(r.frame>t){var a={frame:t,value:r.value,inTangent:r.inTangent,outTangent:r.outTangent,interpolation:r.interpolation};i.splice(0,0,a)}if(o.frame<e){a={frame:e,value:o.value,inTangent:o.outTangent,outTangent:o.outTangent,interpolation:o.interpolation};i.push(a)}}return this._from=t,this._to=e,this},t.prototype.start=function(t,e,n,i){var r=this;if(void 0===t&&(t=!1),void 0===e&&(e=1),this._isStarted||0===this._targetedAnimations.length)return this;for(var o=function(o){var s=a._scene.beginDirectAnimation(o.target,[o.animation],void 0!==n?n:a._from,void 0!==i?i:a._to,t,e);s.onAnimationEnd=function(){r.onAnimationEndObservable.notifyObservers(o),r._checkAnimationGroupEnded(s)},s.onAnimationLoop=function(){r.onAnimationLoopObservable.notifyObservers(o)},a._animatables.push(s)},a=this,s=0,u=this._targetedAnimations;s<u.length;s++){o(u[s])}return this._speedRatio=e,void 0!==n&&void 0!==i&&n>i&&this._speedRatio>0&&(this._speedRatio=-e),this._isStarted=!0,this._isPaused=!1,this.onAnimationGroupPlayObservable.notifyObservers(this),this},t.prototype.pause=function(){if(!this._isStarted)return this;this._isPaused=!0;for(var t=0;t<this._animatables.length;t++){this._animatables[t].pause()}return this.onAnimationGroupPauseObservable.notifyObservers(this),this},t.prototype.play=function(t){if(this.isStarted&&this._animatables.length===this._targetedAnimations.length){if(void 0!==t)for(var e=0;e<this._animatables.length;e++){this._animatables[e].loopAnimation=t}this.restart()}else this.stop(),this.start(t,this._speedRatio);return this._isPaused=!1,this},t.prototype.reset=function(){if(!this._isStarted)return this;for(var t=0;t<this._animatables.length;t++){this._animatables[t].reset()}return this},t.prototype.restart=function(){if(!this._isStarted)return this;for(var t=0;t<this._animatables.length;t++){this._animatables[t].restart()}return this.onAnimationGroupPlayObservable.notifyObservers(this),this},t.prototype.stop=function(){if(!this._isStarted)return this;for(var t=this._animatables.slice(),e=0;e<t.length;e++)t[e].stop();return this._isStarted=!1,this},t.prototype.setWeightForAllAnimatables=function(t){for(var e=0;e<this._animatables.length;e++){this._animatables[e].weight=t}return this},t.prototype.syncAllAnimationsWith=function(t){for(var e=0;e<this._animatables.length;e++){this._animatables[e].syncWith(t)}return this},t.prototype.goToFrame=function(t){if(!this._isStarted)return this;for(var e=0;e<this._animatables.length;e++){this._animatables[e].goToFrame(t)}return this},t.prototype.dispose=function(){this._targetedAnimations=[],this._animatables=[];var t=this._scene.animationGroups.indexOf(this);t>-1&&this._scene.animationGroups.splice(t,1),this.onAnimationEndObservable.clear(),this.onAnimationGroupEndObservable.clear(),this.onAnimationGroupPauseObservable.clear(),this.onAnimationGroupPlayObservable.clear(),this.onAnimationLoopObservable.clear()},t.prototype._checkAnimationGroupEnded=function(t){var e=this._animatables.indexOf(t);e>-1&&this._animatables.splice(e,1),0===this._animatables.length&&(this._isStarted=!1,this.onAnimationGroupEndObservable.notifyObservers(this))},t.Parse=function(e,n){for(var r=new t(e.name,n),o=0;o<e.targetedAnimations.length;o++){var a=e.targetedAnimations[o],s=i.a.Parse(a.animation),u=a.targetId;if("influence"===a.animation.property){var c=n.getMorphTargetById(u);c&&r.addTargetedAnimation(s,c)}else{var h=n.getNodeByID(u);null!=h&&r.addTargetedAnimation(s,h)}}return null!==e.from&&null!==e.from&&r.normalize(e.from,e.to),r},t.prototype.getClassName=function(){return"AnimationGroup"},t.prototype.toString=function(t){var e="Name: "+this.name;return e+=", type: "+this.getClassName(),t&&(e+=", from: "+this._from,e+=", to: "+this._to,e+=", isStarted: "+this._isStarted,e+=", speedRatio: "+this._speedRatio,e+=", targetedAnimations length: "+this._targetedAnimations.length,e+=", animatables length: "+this._animatables),e},t}()},138:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"d",function(){return s}),n.d(e,"b",function(){return u}),n.d(e,"c",function(){return c});var i=n(1),r=n(33),o=n(26),a=function(){function t(t){this._actionManager=t}return t.prototype.isValid=function(){return!0},t.prototype._getProperty=function(t){return this._actionManager._getProperty(t)},t.prototype._getEffectiveTarget=function(t,e){return this._actionManager._getEffectiveTarget(t,e)},t.prototype.serialize=function(){},t.prototype._serialize=function(t){return{type:2,children:[],name:t.name,properties:t.properties}},t}(),s=function(t){function e(n,i,r,o,a){void 0===a&&(a=e.IsEqual);var s=t.call(this,n)||this;return s.propertyPath=r,s.value=o,s.operator=a,s._target=i,s._effectiveTarget=s._getEffectiveTarget(i,s.propertyPath),s._property=s._getProperty(s.propertyPath),s}return i.d(e,t),Object.defineProperty(e,"IsEqual",{get:function(){return e._IsEqual},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsDifferent",{get:function(){return e._IsDifferent},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsGreater",{get:function(){return e._IsGreater},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsLesser",{get:function(){return e._IsLesser},enumerable:!0,configurable:!0}),e.prototype.isValid=function(){switch(this.operator){case e.IsGreater:return this._effectiveTarget[this._property]>this.value;case e.IsLesser:return this._effectiveTarget[this._property]<this.value;case e.IsEqual:case e.IsDifferent:var t;return t=this.value.equals?this.value.equals(this._effectiveTarget[this._property]):this.value===this._effectiveTarget[this._property],this.operator===e.IsEqual?t:!t}return!1},e.prototype.serialize=function(){return this._serialize({name:"ValueCondition",properties:[r.a._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:r.a._SerializeValueAsString(this.value)},{name:"operator",value:e.GetOperatorName(this.operator)}]})},e.GetOperatorName=function(t){switch(t){case e._IsEqual:return"IsEqual";case e._IsDifferent:return"IsDifferent";case e._IsGreater:return"IsGreater";case e._IsLesser:return"IsLesser";default:return""}},e._IsEqual=0,e._IsDifferent=1,e._IsGreater=2,e._IsLesser=3,e}(a),u=function(t){function e(e,n){var i=t.call(this,e)||this;return i.predicate=n,i}return i.d(e,t),e.prototype.isValid=function(){return this.predicate()},e}(a),c=function(t){function e(e,n,i){var r=t.call(this,e)||this;return r.value=i,r._target=n,r}return i.d(e,t),e.prototype.isValid=function(){return this._target.state===this.value},e.prototype.serialize=function(){return this._serialize({name:"StateCondition",properties:[r.a._GetTargetProperty(this._target),{name:"value",value:this.value}]})},e}(a);o.a.RegisteredTypes["BABYLON.ValueCondition"]=s,o.a.RegisteredTypes["BABYLON.PredicateCondition"]=u,o.a.RegisteredTypes["BABYLON.StateCondition"]=c},144:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n(161),r=n(7),o=function(){function t(t,e,n,i,o,a,s,u,c){void 0===n&&(n=0),void 0===i&&(i=100),void 0===o&&(o=!1),void 0===a&&(a=1),this.target=e,this.fromFrame=n,this.toFrame=i,this.loopAnimation=o,this.onAnimationEnd=s,this.onAnimationLoop=c,this._localDelayOffset=null,this._pausedDelay=null,this._runtimeAnimations=new Array,this._paused=!1,this._speedRatio=1,this._weight=-1,this.disposeOnEnd=!0,this.animationStarted=!1,this.onAnimationEndObservable=new r.c,this.onAnimationLoopObservable=new r.c,this._scene=t,u&&this.appendAnimations(e,u),this._speedRatio=a,t._activeAnimatables.push(this)}return Object.defineProperty(t.prototype,"syncRoot",{get:function(){return this._syncRoot},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"masterFrame",{get:function(){return 0===this._runtimeAnimations.length?0:this._runtimeAnimations[0].currentFrame},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){return this._weight},set:function(t){this._weight=-1!==t?Math.min(Math.max(t,0),1):-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speedRatio",{get:function(){return this._speedRatio},set:function(t){for(var e=0;e<this._runtimeAnimations.length;e++){this._runtimeAnimations[e]._prepareForSpeedRatioChange(t)}this._speedRatio=t},enumerable:!0,configurable:!0}),t.prototype.syncWith=function(t){if(this._syncRoot=t,t){var e=this._scene._activeAnimatables.indexOf(this);e>-1&&(this._scene._activeAnimatables.splice(e,1),this._scene._activeAnimatables.push(this))}return this},t.prototype.getAnimations=function(){return this._runtimeAnimations},t.prototype.appendAnimations=function(t,e){for(var n=0;n<e.length;n++){var r=e[n];this._runtimeAnimations.push(new i.a(t,r,this._scene,this))}},t.prototype.getAnimationByTargetProperty=function(t){for(var e=this._runtimeAnimations,n=0;n<e.length;n++)if(e[n].animation.targetProperty===t)return e[n].animation;return null},t.prototype.getRuntimeAnimationByTargetProperty=function(t){for(var e=this._runtimeAnimations,n=0;n<e.length;n++)if(e[n].animation.targetProperty===t)return e[n];return null},t.prototype.reset=function(){for(var t=this._runtimeAnimations,e=0;e<t.length;e++)t[e].reset(!0);this._localDelayOffset=null,this._pausedDelay=null},t.prototype.enableBlending=function(t){for(var e=this._runtimeAnimations,n=0;n<e.length;n++)e[n].animation.enableBlending=!0,e[n].animation.blendingSpeed=t},t.prototype.disableBlending=function(){for(var t=this._runtimeAnimations,e=0;e<t.length;e++)t[e].animation.enableBlending=!1},t.prototype.goToFrame=function(t){var e=this._runtimeAnimations;if(e[0]){var n=e[0].animation.framePerSecond,i=1e3*(t-e[0].currentFrame)/(n*this.speedRatio);null===this._localDelayOffset&&(this._localDelayOffset=0),this._localDelayOffset-=i}for(var r=0;r<e.length;r++)e[r].goToFrame(t)},t.prototype.pause=function(){this._paused||(this._paused=!0)},t.prototype.restart=function(){this._paused=!1},t.prototype._raiseOnAnimationEnd=function(){this.onAnimationEnd&&this.onAnimationEnd(),this.onAnimationEndObservable.notifyObservers(this)},t.prototype.stop=function(t,e){if(t||e){var n=this._scene._activeAnimatables.indexOf(this);if(n>-1){for(var i=(o=this._runtimeAnimations).length-1;i>=0;i--){var r=o[i];t&&r.animation.name!=t||(e&&!e(r.target)||(r.dispose(),o.splice(i,1)))}0==o.length&&(this._scene._activeAnimatables.splice(n,1),this._raiseOnAnimationEnd())}}else{if((i=this._scene._activeAnimatables.indexOf(this))>-1){this._scene._activeAnimatables.splice(i,1);var o=this._runtimeAnimations;for(i=0;i<o.length;i++)o[i].dispose();this._raiseOnAnimationEnd()}}},t.prototype.waitAsync=function(){var t=this;return new Promise(function(e,n){t.onAnimationEndObservable.add(function(){e(t)},void 0,void 0,t,!0)})},t.prototype._animate=function(t){var e=this;if(this._paused)return this.animationStarted=!1,null===this._pausedDelay&&(this._pausedDelay=t),!0;if(null===this._localDelayOffset?(this._localDelayOffset=t,this._pausedDelay=null):null!==this._pausedDelay&&(this._localDelayOffset+=t-this._pausedDelay,this._pausedDelay=null),0===this._weight)return!0;var n,i=!1,r=this._runtimeAnimations;for(n=0;n<r.length;n++){var o=r[n].animate(t-this._localDelayOffset,this.fromFrame,this.toFrame,this.loopAnimation,this._speedRatio,this._weight,function(){e.onAnimationLoopObservable.notifyObservers(e),e.onAnimationLoop&&e.onAnimationLoop()});i=i||o}if(this.animationStarted=i,!i){if(this.disposeOnEnd)for(n=this._scene._activeAnimatables.indexOf(this),this._scene._activeAnimatables.splice(n,1),n=0;n<r.length;n++)r[n].dispose();this._raiseOnAnimationEnd(),this.disposeOnEnd&&(this.onAnimationEnd=null,this.onAnimationLoop=null,this.onAnimationLoopObservable.clear(),this.onAnimationEndObservable.clear())}return i},t}()},159:function(t,e,n){"use strict";n.d(e,"j",function(){return c}),n.d(e,"g",function(){return h}),n.d(e,"h",function(){return l}),n.d(e,"d",function(){return d}),n.d(e,"e",function(){return p}),n.d(e,"i",function(){return _}),n.d(e,"b",function(){return g}),n.d(e,"a",function(){return f}),n.d(e,"c",function(){return m}),n.d(e,"f",function(){return y});var i=n(1),r=n(9),o=n(0),a=n(33),s=n(4),u=n(26),c=function(t){function e(e,n,i,r){var o=t.call(this,e,r)||this;return o.propertyPath=i,o._target=o._effectiveTarget=n,o}return i.d(e,t),e.prototype._prepare=function(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath)},e.prototype.execute=function(){this._effectiveTarget[this._property]=!this._effectiveTarget[this._property]},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"SwitchBooleanAction",properties:[a.a._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath}]},e)},e}(a.a),h=function(t){function e(e,n,i,r){var o=t.call(this,e,r)||this;return o.value=i,o._target=n,o}return i.d(e,t),e.prototype.execute=function(){this._target.state=this.value},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"SetStateAction",properties:[a.a._GetTargetProperty(this._target),{name:"value",value:this.value}]},e)},e}(a.a),l=function(t){function e(e,n,i,r,o){var a=t.call(this,e,o)||this;return a.propertyPath=i,a.value=r,a._target=a._effectiveTarget=n,a}return i.d(e,t),e.prototype._prepare=function(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath)},e.prototype.execute=function(){this._effectiveTarget[this._property]=this.value,this._target.markAsDirty&&this._target.markAsDirty(this._property)},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"SetValueAction",properties:[a.a._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:a.a._SerializeValueAsString(this.value)}]},e)},e}(a.a),d=function(t){function e(e,n,i,r,o){var a=t.call(this,e,o)||this;return a.propertyPath=i,a.value=r,a._target=a._effectiveTarget=n,a}return i.d(e,t),e.prototype._prepare=function(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath),"number"!=typeof this._effectiveTarget[this._property]&&r.a.Warn("Warning: IncrementValueAction can only be used with number values")},e.prototype.execute=function(){this._effectiveTarget[this._property]+=this.value,this._target.markAsDirty&&this._target.markAsDirty(this._property)},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"IncrementValueAction",properties:[a.a._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:a.a._SerializeValueAsString(this.value)}]},e)},e}(a.a),p=function(t){function e(e,n,i,r,o,a){var s=t.call(this,e,a)||this;return s.from=i,s.to=r,s.loop=o,s._target=n,s}return i.d(e,t),e.prototype._prepare=function(){},e.prototype.execute=function(){this._actionManager.getScene().beginAnimation(this._target,this.from,this.to,this.loop)},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"PlayAnimationAction",properties:[a.a._GetTargetProperty(this._target),{name:"from",value:String(this.from)},{name:"to",value:String(this.to)},{name:"loop",value:a.a._SerializeValueAsString(this.loop)||!1}]},e)},e}(a.a),_=function(t){function e(e,n,i){var r=t.call(this,e,i)||this;return r._target=n,r}return i.d(e,t),e.prototype._prepare=function(){},e.prototype.execute=function(){this._actionManager.getScene().stopAnimation(this._target)},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"StopAnimationAction",properties:[a.a._GetTargetProperty(this._target)]},e)},e}(a.a),g=function(t){function e(e,n){return void 0===e&&(e=s.a.ACTION_NothingTrigger),t.call(this,e,n)||this}return i.d(e,t),e.prototype.execute=function(){},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"DoNothingAction",properties:[]},e)},e}(a.a),f=function(t){function e(e,n,i){var r=t.call(this,e,i)||this;return r.children=n,r}return i.d(e,t),e.prototype._prepare=function(){for(var t=0;t<this.children.length;t++)this.children[t]._actionManager=this._actionManager,this.children[t]._prepare()},e.prototype.execute=function(t){for(var e=0;e<this.children.length;e++)this.children[e].execute(t)},e.prototype.serialize=function(e){for(var n=t.prototype._serialize.call(this,{name:"CombineAction",properties:[],combine:[]},e),i=0;i<this.children.length;i++)n.combine.push(this.children[i].serialize(null));return n},e}(a.a),m=function(t){function e(e,n,i){var r=t.call(this,e,i)||this;return r.func=n,r}return i.d(e,t),e.prototype.execute=function(t){this.func(t)},e}(a.a),y=function(t){function e(e,n,i,r){var o=t.call(this,e,r)||this;return o._target=n,o._parent=i,o}return i.d(e,t),e.prototype._prepare=function(){},e.prototype.execute=function(){if(this._target.parent!==this._parent){var t=this._parent.getWorldMatrix().clone();t.invert(),this._target.position=o.Vector3.TransformCoordinates(this._target.position,t),this._target.parent=this._parent}},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"SetParentAction",properties:[a.a._GetTargetProperty(this._target),a.a._GetTargetProperty(this._parent)]},e)},e}(a.a);u.a.RegisteredTypes["BABYLON.SetParentAction"]=y,u.a.RegisteredTypes["BABYLON.ExecuteCodeAction"]=m,u.a.RegisteredTypes["BABYLON.DoNothingAction"]=g,u.a.RegisteredTypes["BABYLON.StopAnimationAction"]=_,u.a.RegisteredTypes["BABYLON.PlayAnimationAction"]=p,u.a.RegisteredTypes["BABYLON.IncrementValueAction"]=d,u.a.RegisteredTypes["BABYLON.SetValueAction"]=l,u.a.RegisteredTypes["BABYLON.SetStateAction"]=h,u.a.RegisteredTypes["BABYLON.SetParentAction"]=y},16:function(t,e,n){"use strict";n.d(e,"d",function(){return c}),n.d(e,"b",function(){return h}),n.d(e,"e",function(){return l}),n.d(e,"c",function(){return i}),n.d(e,"a",function(){return d});var i,r=n(0),o=n(12),a=n(25),s=n(6),u=n(2),c=function(){function t(t,e,n){this.name=t,this.from=e,this.to=n}return t.prototype.clone=function(){return new t(this.name,this.from,this.to)},t}(),h=function(){function t(t,e,n){this.frame=t,this.action=e,this.onlyOnce=n,this.isDone=!1}return t.prototype._clone=function(){return new t(this.frame,this.action,this.onlyOnce)},t}(),l=function(){function t(t){this.path=t,this._onchange=new Array,this.value=0,this.animations=new Array}return t.prototype.getPoint=function(){var t=this.path.getPointAtLengthPosition(this.value);return new r.Vector3(t.x,0,t.y)},t.prototype.moveAhead=function(t){return void 0===t&&(t=.002),this.move(t),this},t.prototype.moveBack=function(t){return void 0===t&&(t=.002),this.move(-t),this},t.prototype.move=function(t){if(Math.abs(t)>1)throw"step size should be less than 1.";return this.value+=t,this.ensureLimits(),this.raiseOnChange(),this},t.prototype.ensureLimits=function(){for(;this.value>1;)this.value-=1;for(;this.value<0;)this.value+=1;return this},t.prototype.raiseOnChange=function(){var t=this;return this._onchange.forEach(function(e){return e(t)}),this},t.prototype.onchange=function(t){return this._onchange.push(t),this},t}();!function(t){t[t.STEP=1]="STEP"}(i||(i={}));var d=function(){function t(e,n,i,r,o,a){this.name=e,this.targetProperty=n,this.framePerSecond=i,this.dataType=r,this.loopMode=o,this.enableBlending=a,this._runtimeAnimations=new Array,this._events=new Array,this.blendingSpeed=.01,this._ranges={},this.targetPropertyPath=n.split("."),this.dataType=r,this.loopMode=void 0===o?t.ANIMATIONLOOPMODE_CYCLE:o}return t._PrepareAnimation=function(e,n,i,o,a,s,u,c){var h=void 0;if(!isNaN(parseFloat(a))&&isFinite(a)?h=t.ANIMATIONTYPE_FLOAT:a instanceof r.Quaternion?h=t.ANIMATIONTYPE_QUATERNION:a instanceof r.Vector3?h=t.ANIMATIONTYPE_VECTOR3:a instanceof r.Vector2?h=t.ANIMATIONTYPE_VECTOR2:a instanceof r.Color3?h=t.ANIMATIONTYPE_COLOR3:a instanceof r.Size&&(h=t.ANIMATIONTYPE_SIZE),null==h)return null;var l=new t(e,n,i,h,u),d=[{frame:0,value:a},{frame:o,value:s}];return l.setKeys(d),void 0!==c&&l.setEasingFunction(c),l},t.CreateAnimation=function(e,n,i,r){var o=new t(e+"Animation",e,i,n,t.ANIMATIONLOOPMODE_CONSTANT);return o.setEasingFunction(r),o},t.CreateAndStartAnimation=function(e,n,i,r,o,a,s,u,c,h){var l=t._PrepareAnimation(e,i,r,o,a,s,u,c);return l?n.getScene().beginDirectAnimation(n,[l],0,o,1===l.loopMode,1,h):null},t.CreateAndStartHierarchyAnimation=function(e,n,i,r,o,a,s,u,c,h,l){var d=t._PrepareAnimation(e,r,o,a,s,u,c,h);return d?n.getScene().beginDirectHierarchyAnimation(n,i,[d],0,a,1===d.loopMode,1,l):null},t.CreateMergeAndStartAnimation=function(e,n,i,r,o,a,s,u,c,h){var l=t._PrepareAnimation(e,i,r,o,a,s,u,c);return l?(n.animations.push(l),n.getScene().beginAnimation(n,0,o,1===l.loopMode,1,h)):null},t.TransitionTo=function(t,e,n,i,r,o,a,s){if(void 0===s&&(s=null),a<=0)return n[t]=e,s&&s(),null;var u=r*(a/1e3);o.setKeys([{frame:0,value:n[t].clone?n[t].clone():n[t]},{frame:u,value:e}]),n.animations||(n.animations=[]),n.animations.push(o);var c=i.beginAnimation(n,0,u,!1);return c.onAnimationEnd=s,c},Object.defineProperty(t.prototype,"runtimeAnimations",{get:function(){return this._runtimeAnimations},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasRunningRuntimeAnimations",{get:function(){for(var t=0,e=this._runtimeAnimations;t<e.length;t++){if(!e[t].isStopped)return!0}return!1},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){var e="Name: "+this.name+", property: "+this.targetProperty;if(e+=", datatype: "+["Float","Vector3","Quaternion","Matrix","Color3","Vector2"][this.dataType],e+=", nKeys: "+(this._keys?this._keys.length:"none"),e+=", nRanges: "+(this._ranges?Object.keys(this._ranges).length:"none"),t){e+=", Ranges: {";var n=!0;for(var i in this._ranges)n&&(e+=", ",n=!1),e+=i;e+="}"}return e},t.prototype.addEvent=function(t){this._events.push(t)},t.prototype.removeEvents=function(t){for(var e=0;e<this._events.length;e++)this._events[e].frame===t&&(this._events.splice(e,1),e--)},t.prototype.getEvents=function(){return this._events},t.prototype.createRange=function(t,e,n){this._ranges[t]||(this._ranges[t]=new c(t,e,n))},t.prototype.deleteRange=function(t,e){void 0===e&&(e=!0);var n=this._ranges[t];if(n){if(e)for(var i=n.from,r=n.to,o=this._keys.length-1;o>=0;o--)this._keys[o].frame>=i&&this._keys[o].frame<=r&&this._keys.splice(o,1);this._ranges[t]=null}},t.prototype.getRange=function(t){return this._ranges[t]},t.prototype.getKeys=function(){return this._keys},t.prototype.getHighestFrame=function(){for(var t=0,e=0,n=this._keys.length;e<n;e++)t<this._keys[e].frame&&(t=this._keys[e].frame);return t},t.prototype.getEasingFunction=function(){return this._easingFunction},t.prototype.setEasingFunction=function(t){this._easingFunction=t},t.prototype.floatInterpolateFunction=function(t,e,n){return o.a.Lerp(t,e,n)},t.prototype.floatInterpolateFunctionWithTangents=function(t,e,n,i,r){return o.a.Hermite(t,e,n,i,r)},t.prototype.quaternionInterpolateFunction=function(t,e,n){return r.Quaternion.Slerp(t,e,n)},t.prototype.quaternionInterpolateFunctionWithTangents=function(t,e,n,i,o){return r.Quaternion.Hermite(t,e,n,i,o).normalize()},t.prototype.vector3InterpolateFunction=function(t,e,n){return r.Vector3.Lerp(t,e,n)},t.prototype.vector3InterpolateFunctionWithTangents=function(t,e,n,i,o){return r.Vector3.Hermite(t,e,n,i,o)},t.prototype.vector2InterpolateFunction=function(t,e,n){return r.Vector2.Lerp(t,e,n)},t.prototype.vector2InterpolateFunctionWithTangents=function(t,e,n,i,o){return r.Vector2.Hermite(t,e,n,i,o)},t.prototype.sizeInterpolateFunction=function(t,e,n){return r.Size.Lerp(t,e,n)},t.prototype.color3InterpolateFunction=function(t,e,n){return r.Color3.Lerp(t,e,n)},t.prototype._getKeyValue=function(t){return"function"==typeof t?t():t},t.prototype._interpolate=function(e,n,r,o,a,s){if(o===t.ANIMATIONLOOPMODE_CONSTANT&&n>0)return s.clone?s.clone():s;var u=this.getKeys(),c=Math.max(0,Math.min(u.length-1,Math.floor(u.length*(e-u[0].frame)/(u[u.length-1].frame-u[0].frame))-1));if(u[c].frame>=e)for(;c-1>=0&&u[c].frame>=e;)c--;for(var h=c;h<u.length;h++){var l=u[h+1];if(l.frame>=e){var d=u[h],p=this._getKeyValue(d.value);if(d.interpolation===i.STEP)return p;var _=this._getKeyValue(l.value),g=void 0!==d.outTangent&&void 0!==l.inTangent,f=l.frame-d.frame,m=(e-d.frame)/f,y=this.getEasingFunction();switch(null!=y&&(m=y.ease(m)),this.dataType){case t.ANIMATIONTYPE_FLOAT:var v=g?this.floatInterpolateFunctionWithTangents(p,d.outTangent*f,_,l.inTangent*f,m):this.floatInterpolateFunction(p,_,m);switch(o){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return v;case t.ANIMATIONLOOPMODE_RELATIVE:return a*n+v}break;case t.ANIMATIONTYPE_QUATERNION:var A=g?this.quaternionInterpolateFunctionWithTangents(p,d.outTangent.scale(f),_,l.inTangent.scale(f),m):this.quaternionInterpolateFunction(p,_,m);switch(o){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return A;case t.ANIMATIONLOOPMODE_RELATIVE:return A.addInPlace(a.scale(n))}return A;case t.ANIMATIONTYPE_VECTOR3:var b=g?this.vector3InterpolateFunctionWithTangents(p,d.outTangent.scale(f),_,l.inTangent.scale(f),m):this.vector3InterpolateFunction(p,_,m);switch(o){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return b;case t.ANIMATIONLOOPMODE_RELATIVE:return b.add(a.scale(n))}case t.ANIMATIONTYPE_VECTOR2:var T=g?this.vector2InterpolateFunctionWithTangents(p,d.outTangent.scale(f),_,l.inTangent.scale(f),m):this.vector2InterpolateFunction(p,_,m);switch(o){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return T;case t.ANIMATIONLOOPMODE_RELATIVE:return T.add(a.scale(n))}case t.ANIMATIONTYPE_SIZE:switch(o){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return this.sizeInterpolateFunction(p,_,m);case t.ANIMATIONLOOPMODE_RELATIVE:return this.sizeInterpolateFunction(p,_,m).add(a.scale(n))}case t.ANIMATIONTYPE_COLOR3:switch(o){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return this.color3InterpolateFunction(p,_,m);case t.ANIMATIONLOOPMODE_RELATIVE:return this.color3InterpolateFunction(p,_,m).add(a.scale(n))}case t.ANIMATIONTYPE_MATRIX:switch(o){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:if(t.AllowMatricesInterpolation)return this.matrixInterpolateFunction(p,_,m,r);case t.ANIMATIONLOOPMODE_RELATIVE:return p}}break}}return this._getKeyValue(u[u.length-1].value)},t.prototype.matrixInterpolateFunction=function(e,n,i,o){return t.AllowMatrixDecomposeForInterpolation?o?(r.Matrix.DecomposeLerpToRef(e,n,i,o),o):r.Matrix.DecomposeLerp(e,n,i):o?(r.Matrix.LerpToRef(e,n,i,o),o):r.Matrix.Lerp(e,n,i)},t.prototype.clone=function(){var e=new t(this.name,this.targetPropertyPath.join("."),this.framePerSecond,this.dataType,this.loopMode);if(e.enableBlending=this.enableBlending,e.blendingSpeed=this.blendingSpeed,this._keys&&e.setKeys(this._keys),this._ranges)for(var n in e._ranges={},this._ranges){var i=this._ranges[n];i&&(e._ranges[n]=i.clone())}return e},t.prototype.setKeys=function(t){this._keys=t.slice(0)},t.prototype.serialize=function(){var e={};e.name=this.name,e.property=this.targetProperty,e.framePerSecond=this.framePerSecond,e.dataType=this.dataType,e.loopBehavior=this.loopMode,e.enableBlending=this.enableBlending,e.blendingSpeed=this.blendingSpeed;var n=this.dataType;e.keys=[];for(var i=this.getKeys(),r=0;r<i.length;r++){var o=i[r],a={};switch(a.frame=o.frame,n){case t.ANIMATIONTYPE_FLOAT:a.values=[o.value];break;case t.ANIMATIONTYPE_QUATERNION:case t.ANIMATIONTYPE_MATRIX:case t.ANIMATIONTYPE_VECTOR3:case t.ANIMATIONTYPE_COLOR3:a.values=o.value.asArray()}e.keys.push(a)}for(var s in e.ranges=[],this._ranges){var u=this._ranges[s];if(u){var c={};c.name=s,c.from=u.from,c.to=u.to,e.ranges.push(c)}}return e},Object.defineProperty(t,"ANIMATIONTYPE_FLOAT",{get:function(){return t._ANIMATIONTYPE_FLOAT},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_VECTOR3",{get:function(){return t._ANIMATIONTYPE_VECTOR3},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_VECTOR2",{get:function(){return t._ANIMATIONTYPE_VECTOR2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_SIZE",{get:function(){return t._ANIMATIONTYPE_SIZE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_QUATERNION",{get:function(){return t._ANIMATIONTYPE_QUATERNION},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_MATRIX",{get:function(){return t._ANIMATIONTYPE_MATRIX},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_COLOR3",{get:function(){return t._ANIMATIONTYPE_COLOR3},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONLOOPMODE_RELATIVE",{get:function(){return t._ANIMATIONLOOPMODE_RELATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONLOOPMODE_CYCLE",{get:function(){return t._ANIMATIONLOOPMODE_CYCLE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONLOOPMODE_CONSTANT",{get:function(){return t._ANIMATIONLOOPMODE_CONSTANT},enumerable:!0,configurable:!0}),t._UniversalLerp=function(t,e,n){var i=t.constructor;return i.Lerp?i.Lerp(t,e,n):i.Slerp?i.Slerp(t,e,n):t.toFixed?t*(1-n)+n*e:e},t.Parse=function(e){var n,i,o=new t(e.name,e.property,e.framePerSecond,e.dataType,e.loopBehavior),a=e.dataType,s=[];for(e.enableBlending&&(o.enableBlending=e.enableBlending),e.blendingSpeed&&(o.blendingSpeed=e.blendingSpeed),i=0;i<e.keys.length;i++){var u,c,h=e.keys[i];switch(a){case t.ANIMATIONTYPE_FLOAT:n=h.values[0],h.values.length>=1&&(u=h.values[1]),h.values.length>=2&&(c=h.values[2]);break;case t.ANIMATIONTYPE_QUATERNION:if(n=r.Quaternion.FromArray(h.values),h.values.length>=8){var l=r.Quaternion.FromArray(h.values.slice(4,8));l.equals(r.Quaternion.Zero())||(u=l)}if(h.values.length>=12){var d=r.Quaternion.FromArray(h.values.slice(8,12));d.equals(r.Quaternion.Zero())||(c=d)}break;case t.ANIMATIONTYPE_MATRIX:n=r.Matrix.FromArray(h.values);break;case t.ANIMATIONTYPE_COLOR3:n=r.Color3.FromArray(h.values);break;case t.ANIMATIONTYPE_VECTOR3:default:n=r.Vector3.FromArray(h.values)}var p={};p.frame=h.frame,p.value=n,null!=u&&(p.inTangent=u),null!=c&&(p.outTangent=c),s.push(p)}if(o.setKeys(s),e.ranges)for(i=0;i<e.ranges.length;i++)n=e.ranges[i],o.createRange(n.name,n.from,n.to);return o},t.AppendSerializedAnimations=function(t,e){u.a.AppendSerializedAnimations(t,e)},t.AllowMatricesInterpolation=!1,t.AllowMatrixDecomposeForInterpolation=!0,t._ANIMATIONTYPE_FLOAT=0,t._ANIMATIONTYPE_VECTOR3=1,t._ANIMATIONTYPE_QUATERNION=2,t._ANIMATIONTYPE_MATRIX=3,t._ANIMATIONTYPE_COLOR3=4,t._ANIMATIONTYPE_VECTOR2=5,t._ANIMATIONTYPE_SIZE=6,t._ANIMATIONLOOPMODE_RELATIVE=0,t._ANIMATIONLOOPMODE_CYCLE=1,t._ANIMATIONLOOPMODE_CONSTANT=2,t}();s.a._AnimationParser=d.Parse,a.a._AnimationRangeFactory=function(t,e,n){return new c(t,e,n)}},161:function(t,e,n){"use strict";n.d(e,"a",function(){return h});var i=n(0),r=n(16),o=Object.freeze(new i.Quaternion(0,0,0,0)),a=Object.freeze(i.Vector3.Zero()),s=Object.freeze(i.Vector2.Zero()),u=Object.freeze(i.Size.Zero()),c=Object.freeze(i.Color3.Black()),h=function(){function t(t,e,n,i){var r=this;this._events=new Array,this._currentFrame=0,this._originalValue=new Array,this._offsetsCache={},this._highLimitsCache={},this._stopped=!1,this._blendingFactor=0,this._targetPath="",this._weight=1,this._ratioOffset=0,this._previousDelay=0,this._previousRatio=0,this._animation=e,this._target=t,this._scene=n,this._host=i,e._runtimeAnimations.push(this);var o=e.getEvents();o&&o.length>0&&o.forEach(function(t){r._events.push(t._clone())})}return Object.defineProperty(t.prototype,"currentFrame",{get:function(){return this._currentFrame},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){return this._weight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentValue",{get:function(){return this._currentValue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targetPath",{get:function(){return this._targetPath},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this._activeTarget},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animation",{get:function(){return this._animation},enumerable:!0,configurable:!0}),t.prototype.reset=function(t){if(void 0===t&&(t=!1),t)if(this._target instanceof Array)for(var e=0,n=0,i=this._target;n<i.length;n++){var r=i[n];void 0!==this._originalValue[e]&&this._setValue(r,this._originalValue[e],-1),e++}else void 0!==this._originalValue[0]&&this._setValue(this._target,this._originalValue[0],-1);this._offsetsCache={},this._highLimitsCache={},this._currentFrame=0,this._blendingFactor=0,this._originalValue=new Array;for(e=0;e<this._events.length;e++)this._events[e].isDone=!1},t.prototype.isStopped=function(){return this._stopped},t.prototype.dispose=function(){var t=this._animation.runtimeAnimations.indexOf(this);t>-1&&this._animation.runtimeAnimations.splice(t,1)},t.prototype._interpolate=function(t,e,n,o,a){return this._currentFrame=t,this._animation.dataType!==r.a.ANIMATIONTYPE_MATRIX||this._workValue||(this._workValue=i.Matrix.Zero()),this._animation._interpolate(t,e,this._workValue,n,o,a)},t.prototype.setValue=function(t,e){if(void 0===e&&(e=1),this._target instanceof Array)for(var n=0,i=0,r=this._target;i<r.length;i++){var o=r[i];this._setValue(o,t,e,n),n++}else this._setValue(this._target,t,e)},t.prototype._setValue=function(t,e,n,o){var a,s;void 0===o&&(o=0);var u=this._animation.targetPropertyPath;if(u.length>1){for(var c=t[u[0]],h=1;h<u.length-1;h++)c=c[u[h]];a=u[u.length-1],s=c}else a=u[0],s=t;if(this._targetPath=a,this._activeTarget=s,this._weight=n,void 0===this._originalValue[o]){var l=void 0;(l=s.getRestPose&&"_matrix"===a?s.getRestPose():s[a])&&l.clone?this._originalValue[o]=l.clone():this._originalValue[o]=l}if((t&&t.animationPropertiesOverride?t.animationPropertiesOverride.enableBlending:this._animation.enableBlending)&&this._blendingFactor<=1){if(!this._originalBlendValue)(l=s[a]).clone?this._originalBlendValue=l.clone():this._originalBlendValue=l;this._originalBlendValue.m?r.a.AllowMatrixDecomposeForInterpolation?this._currentValue?i.Matrix.DecomposeLerpToRef(this._originalBlendValue,e,this._blendingFactor,this._currentValue):this._currentValue=i.Matrix.DecomposeLerp(this._originalBlendValue,e,this._blendingFactor):this._currentValue?i.Matrix.LerpToRef(this._originalBlendValue,e,this._blendingFactor,this._currentValue):this._currentValue=i.Matrix.Lerp(this._originalBlendValue,e,this._blendingFactor):this._currentValue=r.a._UniversalLerp(this._originalBlendValue,e,this._blendingFactor);var d=t&&t.animationPropertiesOverride?t.animationPropertiesOverride.blendingSpeed:this._animation.blendingSpeed;this._blendingFactor+=d}else this._currentValue=e;-1!==n?this._scene._registerTargetForLateAnimationBinding(this,this._originalValue[o]):s[a]=this._currentValue,t.markAsDirty&&t.markAsDirty(this._animation.targetProperty)},t.prototype._getCorrectLoopMode=function(){return this._target&&this._target.animationPropertiesOverride?this._target.animationPropertiesOverride.loopMode:this._animation.loopMode},t.prototype.goToFrame=function(t){var e=this._animation.getKeys();t<e[0].frame?t=e[0].frame:t>e[e.length-1].frame&&(t=e[e.length-1].frame);var n=this._interpolate(t,0,this._getCorrectLoopMode());this.setValue(n,-1)},t.prototype._prepareForSpeedRatioChange=function(t){var e=this._previousDelay*(this._animation.framePerSecond*t)/1e3;this._ratioOffset=this._previousRatio-e},t.prototype.animate=function(t,e,n,i,h,l,d){void 0===l&&(l=-1);var p=this._animation.targetPropertyPath;if(!p||p.length<1)return this._stopped=!0,!1;var _=!0,g=this._animation.getKeys();if(0!==g[0].frame){var f={frame:0,value:g[0].value};g.splice(0,0,f)}else if(1===g.length){f={frame:.001,value:g[0].value};g.push(f)}(e<g[0].frame||e>g[g.length-1].frame)&&(e=g[0].frame),(n<g[0].frame||n>g[g.length-1].frame)&&(n=g[g.length-1].frame),e===n&&(e>g[0].frame?e--:n<g[g.length-1].frame&&n++);var m,y=n-e,v=t*(this._animation.framePerSecond*h)/1e3+this._ratioOffset,A=0;if(this._previousDelay=t,this._previousRatio=v,(n>e&&v>=y||e>n&&v<=y)&&!i)_=!1,A=this._animation._getKeyValue(g[g.length-1].value);else if(this._getCorrectLoopMode()!==r.a.ANIMATIONLOOPMODE_CYCLE){var b=n.toString()+e.toString();if(!this._offsetsCache[b]){var T=this._interpolate(e,0,r.a.ANIMATIONLOOPMODE_CYCLE),O=this._interpolate(n,0,r.a.ANIMATIONLOOPMODE_CYCLE);switch(this._animation.dataType){case r.a.ANIMATIONTYPE_FLOAT:this._offsetsCache[b]=O-T;break;case r.a.ANIMATIONTYPE_QUATERNION:this._offsetsCache[b]=O.subtract(T);break;case r.a.ANIMATIONTYPE_VECTOR3:this._offsetsCache[b]=O.subtract(T);case r.a.ANIMATIONTYPE_VECTOR2:this._offsetsCache[b]=O.subtract(T);case r.a.ANIMATIONTYPE_SIZE:this._offsetsCache[b]=O.subtract(T);case r.a.ANIMATIONTYPE_COLOR3:this._offsetsCache[b]=O.subtract(T)}this._highLimitsCache[b]=O}A=this._highLimitsCache[b],m=this._offsetsCache[b]}if(void 0===m)switch(this._animation.dataType){case r.a.ANIMATIONTYPE_FLOAT:m=0;break;case r.a.ANIMATIONTYPE_QUATERNION:m=o;break;case r.a.ANIMATIONTYPE_VECTOR3:m=a;break;case r.a.ANIMATIONTYPE_VECTOR2:m=s;break;case r.a.ANIMATIONTYPE_SIZE:m=u;break;case r.a.ANIMATIONTYPE_COLOR3:m=c}var P=v/y>>0,I=_?e+v%y:n;if(this._host&&this._host.syncRoot){var C=this._host.syncRoot;I=e+(n-e)*((C.masterFrame-C.fromFrame)/(C.toFrame-C.fromFrame))}var E=this._events;if(y>0&&this.currentFrame>I||y<0&&this.currentFrame<I){d&&d();for(var M=0;M<E.length;M++)E[M].onlyOnce||(E[M].isDone=!1)}var N=this._interpolate(I,P,this._getCorrectLoopMode(),m,A);this.setValue(N,l);for(M=0;M<E.length;M++)if(y>0&&I>=E[M].frame&&E[M].frame>=e||y<0&&I<=E[M].frame&&E[M].frame<=e){var S=E[M];S.isDone||(S.onlyOnce&&(E.splice(M,1),M--),S.isDone=!0,S.action(I))}return _||(this._stopped=!0),_},t}()},167:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(9),r=function(){function t(t,e,n){var i=this;if(this.loop=!1,this._coneInnerAngle=360,this._coneOuterAngle=360,this._volume=1,this.isPlaying=!1,this.isPaused=!1,this._sounds=[],this._weights=[],e.length!==n.length)throw new Error("Sounds length does not equal weights length");this.loop=t,this._weights=n;for(var r=0,o=0,a=n;o<a.length;o++){r+=a[o]}for(var s=r>0?1/r:0,u=0;u<this._weights.length;u++)this._weights[u]*=s;this._sounds=e;for(var c=0,h=this._sounds;c<h.length;c++){h[c].onEndedObservable.add(function(){i._onended()})}}return Object.defineProperty(t.prototype,"directionalConeInnerAngle",{get:function(){return this._coneInnerAngle},set:function(t){if(t!==this._coneInnerAngle){if(this._coneOuterAngle<t)return void i.a.Error("directionalConeInnerAngle: outer angle of the cone must be superior or equal to the inner angle.");this._coneInnerAngle=t;for(var e=0,n=this._sounds;e<n.length;e++){n[e].directionalConeInnerAngle=t}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"directionalConeOuterAngle",{get:function(){return this._coneOuterAngle},set:function(t){if(t!==this._coneOuterAngle){if(t<this._coneInnerAngle)return void i.a.Error("directionalConeOuterAngle: outer angle of the cone must be superior or equal to the inner angle.");this._coneOuterAngle=t;for(var e=0,n=this._sounds;e<n.length;e++){n[e].directionalConeOuterAngle=t}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){if(t!==this._volume)for(var e=0,n=this._sounds;e<n.length;e++){n[e].setVolume(t)}},enumerable:!0,configurable:!0}),t.prototype._onended=function(){void 0!==this._currentIndex&&(this._sounds[this._currentIndex].autoplay=!1),this.loop&&this.isPlaying?this.play():this.isPlaying=!1},t.prototype.pause=function(){this.isPaused=!0,void 0!==this._currentIndex&&this._sounds[this._currentIndex].pause()},t.prototype.stop=function(){this.isPlaying=!1,void 0!==this._currentIndex&&this._sounds[this._currentIndex].stop()},t.prototype.play=function(t){if(!this.isPaused){this.stop();for(var e=Math.random(),n=0,i=0;i<this._weights.length;i++)if(e<=(n+=this._weights[i])){this._currentIndex=i;break}}var r=this._sounds[this._currentIndex];r.isReady()?r.play(0,this.isPaused?void 0:t):r.autoplay=!0,this.isPlaying=!0,this.isPaused=!1},t}()},168:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n(13),r=n(59),o=function(){function t(){this._zoomStopsAnimation=!1,this._idleRotationSpeed=.05,this._idleRotationWaitTime=2e3,this._idleRotationSpinupTime=2e3,this._isPointerDown=!1,this._lastFrameTime=null,this._lastInteractionTime=-1/0,this._cameraRotationSpeed=0,this._lastFrameRadius=0}return Object.defineProperty(t.prototype,"name",{get:function(){return"AutoRotation"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomStopsAnimation",{get:function(){return this._zoomStopsAnimation},set:function(t){this._zoomStopsAnimation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idleRotationSpeed",{get:function(){return this._idleRotationSpeed},set:function(t){this._idleRotationSpeed=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idleRotationWaitTime",{get:function(){return this._idleRotationWaitTime},set:function(t){this._idleRotationWaitTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idleRotationSpinupTime",{get:function(){return this._idleRotationSpinupTime},set:function(t){this._idleRotationSpinupTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotationInProgress",{get:function(){return Math.abs(this._cameraRotationSpeed)>0},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.attach=function(t){var e=this;this._attachedCamera=t;var n=this._attachedCamera.getScene();this._onPrePointerObservableObserver=n.onPrePointerObservable.add(function(t){t.type!==i.a.POINTERDOWN?t.type===i.a.POINTERUP&&(e._isPointerDown=!1):e._isPointerDown=!0}),this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add(function(){var t=r.a.Now,n=0;null!=e._lastFrameTime&&(n=t-e._lastFrameTime),e._lastFrameTime=t,e._applyUserInteraction();var i=t-e._lastInteractionTime-e._idleRotationWaitTime,o=Math.max(Math.min(i/e._idleRotationSpinupTime,1),0);e._cameraRotationSpeed=e._idleRotationSpeed*o,e._attachedCamera&&(e._attachedCamera.alpha-=e._cameraRotationSpeed*(n/1e3))})},t.prototype.detach=function(){if(this._attachedCamera){var t=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&t.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._attachedCamera=null}},t.prototype._userIsZooming=function(){return!!this._attachedCamera&&0!==this._attachedCamera.inertialRadiusOffset},t.prototype._shouldAnimationStopForInteraction=function(){if(!this._attachedCamera)return!1;var t=!1;return this._lastFrameRadius===this._attachedCamera.radius&&0!==this._attachedCamera.inertialRadiusOffset&&(t=!0),this._lastFrameRadius=this._attachedCamera.radius,this._zoomStopsAnimation?t:this._userIsZooming()},t.prototype._applyUserInteraction=function(){this._userIsMoving()&&!this._shouldAnimationStopForInteraction()&&(this._lastInteractionTime=r.a.Now)},t.prototype._userIsMoving=function(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)},t}()},169:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n(73),r=n(16),o=function(){function t(){this.transitionDuration=450,this.lowerRadiusTransitionRange=2,this.upperRadiusTransitionRange=-2,this._autoTransitionRange=!1,this._radiusIsAnimating=!1,this._radiusBounceTransition=null,this._animatables=new Array}return Object.defineProperty(t.prototype,"name",{get:function(){return"Bouncing"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoTransitionRange",{get:function(){return this._autoTransitionRange},set:function(t){var e=this;if(this._autoTransitionRange!==t){this._autoTransitionRange=t;var n=this._attachedCamera;n&&(t?this._onMeshTargetChangedObserver=n.onMeshTargetChangedObservable.add(function(t){if(t){t.computeWorldMatrix(!0);var n=t.getBoundingInfo().diagonalLength;e.lowerRadiusTransitionRange=.05*n,e.upperRadiusTransitionRange=.05*n}}):this._onMeshTargetChangedObserver&&n.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver))}},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.attach=function(t){var e=this;this._attachedCamera=t,this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add(function(){e._attachedCamera&&(e._isRadiusAtLimit(e._attachedCamera.lowerRadiusLimit)&&e._applyBoundRadiusAnimation(e.lowerRadiusTransitionRange),e._isRadiusAtLimit(e._attachedCamera.upperRadiusLimit)&&e._applyBoundRadiusAnimation(e.upperRadiusTransitionRange))})},t.prototype.detach=function(){this._attachedCamera&&(this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null)},t.prototype._isRadiusAtLimit=function(t){return!!this._attachedCamera&&(this._attachedCamera.radius===t&&!this._radiusIsAnimating)},t.prototype._applyBoundRadiusAnimation=function(e){var n=this;if(this._attachedCamera){this._radiusBounceTransition||(t.EasingFunction.setEasingMode(t.EasingMode),this._radiusBounceTransition=r.a.CreateAnimation("radius",r.a.ANIMATIONTYPE_FLOAT,60,t.EasingFunction)),this._cachedWheelPrecision=this._attachedCamera.wheelPrecision,this._attachedCamera.wheelPrecision=1/0,this._attachedCamera.inertialRadiusOffset=0,this.stopAllAnimations(),this._radiusIsAnimating=!0;var i=r.a.TransitionTo("radius",this._attachedCamera.radius+e,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusBounceTransition,this.transitionDuration,function(){return n._clearAnimationLocks()});i&&this._animatables.push(i)}},t.prototype._clearAnimationLocks=function(){this._radiusIsAnimating=!1,this._attachedCamera&&(this._attachedCamera.wheelPrecision=this._cachedWheelPrecision)},t.prototype.stopAllAnimations=function(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0].onAnimationEnd=null,this._animatables[0].stop(),this._animatables.shift()},t.EasingFunction=new i.a(.3),t.EasingMode=i.f.EASINGMODE_EASEOUT,t}()},170:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var i=n(73),r=n(13),o=n(5),a=n(59),s=n(0),u=n(16),c=function(){function t(){this._mode=t.FitFrustumSidesMode,this._radiusScale=1,this._positionScale=.5,this._defaultElevation=.3,this._elevationReturnTime=1500,this._elevationReturnWaitTime=1e3,this._zoomStopsAnimation=!1,this._framingTime=1500,this.autoCorrectCameraLimitsAndSensibility=!0,this._isPointerDown=!1,this._lastInteractionTime=-1/0,this._animatables=new Array,this._betaIsAnimating=!1}return Object.defineProperty(t.prototype,"name",{get:function(){return"Framing"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this._mode},set:function(t){this._mode=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radiusScale",{get:function(){return this._radiusScale},set:function(t){this._radiusScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positionScale",{get:function(){return this._positionScale},set:function(t){this._positionScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultElevation",{get:function(){return this._defaultElevation},set:function(t){this._defaultElevation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"elevationReturnTime",{get:function(){return this._elevationReturnTime},set:function(t){this._elevationReturnTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"elevationReturnWaitTime",{get:function(){return this._elevationReturnWaitTime},set:function(t){this._elevationReturnWaitTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomStopsAnimation",{get:function(){return this._zoomStopsAnimation},set:function(t){this._zoomStopsAnimation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"framingTime",{get:function(){return this._framingTime},set:function(t){this._framingTime=t},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.attach=function(e){var n=this;this._attachedCamera=e;var i=this._attachedCamera.getScene();t.EasingFunction.setEasingMode(t.EasingMode),this._onPrePointerObservableObserver=i.onPrePointerObservable.add(function(t){t.type!==r.a.POINTERDOWN?t.type===r.a.POINTERUP&&(n._isPointerDown=!1):n._isPointerDown=!0}),this._onMeshTargetChangedObserver=e.onMeshTargetChangedObservable.add(function(t){t&&n.zoomOnMesh(t)}),this._onAfterCheckInputsObserver=e.onAfterCheckInputsObservable.add(function(){n._applyUserInteraction(),n._maintainCameraAboveGround()})},t.prototype.detach=function(){if(this._attachedCamera){var t=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&t.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null}},t.prototype.zoomOnMesh=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=null),t.computeWorldMatrix(!0);var i=t.getBoundingInfo().boundingBox;this.zoomOnBoundingInfo(i.minimumWorld,i.maximumWorld,e,n)},t.prototype.zoomOnMeshHierarchy=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=null),t.computeWorldMatrix(!0);var i=t.getHierarchyBoundingVectors(!0);this.zoomOnBoundingInfo(i.min,i.max,e,n)},t.prototype.zoomOnMeshesHierarchy=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=null);for(var i=new s.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),r=new s.Vector3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),a=0;a<t.length;a++){var u=t[a].getHierarchyBoundingVectors(!0);o.h.CheckExtends(u.min,i,r),o.h.CheckExtends(u.max,i,r)}this.zoomOnBoundingInfo(i,r,e,n)},t.prototype.zoomOnBoundingInfo=function(e,n,i,r){var o,a=this;if(void 0===i&&(i=!1),void 0===r&&(r=null),this._attachedCamera){var c=e.y,h=c+(n.y-c)*this._positionScale,l=n.subtract(e).scale(.5);if(i)o=new s.Vector3(0,h,0);else{var d=e.add(l);o=new s.Vector3(d.x,h,d.z)}this._vectorTransition||(this._vectorTransition=u.a.CreateAnimation("target",u.a.ANIMATIONTYPE_VECTOR3,60,t.EasingFunction)),this._betaIsAnimating=!0;var p=u.a.TransitionTo("target",o,this._attachedCamera,this._attachedCamera.getScene(),60,this._vectorTransition,this._framingTime);p&&this._animatables.push(p);var _=0;if(this._mode===t.FitFrustumSidesMode){var g=this._calculateLowerRadiusFromModelBoundingSphere(e,n);this.autoCorrectCameraLimitsAndSensibility&&(this._attachedCamera.lowerRadiusLimit=l.length()+this._attachedCamera.minZ),_=g}else this._mode===t.IgnoreBoundsSizeMode&&(_=this._calculateLowerRadiusFromModelBoundingSphere(e,n),this.autoCorrectCameraLimitsAndSensibility&&null===this._attachedCamera.lowerRadiusLimit&&(this._attachedCamera.lowerRadiusLimit=this._attachedCamera.minZ));if(this.autoCorrectCameraLimitsAndSensibility){var f=n.subtract(e).length();this._attachedCamera.panningSensibility=5e3/f,this._attachedCamera.wheelPrecision=100/_}this._radiusTransition||(this._radiusTransition=u.a.CreateAnimation("radius",u.a.ANIMATIONTYPE_FLOAT,60,t.EasingFunction)),(p=u.a.TransitionTo("radius",_,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusTransition,this._framingTime,function(){a.stopAllAnimations(),r&&r(),a._attachedCamera&&a._attachedCamera.useInputToRestoreState&&a._attachedCamera.storeState()}))&&this._animatables.push(p)}},t.prototype._calculateLowerRadiusFromModelBoundingSphere=function(e,n){var i=n.subtract(e).length(),r=this._getFrustumSlope(),o=.5*i*this._radiusScale,a=o*Math.sqrt(1+1/(r.x*r.x)),s=o*Math.sqrt(1+1/(r.y*r.y)),u=Math.max(a,s),c=this._attachedCamera;return c?(c.lowerRadiusLimit&&this._mode===t.IgnoreBoundsSizeMode&&(u=u<c.lowerRadiusLimit?c.lowerRadiusLimit:u),c.upperRadiusLimit&&(u=u>c.upperRadiusLimit?c.upperRadiusLimit:u),u):0},t.prototype._maintainCameraAboveGround=function(){var e=this;if(!(this._elevationReturnTime<0)){var n=a.a.Now-this._lastInteractionTime,i=.5*Math.PI-this._defaultElevation,r=.5*Math.PI;if(this._attachedCamera&&!this._betaIsAnimating&&this._attachedCamera.beta>r&&n>=this._elevationReturnWaitTime){this._betaIsAnimating=!0,this.stopAllAnimations(),this._betaTransition||(this._betaTransition=u.a.CreateAnimation("beta",u.a.ANIMATIONTYPE_FLOAT,60,t.EasingFunction));var o=u.a.TransitionTo("beta",i,this._attachedCamera,this._attachedCamera.getScene(),60,this._betaTransition,this._elevationReturnTime,function(){e._clearAnimationLocks(),e.stopAllAnimations()});o&&this._animatables.push(o)}}},t.prototype._getFrustumSlope=function(){var t=this._attachedCamera;if(!t)return s.Vector2.Zero();var e=t.getScene().getEngine().getAspectRatio(t),n=Math.tan(t.fov/2),i=n*e;return new s.Vector2(i,n)},t.prototype._clearAnimationLocks=function(){this._betaIsAnimating=!1},t.prototype._applyUserInteraction=function(){this.isUserIsMoving&&(this._lastInteractionTime=a.a.Now,this.stopAllAnimations(),this._clearAnimationLocks())},t.prototype.stopAllAnimations=function(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0]&&(this._animatables[0].onAnimationEnd=null,this._animatables[0].stop()),this._animatables.shift()},Object.defineProperty(t.prototype,"isUserIsMoving",{get:function(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)},enumerable:!0,configurable:!0}),t.EasingFunction=new i.h,t.EasingMode=i.f.EASINGMODE_EASEINOUT,t.IgnoreBoundsSizeMode=0,t.FitFrustumSidesMode=1,t}()},171:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){function t(){var t=this;this.delay=0,this.fadeInTime=300,this._millisecondsPerFrame=1e3/60,this._hovered=!1,this._hoverValue=0,this._ownerNode=null,this._update=function(){if(t._ownerNode){if(t._hoverValue+=t._hovered?t._millisecondsPerFrame:-t._millisecondsPerFrame,t._setAllVisibility(t._ownerNode,(t._hoverValue-t.delay)/t.fadeInTime),t._ownerNode.visibility>1)return t._setAllVisibility(t._ownerNode,1),void(t._hoverValue=t.fadeInTime+t.delay);if(t._ownerNode.visibility<0&&(t._setAllVisibility(t._ownerNode,0),t._hoverValue<0))return void(t._hoverValue=0);setTimeout(t._update,t._millisecondsPerFrame)}}}return Object.defineProperty(t.prototype,"name",{get:function(){return"FadeInOut"},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.attach=function(t){this._ownerNode=t,this._setAllVisibility(this._ownerNode,0)},t.prototype.detach=function(){this._ownerNode=null},t.prototype.fadeIn=function(t){this._hovered=t,this._update()},t.prototype._setAllVisibility=function(t,e){var n=this;t.visibility=e,t.getChildMeshes().forEach(function(t){n._setAllVisibility(t,e)})},t}()},172:function(t,e,n){"use strict";n.d(e,"a",function(){return h});var i=n(23),r=n(19),o=n(13),a=n(0),s=n(7),u=n(22),c=n(55),h=function(){function t(){this._sceneRenderObserver=null,this._targetPosition=new a.Vector3(0,0,0),this._moving=!1,this._startingOrientation=new a.Quaternion,this.zDragFactor=3,this.rotateDraggedObject=!0,this.dragging=!1,this.dragDeltaRatio=.2,this.currentDraggingPointerID=-1,this.detachCameraControls=!0,this.onDragStartObservable=new s.c,this.onDragEndObservable=new s.c}return Object.defineProperty(t.prototype,"name",{get:function(){return"SixDofDrag"},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.attach=function(e){var n=this;this._ownerNode=e,this._scene=this._ownerNode.getScene(),t._virtualScene||(t._virtualScene=new r.Scene(this._scene.getEngine()),t._virtualScene.detachControl(),this._scene.getEngine().scenes.pop());var s=null,h=new a.Vector3(0,0,0);this._virtualOriginMesh=new i.a("",t._virtualScene),this._virtualOriginMesh.rotationQuaternion=new a.Quaternion,this._virtualDragMesh=new i.a("",t._virtualScene),this._virtualDragMesh.rotationQuaternion=new a.Quaternion;var l=null;this._pointerObserver=this._scene.onPointerObservable.add(function(t,e){if(t.type==o.a.POINTERDOWN){if(!n.dragging&&t.pickInfo&&t.pickInfo.hit&&t.pickInfo.pickedMesh&&t.pickInfo.ray&&(_=t.pickInfo.pickedMesh,n._ownerNode==_||_.isDescendantOf(n._ownerNode))){n._scene.activeCamera&&n._scene.activeCamera.cameraRigMode==u.a.RIG_MODE_NONE&&t.pickInfo.ray.origin.copyFrom(n._scene.activeCamera.globalPosition),s=n._ownerNode,c.a._RemoveAndStorePivotPoint(s),h.copyFrom(t.pickInfo.ray.origin),n._virtualOriginMesh.position.copyFrom(t.pickInfo.ray.origin),n._virtualOriginMesh.lookAt(t.pickInfo.ray.origin.add(t.pickInfo.ray.direction)),n._virtualOriginMesh.removeChild(n._virtualDragMesh),s.computeWorldMatrix(),n._virtualDragMesh.position.copyFrom(s.absolutePosition),s.rotationQuaternion||(s.rotationQuaternion=a.Quaternion.RotationYawPitchRoll(s.rotation.y,s.rotation.x,s.rotation.z));var i=s.parent;s.setParent(null),n._virtualDragMesh.rotationQuaternion.copyFrom(s.rotationQuaternion),s.setParent(i),n._virtualOriginMesh.addChild(n._virtualDragMesh),n._targetPosition.copyFrom(n._virtualDragMesh.absolutePosition),n.dragging=!0,n.currentDraggingPointerID=t.event.pointerId,n.detachCameraControls&&n._scene.activeCamera&&!n._scene.activeCamera.leftCamera&&(n._scene.activeCamera.inputs.attachedElement?(l=n._scene.activeCamera.inputs.attachedElement,n._scene.activeCamera.detachControl(n._scene.activeCamera.inputs.attachedElement)):l=null),c.a._RestorePivotPoint(s),n.onDragStartObservable.notifyObservers({})}}else if(t.type==o.a.POINTERUP)n.currentDraggingPointerID==t.event.pointerId&&(n.dragging=!1,n._moving=!1,n.currentDraggingPointerID=-1,s=null,n._virtualOriginMesh.removeChild(n._virtualDragMesh),n.detachCameraControls&&l&&n._scene.activeCamera&&!n._scene.activeCamera.leftCamera&&n._scene.activeCamera.attachControl(l,!0),n.onDragEndObservable.notifyObservers({}));else if(t.type==o.a.POINTERMOVE&&n.currentDraggingPointerID==t.event.pointerId&&n.dragging&&t.pickInfo&&t.pickInfo.ray&&s){var r=n.zDragFactor;n._scene.activeCamera&&n._scene.activeCamera.cameraRigMode==u.a.RIG_MODE_NONE&&(t.pickInfo.ray.origin.copyFrom(n._scene.activeCamera.globalPosition),r=0);var d=t.pickInfo.ray.origin.subtract(h);h.copyFrom(t.pickInfo.ray.origin);var p=-a.Vector3.Dot(d,t.pickInfo.ray.direction);n._virtualOriginMesh.addChild(n._virtualDragMesh),n._virtualDragMesh.position.z-=n._virtualDragMesh.position.z<1?p*n.zDragFactor:p*r*n._virtualDragMesh.position.z,n._virtualDragMesh.position.z<0&&(n._virtualDragMesh.position.z=0),n._virtualOriginMesh.position.copyFrom(t.pickInfo.ray.origin),n._virtualOriginMesh.lookAt(t.pickInfo.ray.origin.add(t.pickInfo.ray.direction)),n._virtualOriginMesh.removeChild(n._virtualDragMesh),n._targetPosition.copyFrom(n._virtualDragMesh.absolutePosition),s.parent&&a.Vector3.TransformCoordinatesToRef(n._targetPosition,a.Matrix.Invert(s.parent.getWorldMatrix()),n._targetPosition),n._moving||n._startingOrientation.copyFrom(n._virtualDragMesh.rotationQuaternion),n._moving=!0}var _});var d=new a.Quaternion;this._sceneRenderObserver=e.getScene().onBeforeRenderObservable.add(function(){if(n.dragging&&n._moving&&s){if(c.a._RemoveAndStorePivotPoint(s),s.position.addInPlace(n._targetPosition.subtract(s.position).scale(n.dragDeltaRatio)),n.rotateDraggedObject){d.copyFrom(n._startingOrientation),d.x=-d.x,d.y=-d.y,d.z=-d.z,n._virtualDragMesh.rotationQuaternion.multiplyToRef(d,d),a.Quaternion.RotationYawPitchRollToRef(d.toEulerAngles("xyz").y,0,0,d),d.multiplyToRef(n._startingOrientation,d);var t=s.parent;(!t||t.scaling&&!t.scaling.isNonUniformWithinEpsilon(.001))&&(s.setParent(null),a.Quaternion.SlerpToRef(s.rotationQuaternion,d,n.dragDeltaRatio,s.rotationQuaternion),s.setParent(t))}c.a._RestorePivotPoint(s)}})},t.prototype.detach=function(){this._scene&&this._scene.onPointerObservable.remove(this._pointerObserver),this._ownerNode&&this._ownerNode.getScene().onBeforeRenderObservable.remove(this._sceneRenderObserver),this._virtualOriginMesh&&this._virtualOriginMesh.dispose(),this._virtualDragMesh&&this._virtualDragMesh.dispose(),this.onDragEndObservable.clear(),this.onDragStartObservable.clear()},t}()},251:function(t,e,n){"use strict";var i=n(168),r=n(169),o=n(170),a=n(0),s=function(){return function(t,e,n,i){void 0===e&&(e=new a.Vector3),void 0===n&&(n=0),void 0===i&&(i=!1),this.direction=t,this.rotatedDirection=e,this.diff=n,this.ignore=i}}(),u=function(){function t(t){this.ui=t,this.name="AttachToBoxBehavior",this.distanceAwayFromFace=.15,this.distanceAwayFromBottomOfFace=.15,this._faceVectors=[new s(a.Vector3.Up()),new s(a.Vector3.Down()),new s(a.Vector3.Left()),new s(a.Vector3.Right()),new s(a.Vector3.Forward()),new s(a.Vector3.Forward().scaleInPlace(-1))],this._tmpMatrix=new a.Matrix,this._tmpVector=new a.Vector3,this._zeroVector=a.Vector3.Zero(),this._lookAtTmpMatrix=new a.Matrix}return t.prototype.init=function(){},t.prototype._closestFace=function(t){var e=this;return this._faceVectors.forEach(function(n){e._target.rotationQuaternion||(e._target.rotationQuaternion=a.Quaternion.RotationYawPitchRoll(e._target.rotation.y,e._target.rotation.x,e._target.rotation.z)),e._target.rotationQuaternion.toRotationMatrix(e._tmpMatrix),a.Vector3.TransformCoordinatesToRef(n.direction,e._tmpMatrix,n.rotatedDirection),n.diff=a.Vector3.GetAngleBetweenVectors(n.rotatedDirection,t,a.Vector3.Cross(n.rotatedDirection,t))}),this._faceVectors.reduce(function(t,e){return t.ignore?e:e.ignore?t:t.diff<e.diff?t:e},this._faceVectors[0])},t.prototype._lookAtToRef=function(t,e,n){void 0===e&&(e=new a.Vector3(0,1,0)),a.Matrix.LookAtLHToRef(this._zeroVector,t,e,this._lookAtTmpMatrix),this._lookAtTmpMatrix.invert(),a.Quaternion.FromRotationMatrixToRef(this._lookAtTmpMatrix,n)},t.prototype.attach=function(t){var e=this;this._target=t,this._scene=this._target.getScene(),this._onRenderObserver=this._scene.onBeforeRenderObservable.add(function(){if(e._scene.activeCamera){var n=e._scene.activeCamera.position;e._scene.activeCamera.devicePosition&&(n=e._scene.activeCamera.devicePosition);var i=e._closestFace(n.subtract(t.position));e._scene.activeCamera.leftCamera?e._scene.activeCamera.leftCamera.computeWorldMatrix().getRotationMatrixToRef(e._tmpMatrix):e._scene.activeCamera.computeWorldMatrix().getRotationMatrixToRef(e._tmpMatrix),a.Vector3.TransformCoordinatesToRef(a.Vector3.Up(),e._tmpMatrix,e._tmpVector),e._faceVectors.forEach(function(t){i.direction.x&&t.direction.x&&(t.ignore=!0),i.direction.y&&t.direction.y&&(t.ignore=!0),i.direction.z&&t.direction.z&&(t.ignore=!0)});var r=e._closestFace(e._tmpVector);e._faceVectors.forEach(function(t){t.ignore=!1}),e.ui.position.copyFrom(t.position),i.direction.x&&(i.rotatedDirection.scaleToRef(t.scaling.x/2+e.distanceAwayFromFace,e._tmpVector),e.ui.position.addInPlace(e._tmpVector)),i.direction.y&&(i.rotatedDirection.scaleToRef(t.scaling.y/2+e.distanceAwayFromFace,e._tmpVector),e.ui.position.addInPlace(e._tmpVector)),i.direction.z&&(i.rotatedDirection.scaleToRef(t.scaling.z/2+e.distanceAwayFromFace,e._tmpVector),e.ui.position.addInPlace(e._tmpVector)),e.ui.rotationQuaternion||(e.ui.rotationQuaternion=a.Quaternion.RotationYawPitchRoll(e.ui.rotation.y,e.ui.rotation.x,e.ui.rotation.z)),i.rotatedDirection.scaleToRef(-1,e._tmpVector),e._lookAtToRef(e._tmpVector,r.rotatedDirection,e.ui.rotationQuaternion),r.direction.x&&e.ui.up.scaleToRef(e.distanceAwayFromBottomOfFace-t.scaling.x/2,e._tmpVector),r.direction.y&&e.ui.up.scaleToRef(e.distanceAwayFromBottomOfFace-t.scaling.y/2,e._tmpVector),r.direction.z&&e.ui.up.scaleToRef(e.distanceAwayFromBottomOfFace-t.scaling.z/2,e._tmpVector),e.ui.position.addInPlace(e._tmpVector)}})},t.prototype.detach=function(){this._scene.onBeforeRenderObservable.remove(this._onRenderObserver)},t}(),c=n(171),h=n(64),l=function(){function t(){this._startDistance=0,this._initialScale=new a.Vector3(0,0,0),this._targetScale=new a.Vector3(0,0,0),this._sceneRenderObserver=null,this._dragBehaviorA=new h.a({}),this._dragBehaviorA.moveAttached=!1,this._dragBehaviorB=new h.a({}),this._dragBehaviorB.moveAttached=!1}return Object.defineProperty(t.prototype,"name",{get:function(){return"MultiPointerScale"},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype._getCurrentDistance=function(){return this._dragBehaviorA.lastDragPosition.subtract(this._dragBehaviorB.lastDragPosition).length()},t.prototype.attach=function(t){var e=this;this._ownerNode=t,this._dragBehaviorA.onDragStartObservable.add(function(n){e._dragBehaviorA.dragging&&e._dragBehaviorB.dragging&&(e._dragBehaviorA.currentDraggingPointerID==e._dragBehaviorB.currentDraggingPointerID?e._dragBehaviorA.releaseDrag():(e._initialScale.copyFrom(t.scaling),e._startDistance=e._getCurrentDistance()))}),this._dragBehaviorB.onDragStartObservable.add(function(n){e._dragBehaviorA.dragging&&e._dragBehaviorB.dragging&&(e._dragBehaviorA.currentDraggingPointerID==e._dragBehaviorB.currentDraggingPointerID?e._dragBehaviorB.releaseDrag():(e._initialScale.copyFrom(t.scaling),e._startDistance=e._getCurrentDistance()))}),[this._dragBehaviorA,this._dragBehaviorB].forEach(function(t){t.onDragObservable.add(function(){if(e._dragBehaviorA.dragging&&e._dragBehaviorB.dragging){var t=e._getCurrentDistance()/e._startDistance;e._initialScale.scaleToRef(t,e._targetScale)}})}),t.addBehavior(this._dragBehaviorA),t.addBehavior(this._dragBehaviorB),this._sceneRenderObserver=t.getScene().onBeforeRenderObservable.add(function(){if(e._dragBehaviorA.dragging&&e._dragBehaviorB.dragging){var n=e._targetScale.subtract(t.scaling).scaleInPlace(.1);n.length()>.01&&t.scaling.addInPlace(n)}})},t.prototype.detach=function(){var t=this;this._ownerNode.getScene().onBeforeRenderObservable.remove(this._sceneRenderObserver),[this._dragBehaviorA,this._dragBehaviorB].forEach(function(e){e.onDragStartObservable.clear(),e.onDragObservable.clear(),t._ownerNode.removeBehavior(e)})},t}(),d=n(172);n.d(e,"b",function(){return i.a}),n.d(e,"c",function(){return r.a}),n.d(e,"e",function(){return o.a}),n.d(e,"a",function(){return u}),n.d(e,"d",function(){return c.a}),n.d(e,"f",function(){return l}),n.d(e,"g",function(){return h.a}),n.d(e,"h",function(){return d.a})},253:function(t,e,n){"use strict";var i=n(11),r=function(){function t(t){this.SMOOTHING=.75,this.FFT_SIZE=512,this.BARGRAPHAMPLITUDE=256,this.DEBUGCANVASPOS={x:20,y:20},this.DEBUGCANVASSIZE={width:320,height:200},this._scene=t,this._audioEngine=i.Engine.audioEngine,this._audioEngine.canUseWebAudio&&this._audioEngine.audioContext&&(this._webAudioAnalyser=this._audioEngine.audioContext.createAnalyser(),this._webAudioAnalyser.minDecibels=-140,this._webAudioAnalyser.maxDecibels=0,this._byteFreqs=new Uint8Array(this._webAudioAnalyser.frequencyBinCount),this._byteTime=new Uint8Array(this._webAudioAnalyser.frequencyBinCount),this._floatFreqs=new Float32Array(this._webAudioAnalyser.frequencyBinCount))}return t.prototype.getFrequencyBinCount=function(){return this._audioEngine.canUseWebAudio?this._webAudioAnalyser.frequencyBinCount:0},t.prototype.getByteFrequencyData=function(){return this._audioEngine.canUseWebAudio&&(this._webAudioAnalyser.smoothingTimeConstant=this.SMOOTHING,this._webAudioAnalyser.fftSize=this.FFT_SIZE,this._webAudioAnalyser.getByteFrequencyData(this._byteFreqs)),this._byteFreqs},t.prototype.getByteTimeDomainData=function(){return this._audioEngine.canUseWebAudio&&(this._webAudioAnalyser.smoothingTimeConstant=this.SMOOTHING,this._webAudioAnalyser.fftSize=this.FFT_SIZE,this._webAudioAnalyser.getByteTimeDomainData(this._byteTime)),this._byteTime},t.prototype.getFloatFrequencyData=function(){return this._audioEngine.canUseWebAudio&&(this._webAudioAnalyser.smoothingTimeConstant=this.SMOOTHING,this._webAudioAnalyser.fftSize=this.FFT_SIZE,this._webAudioAnalyser.getFloatFrequencyData(this._floatFreqs)),this._floatFreqs},t.prototype.drawDebugCanvas=function(){var t=this;if(this._audioEngine.canUseWebAudio&&(this._debugCanvas||(this._debugCanvas=document.createElement("canvas"),this._debugCanvas.width=this.DEBUGCANVASSIZE.width,this._debugCanvas.height=this.DEBUGCANVASSIZE.height,this._debugCanvas.style.position="absolute",this._debugCanvas.style.top=this.DEBUGCANVASPOS.y+"px",this._debugCanvas.style.left=this.DEBUGCANVASPOS.x+"px",this._debugCanvasContext=this._debugCanvas.getContext("2d"),document.body.appendChild(this._debugCanvas),this._registerFunc=function(){t.drawDebugCanvas()},this._scene.registerBeforeRender(this._registerFunc)),this._registerFunc&&this._debugCanvasContext)){var e=this.getByteFrequencyData();this._debugCanvasContext.fillStyle="rgb(0, 0, 0)",this._debugCanvasContext.fillRect(0,0,this.DEBUGCANVASSIZE.width,this.DEBUGCANVASSIZE.height);for(var n=0;n<this.getFrequencyBinCount();n++){var i=e[n]/this.BARGRAPHAMPLITUDE,r=this.DEBUGCANVASSIZE.height*i,o=this.DEBUGCANVASSIZE.height-r-1,a=this.DEBUGCANVASSIZE.width/this.getFrequencyBinCount(),s=n/this.getFrequencyBinCount()*360;this._debugCanvasContext.fillStyle="hsl("+s+", 100%, 50%)",this._debugCanvasContext.fillRect(n*a,o,a,r)}}},t.prototype.stopDebugCanvas=function(){this._debugCanvas&&(this._registerFunc&&(this._scene.unregisterBeforeRender(this._registerFunc),this._registerFunc=null),document.body.removeChild(this._debugCanvas),this._debugCanvas=null,this._debugCanvasContext=null)},t.prototype.connectAudioNodes=function(t,e){this._audioEngine.canUseWebAudio&&(t.connect(this._webAudioAnalyser),this._webAudioAnalyser.connect(e))},t.prototype.dispose=function(){this._audioEngine.canUseWebAudio&&this._webAudioAnalyser.disconnect()},t}(),o=n(7),a=n(9);i.Engine.AudioEngineFactory=function(t){return new s(t)};var s=function(){function t(t){void 0===t&&(t=null);var e=this;this._audioContext=null,this._audioContextInitialized=!1,this._muteButton=null,this.canUseWebAudio=!1,this.WarnedWebAudioUnsupported=!1,this.isMP3supported=!1,this.isOGGsupported=!1,this.unlocked=!0,this.useCustomUnlockedButton=!1,this.onAudioUnlockedObservable=new o.c,this.onAudioLockedObservable=new o.c,this._tryToRun=!1,this._onResize=function(){e._moveButtonToTopLeft()},void 0===window.AudioContext&&void 0===window.webkitAudioContext||(window.AudioContext=window.AudioContext||window.webkitAudioContext,this.canUseWebAudio=!0);var n=document.createElement("audio");this._hostElement=t;try{n&&n.canPlayType&&n.canPlayType('audio/mpeg; codecs="mp3"').replace(/^no$/,"")&&(this.isMP3supported=!0)}catch(t){}try{n&&n.canPlayType&&n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(this.isOGGsupported=!0)}catch(t){}}return Object.defineProperty(t.prototype,"audioContext",{get:function(){return this._audioContextInitialized?this.unlocked||this._muteButton||this._displayMuteButton():this._initializeAudioContext(),this._audioContext},enumerable:!0,configurable:!0}),t.prototype.lock=function(){this._triggerSuspendedState()},t.prototype.unlock=function(){this._triggerRunningState()},t.prototype._resumeAudioContext=function(){var t;return this._audioContext.resume&&(t=this._audioContext.resume()),t||Promise.resolve()},t.prototype._initializeAudioContext=function(){try{this.canUseWebAudio&&(this._audioContext=new AudioContext,this.masterGain=this._audioContext.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this._audioContext.destination),this._audioContextInitialized=!0,"running"===this._audioContext.state&&this._triggerRunningState())}catch(t){this.canUseWebAudio=!1,a.a.Error("Web Audio: "+t.message)}},t.prototype._triggerRunningState=function(){var t=this;this._tryToRun||(this._tryToRun=!0,this._resumeAudioContext().then(function(){t._tryToRun=!1,t._muteButton&&t._hideMuteButton()}).catch(function(){t._tryToRun=!1,t.unlocked=!1}),this.unlocked=!0,this.onAudioUnlockedObservable.notifyObservers(this))},t.prototype._triggerSuspendedState=function(){this.unlocked=!1,this.onAudioLockedObservable.notifyObservers(this),this._displayMuteButton()},t.prototype._displayMuteButton=function(){var t=this;if(!this.useCustomUnlockedButton){this._muteButton=document.createElement("BUTTON"),this._muteButton.className="babylonUnmuteIcon",this._muteButton.id="babylonUnmuteIconBtn",this._muteButton.title="Unmute";var e=document.createElement("style");e.appendChild(document.createTextNode(".babylonUnmuteIcon { position: absolute; left: 20px; top: 20px; height: 40px; width: 60px; background-color: rgba(51,51,51,0.7); background-image: url(data:image/svg+xml;charset=UTF-8,%3Csvg%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2239%22%20height%3D%2232%22%20viewBox%3D%220%200%2039%2032%22%3E%3Cpath%20fill%3D%22white%22%20d%3D%22M9.625%2018.938l-0.031%200.016h-4.953q-0.016%200-0.031-0.016v-12.453q0-0.016%200.031-0.016h4.953q0.031%200%200.031%200.016v12.453zM12.125%207.688l8.719-8.703v27.453l-8.719-8.719-0.016-0.047v-9.938zM23.359%207.875l1.406-1.406%204.219%204.203%204.203-4.203%201.422%201.406-4.219%204.219%204.219%204.203-1.484%201.359-4.141-4.156-4.219%204.219-1.406-1.422%204.219-4.203z%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E);  background-size: 80%; background-repeat:no-repeat; background-position: center; background-position-y: 4px; border: none; outline: none; transition: transform 0.125s ease-out; cursor: pointer; z-index: 9999; } .babylonUnmuteIcon:hover { transform: scale(1.05) } .babylonUnmuteIcon:active { background-color: rgba(51,51,51,1) }")),document.getElementsByTagName("head")[0].appendChild(e),document.body.appendChild(this._muteButton),this._moveButtonToTopLeft(),this._muteButton.addEventListener("touchend",function(){t._triggerRunningState()},!0),this._muteButton.addEventListener("click",function(){t._triggerRunningState()},!0),window.addEventListener("resize",this._onResize)}},t.prototype._moveButtonToTopLeft=function(){this._hostElement&&this._muteButton&&(this._muteButton.style.top=this._hostElement.offsetTop+20+"px",this._muteButton.style.left=this._hostElement.offsetLeft+20+"px")},t.prototype._hideMuteButton=function(){this._muteButton&&(document.body.removeChild(this._muteButton),this._muteButton=null)},t.prototype.dispose=function(){this.canUseWebAudio&&this._audioContextInitialized&&(this._connectedAnalyser&&this._audioContext&&(this._connectedAnalyser.stopDebugCanvas(),this._connectedAnalyser.dispose(),this.masterGain.disconnect(),this.masterGain.connect(this._audioContext.destination),this._connectedAnalyser=null),this.masterGain.gain.value=1),this.WarnedWebAudioUnsupported=!1,this._hideMuteButton(),window.removeEventListener("resize",this._onResize),this.onAudioUnlockedObservable.clear(),this.onAudioLockedObservable.clear()},t.prototype.getGlobalVolume=function(){return this.canUseWebAudio&&this._audioContextInitialized?this.masterGain.gain.value:-1},t.prototype.setGlobalVolume=function(t){this.canUseWebAudio&&this._audioContextInitialized&&(this.masterGain.gain.value=t)},t.prototype.connectToAnalyser=function(t){this._connectedAnalyser&&this._connectedAnalyser.stopDebugCanvas(),this.canUseWebAudio&&this._audioContextInitialized&&this._audioContext&&(this._connectedAnalyser=t,this.masterGain.disconnect(),this._connectedAnalyser.connectAudioNodes(this.masterGain,this._audioContext.destination))},t}(),u=n(103),c=function(){function t(t,e){void 0===e&&(e={}),this.id=-1,this._isMainTrack=!1,this._isInitialized=!1,this._scene=t,this.soundCollection=new Array,this._options=e,!this._isMainTrack&&this._scene.soundTracks&&(this._scene.soundTracks.push(this),this.id=this._scene.soundTracks.length-1)}return t.prototype._initializeSoundTrackAudioGraph=function(){i.Engine.audioEngine.canUseWebAudio&&i.Engine.audioEngine.audioContext&&(this._outputAudioNode=i.Engine.audioEngine.audioContext.createGain(),this._outputAudioNode.connect(i.Engine.audioEngine.masterGain),this._options&&(this._options.volume&&(this._outputAudioNode.gain.value=this._options.volume),this._options.mainTrack&&(this._isMainTrack=this._options.mainTrack)),this._isInitialized=!0)},t.prototype.dispose=function(){if(i.Engine.audioEngine&&i.Engine.audioEngine.canUseWebAudio){for(this._connectedAnalyser&&this._connectedAnalyser.stopDebugCanvas();this.soundCollection.length;)this.soundCollection[0].dispose();this._outputAudioNode&&this._outputAudioNode.disconnect(),this._outputAudioNode=null}},t.prototype.AddSound=function(t){this._isInitialized||this._initializeSoundTrackAudioGraph(),i.Engine.audioEngine.canUseWebAudio&&this._outputAudioNode&&t.connectToSoundTrackAudioNode(this._outputAudioNode),t.soundTrackId&&(-1===t.soundTrackId?this._scene.mainSoundTrack.RemoveSound(t):this._scene.soundTracks&&this._scene.soundTracks[t.soundTrackId].RemoveSound(t)),this.soundCollection.push(t),t.soundTrackId=this.id},t.prototype.RemoveSound=function(t){var e=this.soundCollection.indexOf(t);-1!==e&&this.soundCollection.splice(e,1)},t.prototype.setVolume=function(t){i.Engine.audioEngine.canUseWebAudio&&this._outputAudioNode&&(this._outputAudioNode.gain.value=t)},t.prototype.switchPanningModelToHRTF=function(){if(i.Engine.audioEngine.canUseWebAudio)for(var t=0;t<this.soundCollection.length;t++)this.soundCollection[t].switchPanningModelToHRTF()},t.prototype.switchPanningModelToEqualPower=function(){if(i.Engine.audioEngine.canUseWebAudio)for(var t=0;t<this.soundCollection.length;t++)this.soundCollection[t].switchPanningModelToEqualPower()},t.prototype.connectToAnalyser=function(t){this._connectedAnalyser&&this._connectedAnalyser.stopDebugCanvas(),this._connectedAnalyser=t,i.Engine.audioEngine.canUseWebAudio&&this._outputAudioNode&&(this._outputAudioNode.disconnect(),this._connectedAnalyser.connectAudioNodes(this._outputAudioNode,i.Engine.audioEngine.masterGain))},t}(),h=n(0),l=n(15),d=n(19);n(38).a.AddParser(l.a.NAME_AUDIO,function(t,e,n,r){var o,a=[];if(n.sounds=n.sounds||[],void 0!==t.sounds&&null!==t.sounds)for(var s=0,c=t.sounds.length;s<c;s++){var h=t.sounds[s];i.Engine.audioEngine.canUseWebAudio?(h.url||(h.url=h.name),a[h.url]?n.sounds.push(u.a.Parse(h,e,r,a[h.url])):(o=u.a.Parse(h,e,r),a[h.url]=o,n.sounds.push(o))):n.sounds.push(new u.a(h.name,null,e))}a=[]}),Object.defineProperty(d.Scene.prototype,"mainSoundTrack",{get:function(){var t=this._getComponent(l.a.NAME_AUDIO);return t||(t=new p(this),this._addComponent(t)),this._mainSoundTrack||(this._mainSoundTrack=new c(this,{mainTrack:!0})),this._mainSoundTrack},enumerable:!0,configurable:!0}),d.Scene.prototype.getSoundByName=function(t){var e;for(e=0;e<this.mainSoundTrack.soundCollection.length;e++)if(this.mainSoundTrack.soundCollection[e].name===t)return this.mainSoundTrack.soundCollection[e];if(this.soundTracks)for(var n=0;n<this.soundTracks.length;n++)for(e=0;e<this.soundTracks[n].soundCollection.length;e++)if(this.soundTracks[n].soundCollection[e].name===t)return this.soundTracks[n].soundCollection[e];return null},Object.defineProperty(d.Scene.prototype,"audioEnabled",{get:function(){var t=this._getComponent(l.a.NAME_AUDIO);return t||(t=new p(this),this._addComponent(t)),t.audioEnabled},set:function(t){var e=this._getComponent(l.a.NAME_AUDIO);e||(e=new p(this),this._addComponent(e)),t?e.enableAudio():e.disableAudio()},enumerable:!0,configurable:!0}),Object.defineProperty(d.Scene.prototype,"headphone",{get:function(){var t=this._getComponent(l.a.NAME_AUDIO);return t||(t=new p(this),this._addComponent(t)),t.headphone},set:function(t){var e=this._getComponent(l.a.NAME_AUDIO);e||(e=new p(this),this._addComponent(e)),t?e.switchAudioModeForHeadphones():e.switchAudioModeForNormalSpeakers()},enumerable:!0,configurable:!0});var p=function(){function t(t){this.name=l.a.NAME_AUDIO,this._audioEnabled=!0,this._headphone=!1,this.scene=t,t.soundTracks=new Array,t.sounds=new Array}return Object.defineProperty(t.prototype,"audioEnabled",{get:function(){return this._audioEnabled},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headphone",{get:function(){return this._headphone},enumerable:!0,configurable:!0}),t.prototype.register=function(){this.scene._afterRenderStage.registerStep(l.a.STEP_AFTERRENDER_AUDIO,this,this._afterRender)},t.prototype.rebuild=function(){},t.prototype.serialize=function(t){if(t.sounds=[],this.scene.soundTracks)for(var e=0;e<this.scene.soundTracks.length;e++)for(var n=this.scene.soundTracks[e],i=0;i<n.soundCollection.length;i++)t.sounds.push(n.soundCollection[i].serialize())},t.prototype.addFromContainer=function(t){var e=this;t.sounds&&t.sounds.forEach(function(t){t.play(),t.autoplay=!0,e.scene.mainSoundTrack.AddSound(t)})},t.prototype.removeFromContainer=function(t){var e=this;t.sounds&&t.sounds.forEach(function(t){t.stop(),t.autoplay=!1,e.scene.mainSoundTrack.RemoveSound(t)})},t.prototype.dispose=function(){var t=this.scene;if(t._mainSoundTrack&&t.mainSoundTrack.dispose(),t.soundTracks)for(var e=0;e<t.soundTracks.length;e++)t.soundTracks[e].dispose()},t.prototype.disableAudio=function(){var t,e=this.scene;for(this._audioEnabled=!1,t=0;t<e.mainSoundTrack.soundCollection.length;t++)e.mainSoundTrack.soundCollection[t].pause();if(e.soundTracks)for(t=0;t<e.soundTracks.length;t++)for(var n=0;n<e.soundTracks[t].soundCollection.length;n++)e.soundTracks[t].soundCollection[n].pause()},t.prototype.enableAudio=function(){var t,e=this.scene;for(this._audioEnabled=!0,t=0;t<e.mainSoundTrack.soundCollection.length;t++)e.mainSoundTrack.soundCollection[t].isPaused&&e.mainSoundTrack.soundCollection[t].play();if(e.soundTracks)for(t=0;t<e.soundTracks.length;t++)for(var n=0;n<e.soundTracks[t].soundCollection.length;n++)e.soundTracks[t].soundCollection[n].isPaused&&e.soundTracks[t].soundCollection[n].play()},t.prototype.switchAudioModeForHeadphones=function(){var t=this.scene;if(this._headphone=!0,t.mainSoundTrack.switchPanningModelToHRTF(),t.soundTracks)for(var e=0;e<t.soundTracks.length;e++)t.soundTracks[e].switchPanningModelToHRTF()},t.prototype.switchAudioModeForNormalSpeakers=function(){var t=this.scene;if(this._headphone=!1,t.mainSoundTrack.switchPanningModelToEqualPower(),t.soundTracks)for(var e=0;e<t.soundTracks.length;e++)t.soundTracks[e].switchPanningModelToEqualPower()},t.prototype._afterRender=function(){var t=this.scene;if(this._audioEnabled&&t._mainSoundTrack&&t.soundTracks&&(0!==t._mainSoundTrack.soundCollection.length||1!==t.soundTracks.length)){var e,n=i.Engine.audioEngine;if((e=t.activeCameras.length>0?t.activeCameras[0]:t.activeCamera)&&n.audioContext){n.audioContext.listener.setPosition(e.position.x,e.position.y,e.position.z),e.rigCameras&&e.rigCameras.length>0&&(e=e.rigCameras[0]);var r,o=h.Matrix.Invert(e.getViewMatrix()),a=h.Vector3.TransformNormal(new h.Vector3(0,0,-1),o);for(a.normalize(),isNaN(a.x)||isNaN(a.y)||isNaN(a.z)||n.audioContext.listener.setOrientation(a.x,a.y,a.z,0,1,0),r=0;r<t.mainSoundTrack.soundCollection.length;r++){var s=t.mainSoundTrack.soundCollection[r];s.useCustomAttenuation&&s.updateDistanceFromListener()}if(t.soundTracks)for(r=0;r<t.soundTracks.length;r++)for(var u=0;u<t.soundTracks[r].soundCollection.length;u++)(s=t.soundTracks[r].soundCollection[u]).useCustomAttenuation&&s.updateDistanceFromListener()}}},t}();u.a._SceneComponentInitialization=function(t){var e=t._getComponent(l.a.NAME_AUDIO);e||(e=new p(t),t._addComponent(e))};var _=n(167);n.d(e,"a",function(){return r}),n.d(e,"b",function(){return s}),n.d(e,"c",function(){return p}),n.d(e,"d",function(){return u.a}),n.d(e,"e",function(){return c}),n.d(e,"f",function(){return _.a})},264:function(t,e,n){"use strict";var i=n(33),r=n(46),o=n(86),a=n(138),s=n(159),u=n(1),c=n(26),h=function(t){function e(e,n,i){var r=t.call(this,e,i)||this;return r._sound=n,r}return u.d(e,t),e.prototype._prepare=function(){},e.prototype.execute=function(){void 0!==this._sound&&this._sound.play()},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"PlaySoundAction",properties:[{name:"sound",value:this._sound.name}]},e)},e}(i.a),l=function(t){function e(e,n,i){var r=t.call(this,e,i)||this;return r._sound=n,r}return u.d(e,t),e.prototype._prepare=function(){},e.prototype.execute=function(){void 0!==this._sound&&this._sound.stop()},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"StopSoundAction",properties:[{name:"sound",value:this._sound.name}]},e)},e}(i.a);c.a.RegisteredTypes["BABYLON.PlaySoundAction"]=l,c.a.RegisteredTypes["BABYLON.StopSoundAction"]=l;var d=n(9),p=n(7),_=n(0),g=n(16),f=function(t){function e(e,n,i,r,o,a,s,u){void 0===o&&(o=1e3);var c=t.call(this,e,a)||this;return c.duration=1e3,c.onInterpolationDoneObservable=new p.c,c.propertyPath=i,c.value=r,c.duration=o,c.stopOtherAnimations=s,c.onInterpolationDone=u,c._target=c._effectiveTarget=n,c}return u.d(e,t),e.prototype._prepare=function(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath)},e.prototype.execute=function(){var t,e=this,n=this._actionManager.getScene(),i=[{frame:0,value:this._effectiveTarget[this._property]},{frame:100,value:this.value}];if("number"==typeof this.value)t=g.a.ANIMATIONTYPE_FLOAT;else if(this.value instanceof _.Color3)t=g.a.ANIMATIONTYPE_COLOR3;else if(this.value instanceof _.Vector3)t=g.a.ANIMATIONTYPE_VECTOR3;else if(this.value instanceof _.Matrix)t=g.a.ANIMATIONTYPE_MATRIX;else{if(!(this.value instanceof _.Quaternion))return void d.a.Warn("InterpolateValueAction: Unsupported type ("+typeof this.value+")");t=g.a.ANIMATIONTYPE_QUATERNION}var r=new g.a("InterpolateValueAction",this._property,1e3/this.duration*100,t,g.a.ANIMATIONLOOPMODE_CONSTANT);r.setKeys(i),this.stopOtherAnimations&&n.stopAnimation(this._effectiveTarget);n.beginDirectAnimation(this._effectiveTarget,[r],0,100,!1,1,function(){e.onInterpolationDoneObservable.notifyObservers(e),e.onInterpolationDone&&e.onInterpolationDone()})},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"InterpolateValueAction",properties:[i.a._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:i.a._SerializeValueAsString(this.value)},{name:"duration",value:i.a._SerializeValueAsString(this.duration)},{name:"stopOtherAnimations",value:i.a._SerializeValueAsString(this.stopOtherAnimations)||!1}]},e)},e}(i.a);c.a.RegisteredTypes["BABYLON.InterpolateValueAction"]=i.a,n.d(e,"a",function(){return i.a}),n.d(e,"b",function(){return r.a}),n.d(e,"c",function(){return o.a}),n.d(e,"e",function(){return a.a}),n.d(e,"t",function(){return a.d}),n.d(e,"l",function(){return a.b}),n.d(e,"p",function(){return a.c}),n.d(e,"s",function(){return s.j}),n.d(e,"n",function(){return s.g}),n.d(e,"o",function(){return s.h}),n.d(e,"h",function(){return s.d}),n.d(e,"j",function(){return s.e}),n.d(e,"q",function(){return s.i}),n.d(e,"f",function(){return s.b}),n.d(e,"d",function(){return s.a}),n.d(e,"g",function(){return s.c}),n.d(e,"m",function(){return s.f}),n.d(e,"k",function(){return h}),n.d(e,"r",function(){return l}),n.d(e,"i",function(){return f})},266:function(t,e,n){"use strict";var i=n(144),r=n(16),o=n(126),a=function(){return function(){this.enableBlending=!1,this.blendingSpeed=.01,this.loopMode=r.a.ANIMATIONLOOPMODE_CYCLE}}(),s=n(73),u=n(161);n.d(e,"a",function(){return i.a}),n.d(e,"g",function(){return r.d}),n.d(e,"c",function(){return r.b}),n.d(e,"p",function(){return r.e}),n.d(e,"e",function(){return r.c}),n.d(e,"b",function(){return r.a}),n.d(e,"w",function(){return o.b}),n.d(e,"d",function(){return o.a}),n.d(e,"f",function(){return a}),n.d(e,"m",function(){return s.f}),n.d(e,"k",function(){return s.d}),n.d(e,"h",function(){return s.a}),n.d(e,"j",function(){return s.c}),n.d(e,"l",function(){return s.e}),n.d(e,"n",function(){return s.g}),n.d(e,"o",function(){return s.h}),n.d(e,"q",function(){return s.i}),n.d(e,"r",function(){return s.j}),n.d(e,"s",function(){return s.k}),n.d(e,"t",function(){return s.l}),n.d(e,"v",function(){return s.m}),n.d(e,"i",function(){return s.b}),n.d(e,"u",function(){return u.a})},33:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n(7),r=n(0),o=n(26),a=function(){function t(t,e){this.triggerOptions=t,this.onBeforeExecuteObservable=new i.c,t.parameter?(this.trigger=t.trigger,this._triggerParameter=t.parameter):t.trigger?this.trigger=t.trigger:this.trigger=t,this._nextActiveAction=this,this._condition=e}return t.prototype._prepare=function(){},t.prototype.getTriggerParameter=function(){return this._triggerParameter},t.prototype._executeCurrent=function(t){if(this._nextActiveAction._condition){var e=this._nextActiveAction._condition,n=this._actionManager.getScene().getRenderId();if(e._evaluationId===n){if(!e._currentResult)return}else{if(e._evaluationId=n,!e.isValid())return void(e._currentResult=!1);e._currentResult=!0}}this.onBeforeExecuteObservable.notifyObservers(this),this._nextActiveAction.execute(t),this.skipToNextActiveAction()},t.prototype.execute=function(t){},t.prototype.skipToNextActiveAction=function(){this._nextActiveAction._child?(this._nextActiveAction._child._actionManager||(this._nextActiveAction._child._actionManager=this._actionManager),this._nextActiveAction=this._nextActiveAction._child):this._nextActiveAction=this},t.prototype.then=function(t){return this._child=t,t._actionManager=this._actionManager,t._prepare(),t},t.prototype._getProperty=function(t){return this._actionManager._getProperty(t)},t.prototype._getEffectiveTarget=function(t,e){return this._actionManager._getEffectiveTarget(t,e)},t.prototype.serialize=function(t){},t.prototype._serialize=function(t,e){var n={type:1,children:[],name:t.name,properties:t.properties||[]};if(this._child&&this._child.serialize(n),this._condition){var i=this._condition.serialize();return i.children.push(n),e&&e.children.push(i),i}return e&&e.children.push(n),n},t._SerializeValueAsString=function(t){return"number"==typeof t?t.toString():"boolean"==typeof t?t?"true":"false":t instanceof r.Vector2?t.x+", "+t.y:t instanceof r.Vector3?t.x+", "+t.y+", "+t.z:t instanceof r.Color3?t.r+", "+t.g+", "+t.b:t instanceof r.Color4?t.r+", "+t.g+", "+t.b+", "+t.a:t},t._GetTargetProperty=function(t){return{name:"target",targetType:t._isMesh?"MeshProperties":t._isLight?"LightProperties":t._isCamera?"CameraProperties":"SceneProperties",value:t._isScene?"Scene":t.name}},t}();o.a.RegisteredTypes["BABYLON.Action"]=a},46:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){function t(t,e,n,i,r,o){this.source=t,this.pointerX=e,this.pointerY=n,this.meshUnderPointer=i,this.sourceEvent=r,this.additionalData=o}return t.CreateNew=function(e,n,i){var r=e.getScene();return new t(e,r.pointerX,r.pointerY,r.meshUnderPointer,n,i)},t.CreateNewFromSprite=function(e,n,i,r){return new t(e,n.pointerX,n.pointerY,n.meshUnderPointer,i,r)},t.CreateNewFromScene=function(e,n){return new t(null,e.pointerX,e.pointerY,e.meshUnderPointer,n)},t.CreateNewFromPrimitive=function(e,n,i,r){return new t(e,n.x,n.y,null,i,r)},t}()},64:function(t,e,n){"use strict";n.d(e,"a",function(){return h});var i=n(10),r=n(19),o=n(7),a=n(0),s=n(13),u=n(35),c=n(55),h=function(){function t(t){this.maxDragAngle=0,this._useAlternatePickedPointAboveMaxDragAngle=!1,this.currentDraggingPointerID=-1,this.dragging=!1,this.dragDeltaRatio=.2,this.updateDragPlane=!0,this._debugMode=!1,this._moving=!1,this.onDragObservable=new o.c,this.onDragStartObservable=new o.c,this.onDragEndObservable=new o.c,this.moveAttached=!0,this.enabled=!0,this.detachCameraControls=!0,this.useObjectOrienationForDragging=!0,this.validateDrag=function(t){return!0},this._tmpVector=new a.Vector3(0,0,0),this._alternatePickedPoint=new a.Vector3(0,0,0),this._worldDragAxis=new a.Vector3(0,0,0),this._targetPosition=new a.Vector3(0,0,0),this._attachedElement=null,this._startDragRay=new u.a(new a.Vector3,new a.Vector3),this._lastPointerRay={},this._dragDelta=new a.Vector3,this._pointA=new a.Vector3(0,0,0),this._pointB=new a.Vector3(0,0,0),this._pointC=new a.Vector3(0,0,0),this._lineA=new a.Vector3(0,0,0),this._lineB=new a.Vector3(0,0,0),this._localAxis=new a.Vector3(0,0,0),this._lookAt=new a.Vector3(0,0,0),this._options=t||{};var e=0;if(this._options.dragAxis&&e++,this._options.dragPlaneNormal&&e++,e>1)throw"Multiple drag modes specified in dragBehavior options. Only one expected"}return Object.defineProperty(t.prototype,"name",{get:function(){return"PointerDrag"},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.attach=function(e){var n=this;this._scene=e.getScene(),this._attachedNode=e,t._planeScene||(this._debugMode?t._planeScene=this._scene:(t._planeScene=new r.Scene(this._scene.getEngine()),t._planeScene.detachControl(),this._scene.getEngine().scenes.pop(),this._scene.onDisposeObservable.addOnce(function(){t._planeScene.dispose(),t._planeScene=null}))),this._dragPlane=i.a.CreatePlane("pointerDragPlane",this._debugMode?1:1e4,t._planeScene,!1,i.a.DOUBLESIDE),this.lastDragPosition=new a.Vector3(0,0,0);this._pointerObserver=this._scene.onPointerObservable.add(function(e,i){var r;if(n.enabled)if(e.type==s.a.POINTERDOWN)!n.dragging&&e.pickInfo&&e.pickInfo.hit&&e.pickInfo.pickedMesh&&e.pickInfo.pickedPoint&&e.pickInfo.ray&&(r=e.pickInfo.pickedMesh,n._attachedNode==r||r.isDescendantOf(n._attachedNode))&&n._startDrag(e.event.pointerId,e.pickInfo.ray,e.pickInfo.pickedPoint);else if(e.type==s.a.POINTERUP)n.currentDraggingPointerID==e.event.pointerId&&n.releaseDrag();else if(e.type==s.a.POINTERMOVE){var o=e.event.pointerId;n.currentDraggingPointerID===t._AnyMouseID&&o!==t._AnyMouseID&&"mouse"==e.event.pointerType&&(n._lastPointerRay[n.currentDraggingPointerID]&&(n._lastPointerRay[o]=n._lastPointerRay[n.currentDraggingPointerID],delete n._lastPointerRay[n.currentDraggingPointerID]),n.currentDraggingPointerID=o),n._lastPointerRay[o]||(n._lastPointerRay[o]=new u.a(new a.Vector3,new a.Vector3)),e.pickInfo&&e.pickInfo.ray&&(n._lastPointerRay[o].origin.copyFrom(e.pickInfo.ray.origin),n._lastPointerRay[o].direction.copyFrom(e.pickInfo.ray.direction),n.currentDraggingPointerID==o&&n.dragging&&n._moveDrag(e.pickInfo.ray))}}),this._beforeRenderObserver=this._scene.onBeforeRenderObservable.add(function(){n._moving&&n.moveAttached&&(c.a._RemoveAndStorePivotPoint(n._attachedNode),n._targetPosition.subtractToRef(n._attachedNode.absolutePosition,n._tmpVector),n._tmpVector.scaleInPlace(n.dragDeltaRatio),n._attachedNode.getAbsolutePosition().addToRef(n._tmpVector,n._tmpVector),n.validateDrag(n._tmpVector)&&n._attachedNode.setAbsolutePosition(n._tmpVector),c.a._RestorePivotPoint(n._attachedNode))})},t.prototype.releaseDrag=function(){this.dragging=!1,this.onDragEndObservable.notifyObservers({dragPlanePoint:this.lastDragPosition,pointerId:this.currentDraggingPointerID}),this.currentDraggingPointerID=-1,this._moving=!1,this.detachCameraControls&&this._attachedElement&&this._scene.activeCamera&&!this._scene.activeCamera.leftCamera&&this._scene.activeCamera.attachControl(this._attachedElement,!0)},t.prototype.startDrag=function(e,n,i){void 0===e&&(e=t._AnyMouseID),this._startDrag(e,n,i);var r=this._lastPointerRay[e];e===t._AnyMouseID&&(r=this._lastPointerRay[Object.keys(this._lastPointerRay)[0]]),r&&this._moveDrag(r)},t.prototype._startDrag=function(t,e,n){if(this._scene.activeCamera&&!this.dragging&&this._attachedNode){c.a._RemoveAndStorePivotPoint(this._attachedNode),e?(this._startDragRay.direction.copyFrom(e.direction),this._startDragRay.origin.copyFrom(e.origin)):(this._startDragRay.origin.copyFrom(this._scene.activeCamera.position),this._attachedNode.getWorldMatrix().getTranslationToRef(this._tmpVector),this._tmpVector.subtractToRef(this._scene.activeCamera.position,this._startDragRay.direction)),this._updateDragPlanePosition(this._startDragRay,n||this._tmpVector);var i=this._pickWithRayOnDragPlane(this._startDragRay);i&&(this.dragging=!0,this.currentDraggingPointerID=t,this.lastDragPosition.copyFrom(i),this.onDragStartObservable.notifyObservers({dragPlanePoint:i,pointerId:this.currentDraggingPointerID}),this._targetPosition.copyFrom(this._attachedNode.absolutePosition),this.detachCameraControls&&this._scene.activeCamera&&!this._scene.activeCamera.leftCamera&&(this._scene.activeCamera.inputs.attachedElement?(this._attachedElement=this._scene.activeCamera.inputs.attachedElement,this._scene.activeCamera.detachControl(this._scene.activeCamera.inputs.attachedElement)):this._attachedElement=null)),c.a._RestorePivotPoint(this._attachedNode)}},t.prototype._moveDrag=function(t){this._moving=!0;var e=this._pickWithRayOnDragPlane(t);if(e){this.updateDragPlane&&this._updateDragPlanePosition(t,e);var n=0;this._options.dragAxis?(a.Vector3.TransformCoordinatesToRef(this._options.dragAxis,this._attachedNode.getWorldMatrix().getRotationMatrix(),this._worldDragAxis),e.subtractToRef(this.lastDragPosition,this._tmpVector),n=a.Vector3.Dot(this._tmpVector,this._worldDragAxis),this._worldDragAxis.scaleToRef(n,this._dragDelta)):(n=this._dragDelta.length(),e.subtractToRef(this.lastDragPosition,this._dragDelta)),this._targetPosition.addInPlace(this._dragDelta),this.onDragObservable.notifyObservers({dragDistance:n,delta:this._dragDelta,dragPlanePoint:e,dragPlaneNormal:this._dragPlane.forward,pointerId:this.currentDraggingPointerID}),this.lastDragPosition.copyFrom(e)}},t.prototype._pickWithRayOnDragPlane=function(e){var n=this;if(!e)return null;var i=Math.acos(a.Vector3.Dot(this._dragPlane.forward,e.direction));if(i>Math.PI/2&&(i=Math.PI-i),this.maxDragAngle>0&&i>this.maxDragAngle){if(this._useAlternatePickedPointAboveMaxDragAngle){this._tmpVector.copyFrom(e.direction),this._attachedNode.absolutePosition.subtractToRef(e.origin,this._alternatePickedPoint),this._alternatePickedPoint.normalize(),this._alternatePickedPoint.scaleInPlace(-2*a.Vector3.Dot(this._alternatePickedPoint,this._tmpVector)),this._tmpVector.addInPlace(this._alternatePickedPoint);var r=a.Vector3.Dot(this._dragPlane.forward,this._tmpVector);return this._dragPlane.forward.scaleToRef(-r,this._alternatePickedPoint),this._alternatePickedPoint.addInPlace(this._tmpVector),this._alternatePickedPoint.addInPlace(this._attachedNode.absolutePosition),this._alternatePickedPoint}return null}var o=t._planeScene.pickWithRay(e,function(t){return t==n._dragPlane});return o&&o.hit&&o.pickedMesh&&o.pickedPoint?o.pickedPoint:null},t.prototype._updateDragPlanePosition=function(t,e){this._pointA.copyFrom(e),this._options.dragAxis?(this.useObjectOrienationForDragging?a.Vector3.TransformCoordinatesToRef(this._options.dragAxis,this._attachedNode.getWorldMatrix().getRotationMatrix(),this._localAxis):this._localAxis.copyFrom(this._options.dragAxis),this._pointA.addToRef(this._localAxis,this._pointB),t.origin.subtractToRef(this._pointA,this._pointC),this._pointA.addToRef(this._pointC.normalize(),this._pointC),this._pointB.subtractToRef(this._pointA,this._lineA),this._pointC.subtractToRef(this._pointA,this._lineB),a.Vector3.CrossToRef(this._lineA,this._lineB,this._lookAt),a.Vector3.CrossToRef(this._lineA,this._lookAt,this._lookAt),this._lookAt.normalize(),this._dragPlane.position.copyFrom(this._pointA),this._pointA.addToRef(this._lookAt,this._lookAt),this._dragPlane.lookAt(this._lookAt)):this._options.dragPlaneNormal?(this.useObjectOrienationForDragging?a.Vector3.TransformCoordinatesToRef(this._options.dragPlaneNormal,this._attachedNode.getWorldMatrix().getRotationMatrix(),this._localAxis):this._localAxis.copyFrom(this._options.dragPlaneNormal),this._dragPlane.position.copyFrom(this._pointA),this._pointA.addToRef(this._localAxis,this._lookAt),this._dragPlane.lookAt(this._lookAt)):(this._dragPlane.position.copyFrom(this._pointA),this._dragPlane.lookAt(t.origin)),this._dragPlane.computeWorldMatrix(!0)},t.prototype.detach=function(){this._pointerObserver&&this._scene.onPointerObservable.remove(this._pointerObserver),this._beforeRenderObserver&&this._scene.onBeforeRenderObservable.remove(this._beforeRenderObserver)},t._AnyMouseID=-2,t}()},73:function(t,e,n){"use strict";n.d(e,"f",function(){return o}),n.d(e,"d",function(){return a}),n.d(e,"a",function(){return s}),n.d(e,"c",function(){return u}),n.d(e,"e",function(){return c}),n.d(e,"g",function(){return h}),n.d(e,"h",function(){return l}),n.d(e,"i",function(){return d}),n.d(e,"j",function(){return p}),n.d(e,"k",function(){return _}),n.d(e,"l",function(){return g}),n.d(e,"m",function(){return f}),n.d(e,"b",function(){return m});var i=n(1),r=n(0),o=function(){function t(){this._easingMode=t.EASINGMODE_EASEIN}return t.prototype.setEasingMode=function(t){var e=Math.min(Math.max(t,0),2);this._easingMode=e},t.prototype.getEasingMode=function(){return this._easingMode},t.prototype.easeInCore=function(t){throw new Error("You must implement this method")},t.prototype.ease=function(e){switch(this._easingMode){case t.EASINGMODE_EASEIN:return this.easeInCore(e);case t.EASINGMODE_EASEOUT:return 1-this.easeInCore(1-e)}return e>=.5?.5*(1-this.easeInCore(2*(1-e)))+.5:.5*this.easeInCore(2*e)},t.EASINGMODE_EASEIN=0,t.EASINGMODE_EASEOUT=1,t.EASINGMODE_EASEINOUT=2,t}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.d(e,t),e.prototype.easeInCore=function(t){return t=Math.max(0,Math.min(1,t)),1-Math.sqrt(1-t*t)},e}(o),s=function(t){function e(e){void 0===e&&(e=1);var n=t.call(this)||this;return n.amplitude=e,n}return i.d(e,t),e.prototype.easeInCore=function(t){var e=Math.max(0,this.amplitude);return Math.pow(t,3)-t*e*Math.sin(3.141592653589793*t)},e}(o),u=function(t){function e(e,n){void 0===e&&(e=3),void 0===n&&(n=2);var i=t.call(this)||this;return i.bounces=e,i.bounciness=n,i}return i.d(e,t),e.prototype.easeInCore=function(t){var e=Math.max(0,this.bounces),n=this.bounciness;n<=1&&(n=1.001);var i=Math.pow(n,e),r=1-n,o=(1-i)/r+.5*i,a=t*o,s=Math.log(-a*(1-n)+1)/Math.log(n),u=Math.floor(s),c=u+1,h=(1-Math.pow(n,u))/(r*o),l=.5*(h+(1-Math.pow(n,c))/(r*o)),d=t-l,p=l-h;return-Math.pow(1/n,e-u)/(p*p)*(d-p)*(d+p)},e}(o),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.d(e,t),e.prototype.easeInCore=function(t){return t*t*t},e}(o),h=function(t){function e(e,n){void 0===e&&(e=3),void 0===n&&(n=3);var i=t.call(this)||this;return i.oscillations=e,i.springiness=n,i}return i.d(e,t),e.prototype.easeInCore=function(t){var e=Math.max(0,this.oscillations),n=Math.max(0,this.springiness);return(0==n?t:(Math.exp(n*t)-1)/(Math.exp(n)-1))*Math.sin((6.283185307179586*e+1.5707963267948966)*t)},e}(o),l=function(t){function e(e){void 0===e&&(e=2);var n=t.call(this)||this;return n.exponent=e,n}return i.d(e,t),e.prototype.easeInCore=function(t){return this.exponent<=0?t:(Math.exp(this.exponent*t)-1)/(Math.exp(this.exponent)-1)},e}(o),d=function(t){function e(e){void 0===e&&(e=2);var n=t.call(this)||this;return n.power=e,n}return i.d(e,t),e.prototype.easeInCore=function(t){var e=Math.max(0,this.power);return Math.pow(t,e)},e}(o),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.d(e,t),e.prototype.easeInCore=function(t){return t*t},e}(o),_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.d(e,t),e.prototype.easeInCore=function(t){return t*t*t*t},e}(o),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.d(e,t),e.prototype.easeInCore=function(t){return t*t*t*t*t},e}(o),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.d(e,t),e.prototype.easeInCore=function(t){return 1-Math.sin(1.5707963267948966*(1-t))},e}(o),m=function(t){function e(e,n,i,r){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===r&&(r=1);var o=t.call(this)||this;return o.x1=e,o.y1=n,o.x2=i,o.y2=r,o}return i.d(e,t),e.prototype.easeInCore=function(t){return r.BezierCurve.Interpolate(t,this.x1,this.y1,this.x2,this.y2)},e}(o)},86:function(t,e,n){"use strict";n.d(e,"a",function(){return d});var i=n(0),r=n(138),o=n(33),a=n(159),s=n(4),u=n(21),c=n(9),h=n(41),l=n(26),d=function(){function t(t){this.actions=new Array,this.hoverCursor="",this._scene=t||u.a.LastCreatedScene,t.actionManagers.push(this)}return t.prototype.dispose=function(){for(var e=this._scene.actionManagers.indexOf(this),n=0;n<this.actions.length;n++){var i=this.actions[n];t.Triggers[i.trigger]--,0===t.Triggers[i.trigger]&&delete t.Triggers[i.trigger]}e>-1&&this._scene.actionManagers.splice(e,1)},t.prototype.getScene=function(){return this._scene},t.prototype.hasSpecificTriggers=function(t){for(var e=0;e<this.actions.length;e++){var n=this.actions[e];if(t.indexOf(n.trigger)>-1)return!0}return!1},t.prototype.hasSpecificTriggers2=function(t,e){for(var n=0;n<this.actions.length;n++){var i=this.actions[n];if(t==i.trigger||e==i.trigger)return!0}return!1},t.prototype.hasSpecificTrigger=function(t,e){for(var n=0;n<this.actions.length;n++){var i=this.actions[n];if(i.trigger===t){if(!e)return!0;if(e(i.getTriggerParameter()))return!0}}return!1},Object.defineProperty(t.prototype,"hasPointerTriggers",{get:function(){for(var e=0;e<this.actions.length;e++){var n=this.actions[e];if(n.trigger>=t.OnPickTrigger&&n.trigger<=t.OnPointerOutTrigger)return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPickTriggers",{get:function(){for(var e=0;e<this.actions.length;e++){var n=this.actions[e];if(n.trigger>=t.OnPickTrigger&&n.trigger<=t.OnPickUpTrigger)return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"HasTriggers",{get:function(){for(var e in t.Triggers)if(t.Triggers.hasOwnProperty(e))return!0;return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"HasPickTriggers",{get:function(){for(var e in t.Triggers)if(t.Triggers.hasOwnProperty(e)){var n=parseInt(e);if(n>=t.OnPickTrigger&&n<=t.OnPickUpTrigger)return!0}return!1},enumerable:!0,configurable:!0}),t.HasSpecificTrigger=function(e){for(var n in t.Triggers){if(t.Triggers.hasOwnProperty(n))if(parseInt(n)===e)return!0}return!1},t.prototype.registerAction=function(e){return e.trigger===t.OnEveryFrameTrigger&&this.getScene().actionManager!==this?(c.a.Warn("OnEveryFrameTrigger can only be used with scene.actionManager"),null):(this.actions.push(e),t.Triggers[e.trigger]?t.Triggers[e.trigger]++:t.Triggers[e.trigger]=1,e._actionManager=this,e._prepare(),e)},t.prototype.unregisterAction=function(e){var n=this.actions.indexOf(e);return-1!==n&&(this.actions.splice(n,1),t.Triggers[e.trigger]-=1,0===t.Triggers[e.trigger]&&delete t.Triggers[e.trigger],delete e._actionManager,!0)},t.prototype.processTrigger=function(e,n){for(var i=0;i<this.actions.length;i++){var r=this.actions[i];if(r.trigger===e){if(n&&(e===t.OnKeyUpTrigger||e===t.OnKeyDownTrigger)){var o=r.getTriggerParameter();if(o&&o!==n.sourceEvent.keyCode){if(!o.toLowerCase)continue;var a=o.toLowerCase();if(a!==n.sourceEvent.key){var s=n.sourceEvent.charCode?n.sourceEvent.charCode:n.sourceEvent.keyCode;if(String.fromCharCode(s).toLowerCase()!==a)continue}}}r._executeCurrent(n)}}},t.prototype._getEffectiveTarget=function(t,e){for(var n=e.split("."),i=0;i<n.length-1;i++)t=t[n[i]];return t},t.prototype._getProperty=function(t){var e=t.split(".");return e[e.length-1]},t.prototype.serialize=function(e){for(var n={children:new Array,name:e,type:3,properties:new Array},i=0;i<this.actions.length;i++){var r={type:0,children:new Array,name:t.GetTriggerName(this.actions[i].trigger),properties:new Array},a=this.actions[i].triggerOptions;if(a&&"number"!=typeof a)if(a.parameter instanceof Node)r.properties.push(o.a._GetTargetProperty(a.parameter));else{var s={};h.a.DeepCopy(a.parameter,s,["mesh"]),a.parameter&&a.parameter.mesh&&(s._meshId=a.parameter.mesh.id),r.properties.push({name:"parameter",targetType:null,value:s})}this.actions[i].serialize(r),n.children.push(r)}return n},t.Parse=function(e,n,o){var s=new t(o);null===n?o.actionManager=s:n.actionManager=s;for(var u=function(t,e,n,r){if(null===r){var o=parseFloat(e);return"true"===e||"false"===e?"true"===e:isNaN(o)?e:o}for(var a=r.split("."),s=e.split(","),u=0;u<a.length;u++)n=n[a[u]];if("boolean"==typeof n)return"true"===s[0];if("string"==typeof n)return s[0];var c=new Array;for(u=0;u<s.length;u++)c.push(parseFloat(s[u]));return n instanceof i.Vector3?i.Vector3.FromArray(c):n instanceof i.Vector4?i.Vector4.FromArray(c):n instanceof i.Color3?i.Color3.FromArray(c):n instanceof i.Color4?i.Color4.FromArray(c):parseFloat(s[0])},c=function(e,n,i,h,d){if(void 0===d&&(d=null),!e.detached){var p=new Array,_=null,g=null,f=e.combine&&e.combine.length>0;if(2===e.type?p.push(s):p.push(n),f){for(var m=new Array,y=0;y<e.combine.length;y++)c(e.combine[y],t.NothingTrigger,i,h,m);p.push(m)}else for(var v=0;v<e.properties.length;v++){var A=e.properties[v].value,b=e.properties[v].name,T=e.properties[v].targetType;"target"===b?A=_=null!==T&&"SceneProperties"===T?o:o.getNodeByName(A):"parent"===b?A=o.getNodeByName(A):"sound"===b?o.getSoundByName&&(A=o.getSoundByName(A)):"propertyPath"!==b?A=2===e.type&&"operator"===b?r.d[A]:u(0,A,_,"value"===b?g:null):g=A,p.push(A)}if(null===d?p.push(i):p.push(null),"InterpolateValueAction"===e.name){var O=p[p.length-2];p[p.length-1]=O,p[p.length-2]=i}var P=function(t,e){var n=l.a.GetClass("BABYLON."+t);if(n){var i=Object.create(n.prototype);return i.constructor.apply(i,e),i}}(e.name,p);if(P instanceof r.a&&null!==i){var I=new a.b(n,i);h?h.then(I):s.registerAction(I),h=I}null===d?P instanceof r.a?(i=P,P=h):(i=null,h?h.then(P):s.registerAction(P)):d.push(P);for(v=0;v<e.children.length;v++)c(e.children[v],n,i,P,null)}},h=0;h<e.children.length;h++){var d,p=e.children[h];if(p.properties.length>0){var _=p.properties[0].value,g=null===p.properties[0].targetType?_:o.getMeshByName(_);g._meshId&&(g.mesh=o.getMeshByID(g._meshId)),d={trigger:t[p.name],parameter:g}}else d=t[p.name];for(var f=0;f<p.children.length;f++)p.detached||c(p.children[f],d,null,null)}},t.GetTriggerName=function(t){switch(t){case 0:return"NothingTrigger";case 1:return"OnPickTrigger";case 2:return"OnLeftPickTrigger";case 3:return"OnRightPickTrigger";case 4:return"OnCenterPickTrigger";case 5:return"OnPickDownTrigger";case 6:return"OnPickUpTrigger";case 7:return"OnLongPressTrigger";case 8:return"OnPointerOverTrigger";case 9:return"OnPointerOutTrigger";case 10:return"OnEveryFrameTrigger";case 11:return"OnIntersectionEnterTrigger";case 12:return"OnIntersectionExitTrigger";case 13:return"OnKeyDownTrigger";case 14:return"OnKeyUpTrigger";case 15:return"OnPickOutTrigger";default:return""}},t.NothingTrigger=s.a.ACTION_NothingTrigger,t.OnPickTrigger=s.a.ACTION_OnPickTrigger,t.OnLeftPickTrigger=s.a.ACTION_OnLeftPickTrigger,t.OnRightPickTrigger=s.a.ACTION_OnRightPickTrigger,t.OnCenterPickTrigger=s.a.ACTION_OnCenterPickTrigger,t.OnPickDownTrigger=s.a.ACTION_OnPickDownTrigger,t.OnDoublePickTrigger=s.a.ACTION_OnDoublePickTrigger,t.OnPickUpTrigger=s.a.ACTION_OnPickUpTrigger,t.OnPickOutTrigger=s.a.ACTION_OnPickOutTrigger,t.OnLongPressTrigger=s.a.ACTION_OnLongPressTrigger,t.OnPointerOverTrigger=s.a.ACTION_OnPointerOverTrigger,t.OnPointerOutTrigger=s.a.ACTION_OnPointerOutTrigger,t.OnEveryFrameTrigger=s.a.ACTION_OnEveryFrameTrigger,t.OnIntersectionEnterTrigger=s.a.ACTION_OnIntersectionEnterTrigger,t.OnIntersectionExitTrigger=s.a.ACTION_OnIntersectionExitTrigger,t.OnKeyDownTrigger=s.a.ACTION_OnKeyDownTrigger,t.OnKeyUpTrigger=15,t.Triggers={},t}()}}]);